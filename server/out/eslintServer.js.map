{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/vscode-jsonrpc/lib/main.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/main.js","webpack:///./node_modules/vscode-jsonrpc/lib/is.js","webpack:///./node_modules/vscode-jsonrpc/lib/events.js","webpack:///./node_modules/vscode-jsonrpc/lib/messageReader.js","webpack:///./node_modules/vscode-jsonrpc/lib/messageWriter.js","webpack:///external \"path\"","webpack:///external \"os\"","webpack:///external \"net\"","webpack:///./node_modules/vscode-languageserver/lib/utils/is.js","webpack:///./node_modules/vscode-languageserver/lib/utils/uuid.js","webpack:///external \"child_process\"","webpack:///./node_modules/vscode-textbuffer/lib/pieceTreeBase.js","webpack:///./node_modules/vscode-textbuffer/lib/common/position.js","webpack:///./src/eslintServer.ts","webpack:///./node_modules/vscode-languageserver/lib/main.js","webpack:///./node_modules/vscode-jsonrpc/lib/messages.js","webpack:///./node_modules/vscode-jsonrpc/lib/cancellation.js","webpack:///./node_modules/vscode-jsonrpc/lib/linkedMap.js","webpack:///./node_modules/vscode-jsonrpc/lib/pipeSupport.js","webpack:///external \"crypto\"","webpack:///./node_modules/vscode-jsonrpc/lib/socketSupport.js","webpack:///./node_modules/vscode-languageserver-types/lib/esm/main.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/utils/is.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.implementation.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.typeDefinition.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.workspaceFolders.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.configuration.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.colorProvider.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.foldingRange.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.declaration.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.selectionRange.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.callHierarchy.proposed.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.progress.proposed.js","webpack:///./node_modules/vscode-languageserver/lib/configuration.js","webpack:///./node_modules/vscode-languageserver/lib/workspaceFolders.js","webpack:///./node_modules/vscode-languageserver/lib/files.js","webpack:///external \"url\"","webpack:///external \"fs\"","webpack:///./node_modules/vscode-textbuffer/lib/index.js","webpack:///./node_modules/vscode-textbuffer/lib/rbTreeBase.js","webpack:///./node_modules/vscode-textbuffer/lib/pieceTreeBuilder.js","webpack:///./node_modules/vscode-textbuffer/lib/common/range.js","webpack:///./node_modules/vscode-languageserver/lib/proposed.progress.js","webpack:///./node_modules/vscode-uri/lib/esm/index.js","webpack:///external \"util\""],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__export","Is","messages_1","RequestType","RequestType0","RequestType1","RequestType2","RequestType3","RequestType4","RequestType5","RequestType6","RequestType7","RequestType8","RequestType9","ResponseError","ErrorCodes","NotificationType","NotificationType0","NotificationType1","NotificationType2","NotificationType3","NotificationType4","NotificationType5","NotificationType6","NotificationType7","NotificationType8","NotificationType9","messageReader_1","MessageReader","StreamMessageReader","IPCMessageReader","SocketMessageReader","messageWriter_1","MessageWriter","StreamMessageWriter","IPCMessageWriter","SocketMessageWriter","events_1","Disposable","Event","Emitter","cancellation_1","CancellationTokenSource","CancellationToken","linkedMap_1","CancelNotification","ProgressNotification","Trace","TraceFormat","SetTraceNotification","LogTraceNotification","ConnectionErrors","ConnectionState","type","ProgressType","this","_","undefined","NullLogger","freeze","error","warn","info","log","fromString","toLowerCase","Off","Messages","Verbose","toString","JSON","Text","ConnectionError","Error","code","message","super","setPrototypeOf","_createMessageConnection","messageReader","messageWriter","logger","strategy","sequenceNumber","notificationSquenceNumber","unknownResponseSquenceNumber","version","timer","tracer","starRequestHandler","requestHandlers","starNotificationHandler","notificationHandlers","progressHandlers","Map","messageQueue","LinkedMap","responsePromises","requestTokens","trace","traceFormat","state","New","errorEmitter","closeEmitter","unhandledNotificationEmitter","unhandledProgressEmitter","disposeEmitter","createRequestQueueKey","id","addMessageToQueue","queue","isRequestMessage","set","isResponseMessage","cancelUndispatched","_message","isListening","Listening","isClosed","Closed","isDisposed","Disposed","closeHandler","fire","triggerMessageQueue","size","setImmediate","shift","requestMessage","reply","resultOrError","method","startTime","jsonrpc","toJson","result","traceSendingResponse","write","replyError","data","params","stringify","logLSPMessage","traceReceivedRequest","requestHandler","element","handler","Date","now","cancellationSource","tokenKey","String","handlerResult","promise","numberOfParams","token","array","then","string","InternalError","replySuccess","MethodNotFound","handleRequest","isNotificationMessage","notificationHandler","source","cancel","traceReceivedNotification","handleNotification","responseMessage","responsePromise","timerStart","traceReceivedResponse","reject","resolve","handleResponse","number","responseHandler","handleInvalidMessage","processMessageQueue","onClose","onError","callback","toCancel","response","delete","lspMessage","isLSPMessage","timestamp","throwIfClosedOrDisposed","undefinedToNull","param","computeMessageParams","length","push","connection","sendNotification","messageParams","notificationMessage","traceSendingNotification","onNotification","func","onProgress","_type","has","dispose","sendProgress","onUnhandledProgress","event","sendRequest","throwIfNotListening","is","last","slice","map","Promise","traceSendingRequest","e","MessageWriteError","onCancellationRequested","onRequest","_value","_tracer","sendNotificationOrTraceOptions","_sendNotification","_traceFormat","boolean","onUnhandledNotification","onDispose","keys","forEach","listen","AlreadyListening","throwIfListening","inspect","console","verbose","ConnectionStrategy","candidate","createMessageConnection","input","output","read","end","isMessageWriter","vscode_jsonrpc_1","createClientPipeTransport","createServerPipeTransport","generateRandomPipeName","createClientSocketTransport","createServerSocketTransport","callHierarchy","progress","Proposed","CallHierarchyRequest","CallHierarchyDirection","WorkDoneProgress","WorkDoneProgressCreateRequest","WorkDoneProgressCancelNotification","CallsFrom","CallsTo","createProtocolConnection","reader","writer","Array","isArray","Number","stringArray","every","elem","_disposable","None","CallbackList","context","bucket","_callbacks","_contexts","remove","foundCallbackWithDifferentContext","len","splice","args","ret","callbacks","contexts","apply","_options","_event","listener","thisArgs","disposables","onFirstListenerAdd","isEmpty","add","_noop","onLastListenerRemove","invoke","DefaultSize","CR","Buffer","from","LF","CRLF","MessageBuffer","encoding","index","buffer","allocUnsafe","chunk","toAppend","str","bufferLen","byteLength","copy","newSize","Math","ceil","concat","current","split","header","indexOf","substr","trim","nextStart","onPartialMessage","AbstractMessageReader","partialMessageEmitter","asError","readable","_partialMessageTimeout","timeout","nextMessageLength","messageToken","partialMessageTimer","on","onData","fireError","fireClose","append","headers","tryReadHeaders","contentLength","parseInt","isNaN","msg","tryReadContent","setPartialMessageTimer","clearPartialMessageTimer","json","parse","clearTimeout","setTimeout","firePartialMessage","waitingTime","process","eventEmitter","socket","ContentLength","AbstractMessageWriter","count","writable","errorCount","join","sending","doWriteMessage","send","destroy","handleError","require","typedArray","check","thenable","ValueUUID","other","asHex","V4UUID","_randomHex","_oneOf","_timeHighBits","floor","random","_chars","v4","empty","_UUIDPattern","isUUID","test","generateUuid","position_1","rbTreeBase_1","createUintArray","arr","Uint16Array","Uint32Array","AverageBufferSize","LineStarts","lineStarts","cr","lf","crlf","isBasicASCII","createLineStartsFast","readonly","rLength","chr","charCodeAt","createLineStarts","Piece","bufferIndex","start","lineFeedCnt","StringBuffer","PieceTreeSnapshot","tree","BOM","_pieces","_tree","_BOM","_index","root","SENTINEL","iterate","node","piece","getPieceContent","PieceTreeSearchCache","limit","_limit","_cache","offset","nodePos","nodeStartOffset","lineNumber","nodeStartLineNumber","nodePosition","hasInvalidVal","tmp","parent","newArr","entry","PieceTreeBase","chunks","eol","eolNormalized","_buffers","_lastChangeBufferPos","line","column","_lineCnt","_length","_EOL","_EOLLength","_EOLNormalized","lastNode","rbInsertRight","_searchCache","_lastVisitedLine","computeBufferMetadata","averageBufferSize","min","max","tempChunk","tempChunkLen","getNodeContent","text","replace","newEOL","normalizeEOL","getLength","getLineCount","startPosition","nodeAt","endPosition","getValueInRange2","leftLen","x","left","lf_left","size_left","getAccumulatedValue","right","lfCnt","originalOffset","out","getIndexOf","getOffsetAt","Position","remainder","range","startLineNumber","endLineNumber","startColumn","endColumn","nodeAt2","getEOL","startOffset","offsetInBuffer","substring","next","getContentOfSubTree","getLineRawContent","matchingNode","targetOffset","insertPosInBuffer","positionInBuffer","appendToNode","insertContentToNodeLeft","valdiate","nodesToDel","newRightPiece","getLineFeedCnt","shouldCheckCRLF","endWithCR","nodeCharCodeAt","newStart","startWithLF","previousPos","deleteNodeTail","newPieces","createNewPieces","tmpNode","k","deleteNodes","insertContentToNodeRight","pieces","rbInsertLeft","cnt","startNode","endNode","startSplitPosInBuffer","endSplitPosInBuffer","rbDelete","validateCRLFWithPrevNode","deleteNodeHead","validateCRLFWithNextNode","shrinkNode","prev","nPiece","updateTreeMetadata","newNode","adjustCarriageReturnFromNext","low","high","mid","midStop","midStart","nextLineStartOffset","endOffset","previousCharOffset","cursor","nodes","lastChar","splitText","endIndex","endPos","newPiece","cache","get2","prevAccumualtedValue","accumualtedValue","originalLineNumber","accumulatedValue","pos","lineCnt","realLineCnt","expectedLineStartIndex","originalLFCnt","originalEndOffset","newEnd","newEndOffset","newLineFeedCnt","lf_delta","size_delta","newLength","originalStartOffset","originalStartPos","originalEndPos","oldLength","oldLFCnt","hitCRLF","prevStartOffset","pop","oldLineFeedCnt","offsetOfNode","newOffset","val","nextNode","fixCRLF","prevNewLength","prevNewLFCnt","leftRet","currentContent","z","TreeNode","color","leftest","fixInsert","prevNode","righttest","newLineNumber","newColumn","deltaLineNumber","deltaColumn","with","equals","a","b","isBefore","isBeforeOrEqual","aLineNumber","bLineNumber","obj","CommandIds","Status","StatusNotification","NoConfigRequest","NoESLintLibraryRequest","OpenESLintDocRequest","DirectoryItem","computeKey","diagnostic","character","applySingleFix","applySameFixes","applyAllFixes","applyAutoFix","applyDisableLine","applyDisableFile","openRuleDoc","item","directory","changeProcessCWD","codeActions","recordCodeAction","document","problem","ruleId","uri","edits","label","documentVersion","edit","fix","convertSeverity","severity","DiagnosticSeverity","Warning","isUNC","path","platform","getFileSystemPath","fsPath","toUpperCase","getFilePath","documentOrUri","URI","scheme","exitCalled","nodeExit","exit","stack","documents","createConnection","_globalPaths","yarn","Files","resolveGlobalYarnPath","npm","resolveGlobalNodePath","pnpm","execSync","path2Library","document2Settings","resolveSettings","resultPromise","workspace","getConfiguration","scopeUri","section","settings","resolvedGlobalPackageManagerPath","packageManager","pm","globalPathGet","file","dirname","nodePath","isAbsolute","workspaceFolder","library","moduleName","err","loadNodeModule","CLIEngine","validate","Request","Thenable","versionProvider","trigger","processQueue","isCancellationRequested","RequestCancelled","ValidateNotification","getFixes","textDocument","fixes","Fixes","getDocumentVersion","getOverlapFree","filter","editInfo","TextEdit","Range","positionAt","environmentChanged","clear","all","addNotificationMessage","validateSingle","onInitialize","_cancel","begin","syncKind","initializationOptions","incrementalSync","TextDocumentSyncKind","Incremental","Full","TextDocuments","onDidOpen","run","onDidChangeContent","onWillSaveWaitUntil","reason","TextDocumentSaveReason","AfterDelay","autoFixOnSave","onDidSave","onDidClose","sendDiagnostics","diagnostics","done","capabilities","textDocumentSync","openClose","change","willSaveWaitUntil","save","includeText","codeActionProvider","executeCommandProvider","commands","onInitialized","client","register","DidChangeConfigurationNotification","DidChangeWorkspaceFoldersNotification","registerNotification","_params","singleErrorHandlers","messageTemplate","isNoConfigFoundError","noConfigReported","getMessage","handleFileName","filename","configErrorReported","window","showInformationMessage","matches","exec","plugin","missingModuleReported","handleMissingModule","showErrorMessage","publishDiagnostics","newOptions","assign","options","fixTypes","Set","validFixTypes","content","getText","cwd","workingDirectory","chdir","workspaceFolderUri","cli","report","executeOnText","results","docReport","messages","isWarning","quiet","startLine","startChar","endLine","endChar","makeDiagnostic","autoFix","isFunction","getRules","rule","meta","ruleDocData","handled","docs","url","urls","ok","status","DidChangeWatchedFilesNotification","changes","validateMany","lastEdit","newEdit","values","sort","sorted","getAllSorted","overlaps","CodeActionResult","_actions","action","_fixAll","actions","disable","fixAll","disableFile","showDocumentation","registerRequest","CodeActionRequest","allFixableRuleIds","createTextEdit","createDisableLineTextEdit","indentationText","insert","EOL","createDisableSameLineTextEdit","MAX_VALUE","createDisableFileTextEdit","getLastEdit","getScoped","workspaceChange","WorkspaceChange","getTextEditChange","CodeAction","Command","CodeActionKind","QuickFix","codeAction","disableRuleComment","enable","location","lineText","title","sameProblems","same","sameFixes","sameTextChange","command","allFixes","allTextChange","ExecuteCommandRequest","identifier","arguments","computeAllFixes","textChange","applyEdit","applied","vscode_languageserver_protocol_1","configuration_1","workspaceFolders_1","UUID","fm","vscode_textbuffer_1","range_1","uriToFilePath","resolveModulePath","shutdownReceived","exitTimer","null2Undefined","runTimer","processId","setInterval","kill","ex","argv","arg","setupExitTimer","IncrementalTextDocument","languageId","_uri","_languageId","_version","ptBuilder","PieceTreeTextBufferBuilder","acceptChunk","ptFactory","finish","clampedEndLine","clampedEndChar","lineCount","getLineLength","ptRange","getValueInRange","getLinesRawContent","offsetAt","clampedOffset","ptPosition","getPositionAt","position","clampedChar","_documents","_syncKind","_onDidChangeContent","_onDidOpen","_onDidClose","_onDidSave","_onWillSave","_willSaveWaitUntil","__textDocumentSync","onDidOpenTextDocument","td","TextDocument","toFire","onDidChangeTextDocument","contentChanges","update","isUpdateableDocument","updatedDoc","reduce","workingTextDoc","onDidCloseTextDocument","onWillSaveTextDocument","onWillSaveTextDocumentWaitUntil","onDidSaveTextDocument","ErrorMessageTracker","_messages","BulkRegistration","BulkRegistrationImpl","_registrations","_registered","registerOptions","registrations","BulkUnregistration","BulkUnregistrationImpl","_connection","unregistrations","_unregistrations","unregistration","unregisterations","UnregistrationRequest","_error","ConnectionLogger","_rawConnection","_capabilities","MessageType","Info","Log","LogMessageNotification","RemoteWindowImpl","ShowMessageRequest","RemoteClientImpl","typeOrRegistrations","registerOptionsOrType","registerMany","registerSingle1","registerSingle2","isAttached","attach","RegistrationRequest","_result","unregisterSingle","asRegistrationParams","registration","RemoteWorkspaceImpl","WorkspaceFoldersFeature","ConfigurationFeature","paramOrEdit","ApplyWorkspaceEditRequest","TracerImpl","_trace","TelemetryImpl","TelemetryEventNotification","combineConsoleFeatures","one","two","Base","combineTelemetryFeatures","combineTracerFeatures","combineClientFeatures","combineWindowFeatures","combineWorkspaceFeatures","combineFeatures","combine","__brand","telemetry","arg1","arg2","arg3","arg4","factories","port","pipeName","stdin","stdout","transport","commandLineMessage","inputStream","rawAttach","remoteWindow","allRemotes","shutdownHandler","initializeHandler","exitHandler","protocolConnection","InitializedNotification","onShutdown","onExit","onDidChangeConfiguration","onDidChangeWatchedFiles","DidOpenTextDocumentNotification","DidChangeTextDocumentNotification","DidCloseTextDocumentNotification","WillSaveTextDocumentNotification","WillSaveTextDocumentWaitUntilRequest","DidSaveTextDocumentNotification","PublishDiagnosticsNotification","onHover","HoverRequest","proposed_progress_1","attachWorkDone","onCompletion","CompletionRequest","attachPartialResult","onCompletionResolve","CompletionResolveRequest","onSignatureHelp","SignatureHelpRequest","onDeclaration","DeclarationRequest","onDefinition","DefinitionRequest","onTypeDefinition","TypeDefinitionRequest","onImplementation","ImplementationRequest","onReferences","ReferencesRequest","onDocumentHighlight","DocumentHighlightRequest","onDocumentSymbol","DocumentSymbolRequest","onWorkspaceSymbol","WorkspaceSymbolRequest","onCodeAction","onCodeLens","CodeLensRequest","onCodeLensResolve","CodeLensResolveRequest","onDocumentFormatting","DocumentFormattingRequest","onDocumentRangeFormatting","DocumentRangeFormattingRequest","onDocumentOnTypeFormatting","DocumentOnTypeFormattingRequest","onRenameRequest","RenameRequest","onPrepareRename","PrepareRenameRequest","onDocumentLinks","DocumentLinkRequest","onDocumentLinkResolve","DocumentLinkResolveRequest","onDocumentColor","DocumentColorRequest","onColorPresentation","ColorPresentationRequest","onFoldingRanges","FoldingRangeRequest","onSelectionRanges","SelectionRangeRequest","onExecuteCommand","remote","InitializeRequest","initialize","asThenable","fillServerCapabilities","ShutdownRequest","ExitNotification","_createConnection","ProposedFeatures","ProgressFeature","ParseError","InvalidRequest","InvalidParams","serverErrorStart","serverErrorEnd","ServerNotInitialized","UnknownErrorCode","ContentModified","MessageReadError","AbstractMessageType","_method","_numberOfParams","Cancelled","shortcutEvent","handle","MutableToken","_isCancelled","_emitter","_token","Touch","First","Last","_map","_head","_tail","_size","touch","previous","addItemLast","addItemFirst","removeItem","callbackfn","thisArg","path_1","os_1","crypto_1","net_1","randomSuffix","randomBytes","tmpdir","connectResolve","connected","_reject","server","createServer","close","removeListener","onConnected","Location","LocationLink","Color","ColorInformation","ColorPresentation","FoldingRangeKind","FoldingRange","DiagnosticRelatedInformation","DiagnosticTag","Diagnostic","TextDocumentEdit","CreateFile","RenameFile","DeleteFile","WorkspaceEdit","objectLiteral","three","four","defined","targetUri","targetRange","targetSelectionRange","originSelectionRange","red","green","blue","alpha","textEdit","additionalTextEdits","startCharacter","endCharacter","kind","Information","Hint","Unnecessary","relatedInformation","_i","newText","del","VersionedTextDocumentIdentifier","overwrite","ignoreIfExists","oldUri","newUri","recursive","ignoreIfNotExists","documentChanges","TextDocumentIdentifier","TextDocumentItem","MarkupKind","MarkupContent","CompletionItemKind","InsertTextFormat","CompletionItem","CompletionList","MarkedString","Hover","ParameterInformation","SignatureInformation","DocumentHighlightKind","DocumentHighlight","SymbolKind","SymbolInformation","TextEditChangeImpl","workspaceEdit","_this","_textEditChanges","_workspaceEdit","textEditChange","configurable","textDocumentEdit","createFile","checkDocumentChanges","renameFile","deleteFile","PlainText","Markdown","Method","Function","Constructor","Field","Variable","Class","Interface","Module","Property","Unit","Value","Enum","Keyword","Snippet","File","Reference","Folder","EnumMember","Constant","Struct","Operator","TypeParameter","items","isIncomplete","fromPlainText","plainText","language","contents","documentation","parameters","Read","Write","Namespace","Package","Boolean","Key","Null","containerName","CodeActionContext","CodeLens","FormattingOptions","DocumentSymbol","detail","selectionRange","children","deprecated","Empty","Refactor","RefactorExtract","RefactorInline","RefactorRewrite","Source","SourceOrganizeImports","only","commandOrEdit","tabSize","insertSpaces","SelectionRange","DocumentLink","target","FullTextDocument","applyEdits","sortedEdits","mergeSort","compare","leftIdx","rightIdx","diff","lastModifiedOffset","Manual","FocusOut","_content","_lineOffsets","getLineOffsets","lineOffsets","isLineStart","ch","charAt","lineOffset","nextLineOffset","protocol_implementation_1","protocol_typeDefinition_1","protocol_workspaceFolders_1","WorkspaceFoldersRequest","protocol_configuration_1","ConfigurationRequest","protocol_colorProvider_1","protocol_foldingRange_1","protocol_declaration_1","protocol_selectionRange_1","DocumentFilter","DocumentSelector","pattern","ResourceOperationKind","Create","Rename","Delete","FailureHandlingKind","Abort","Transactional","TextOnlyTransactional","Undo","StaticRegistrationOptions","hasId","TextDocumentRegistrationOptions","documentSelector","WorkDoneProgressOptions","workDoneProgress","hasWorkDoneProgress","InitializeError","unknownProtocolVersion","ShowMessageNotification","FileChangeType","Created","Changed","Deleted","WatchKind","Change","CompletionTriggerKind","Invoked","TriggerCharacter","TriggerForIncompleteCompletions","resultType","_getConfiguration","workspaceCapabilities","workspaceFolders","_onDidChangeWorkspaceFolders","_unregistration","fs","child_process_1","isWindows","app","env","newEnv","delimiter","cp","fork","execArgv","pid","npmCommand","shell","spawnSync","prefix","FileSystem","parsed","protocol","segments","decodeURIComponent","first","second","normalize","yarnCommand","stderr","lines","_isCaseSensitive","isCaseSensitive","existsSync","__filename","isParent","child","workspaceRoot","calculateSize","calculateLF","resetSentinel","leftRotate","y","rightRotate","delta","lineFeedCntDelta","recomputeTreeMetadata","detach","w","yWasRed","newSizeLeft","newLFLeft","pieceTreeBase_1","startsWithUTF8BOM","UTF8_BOM_CHARACTER","fromCharCode","PieceTreeTextBufferFactory","_chunks","_bom","_cr","_lf","_crlf","_normalizeEOL","defaultEOL","totalEOLCount","totalCRCount","_getEOL","newLineStart","lengthLimit","_hasPreviousChar","_previousChar","_tmpLineStarts","_acceptChunk1","allowEmptyStrings","_acceptChunk2","_finish","lastChunk","newLineStarts","containsPosition","containsRange","otherRange","plusRange","intersectRanges","resultStartLineNumber","resultStartColumn","resultEndLineNumber","resultEndColumn","otherStartLineNumber","otherStartColumn","otherEndLineNumber","otherEndColumn","equalsRange","collapseToStart","aStartLineNumber","bStartLineNumber","aStartColumn","bStartColumn","aEndLineNumber","bEndLineNumber","uuid_1","WorkDoneProgressImpl","Instances","_source","percentage","cancellable","arg0","NullProgress","ResultProgress","workDoneToken","cap","_progressSupported","ResultProgressImpl","partialResultToken","extendStatics","__extends","__proto__","__","constructor","navigator","userAgent","_schemePattern","_singleSlashStart","_doubleSlashStart","_throwOnMissingSchema","setUriThrowOnMissingScheme","old","_a","_empty","_slash","_regexp","schemeOrData","authority","query","fragment","_strict","_schemeFix","_referenceResolution","_validateUri","isUri","thing","_makeFsPath","_URI","match","idx","components","skipEncoding","_asFormatted","toJSON","revive","_formatted","external","_fsPath","_sep","_pathSepMarker","_super","res","$mid","encodeTable","encodeURIComponentFast","uriComponent","allowSlash","nativeEncodePos","encodeURIComponent","escaped","encodeURIComponentMinimal","encoder","userinfo"],"mappings":"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","file":"eslintServer.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n/// <reference path=\"./thenable.ts\" />\r\n'use strict';\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Is = require(\"./is\");\r\nconst messages_1 = require(\"./messages\");\r\nexports.RequestType = messages_1.RequestType;\r\nexports.RequestType0 = messages_1.RequestType0;\r\nexports.RequestType1 = messages_1.RequestType1;\r\nexports.RequestType2 = messages_1.RequestType2;\r\nexports.RequestType3 = messages_1.RequestType3;\r\nexports.RequestType4 = messages_1.RequestType4;\r\nexports.RequestType5 = messages_1.RequestType5;\r\nexports.RequestType6 = messages_1.RequestType6;\r\nexports.RequestType7 = messages_1.RequestType7;\r\nexports.RequestType8 = messages_1.RequestType8;\r\nexports.RequestType9 = messages_1.RequestType9;\r\nexports.ResponseError = messages_1.ResponseError;\r\nexports.ErrorCodes = messages_1.ErrorCodes;\r\nexports.NotificationType = messages_1.NotificationType;\r\nexports.NotificationType0 = messages_1.NotificationType0;\r\nexports.NotificationType1 = messages_1.NotificationType1;\r\nexports.NotificationType2 = messages_1.NotificationType2;\r\nexports.NotificationType3 = messages_1.NotificationType3;\r\nexports.NotificationType4 = messages_1.NotificationType4;\r\nexports.NotificationType5 = messages_1.NotificationType5;\r\nexports.NotificationType6 = messages_1.NotificationType6;\r\nexports.NotificationType7 = messages_1.NotificationType7;\r\nexports.NotificationType8 = messages_1.NotificationType8;\r\nexports.NotificationType9 = messages_1.NotificationType9;\r\nconst messageReader_1 = require(\"./messageReader\");\r\nexports.MessageReader = messageReader_1.MessageReader;\r\nexports.StreamMessageReader = messageReader_1.StreamMessageReader;\r\nexports.IPCMessageReader = messageReader_1.IPCMessageReader;\r\nexports.SocketMessageReader = messageReader_1.SocketMessageReader;\r\nconst messageWriter_1 = require(\"./messageWriter\");\r\nexports.MessageWriter = messageWriter_1.MessageWriter;\r\nexports.StreamMessageWriter = messageWriter_1.StreamMessageWriter;\r\nexports.IPCMessageWriter = messageWriter_1.IPCMessageWriter;\r\nexports.SocketMessageWriter = messageWriter_1.SocketMessageWriter;\r\nconst events_1 = require(\"./events\");\r\nexports.Disposable = events_1.Disposable;\r\nexports.Event = events_1.Event;\r\nexports.Emitter = events_1.Emitter;\r\nconst cancellation_1 = require(\"./cancellation\");\r\nexports.CancellationTokenSource = cancellation_1.CancellationTokenSource;\r\nexports.CancellationToken = cancellation_1.CancellationToken;\r\nconst linkedMap_1 = require(\"./linkedMap\");\r\n__export(require(\"./pipeSupport\"));\r\n__export(require(\"./socketSupport\"));\r\nvar CancelNotification;\r\n(function (CancelNotification) {\r\n    CancelNotification.type = new messages_1.NotificationType('$/cancelRequest');\r\n})(CancelNotification || (CancelNotification = {}));\r\nvar ProgressNotification;\r\n(function (ProgressNotification) {\r\n    ProgressNotification.type = new messages_1.NotificationType('$/progress');\r\n})(ProgressNotification || (ProgressNotification = {}));\r\nclass ProgressType {\r\n    constructor() {\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.ProgressType = ProgressType;\r\nexports.NullLogger = Object.freeze({\r\n    error: () => { },\r\n    warn: () => { },\r\n    info: () => { },\r\n    log: () => { }\r\n});\r\nvar Trace;\r\n(function (Trace) {\r\n    Trace[Trace[\"Off\"] = 0] = \"Off\";\r\n    Trace[Trace[\"Messages\"] = 1] = \"Messages\";\r\n    Trace[Trace[\"Verbose\"] = 2] = \"Verbose\";\r\n})(Trace = exports.Trace || (exports.Trace = {}));\r\n(function (Trace) {\r\n    function fromString(value) {\r\n        value = value.toLowerCase();\r\n        switch (value) {\r\n            case 'off':\r\n                return Trace.Off;\r\n            case 'messages':\r\n                return Trace.Messages;\r\n            case 'verbose':\r\n                return Trace.Verbose;\r\n            default:\r\n                return Trace.Off;\r\n        }\r\n    }\r\n    Trace.fromString = fromString;\r\n    function toString(value) {\r\n        switch (value) {\r\n            case Trace.Off:\r\n                return 'off';\r\n            case Trace.Messages:\r\n                return 'messages';\r\n            case Trace.Verbose:\r\n                return 'verbose';\r\n            default:\r\n                return 'off';\r\n        }\r\n    }\r\n    Trace.toString = toString;\r\n})(Trace = exports.Trace || (exports.Trace = {}));\r\nvar TraceFormat;\r\n(function (TraceFormat) {\r\n    TraceFormat[\"Text\"] = \"text\";\r\n    TraceFormat[\"JSON\"] = \"json\";\r\n})(TraceFormat = exports.TraceFormat || (exports.TraceFormat = {}));\r\n(function (TraceFormat) {\r\n    function fromString(value) {\r\n        value = value.toLowerCase();\r\n        if (value === 'json') {\r\n            return TraceFormat.JSON;\r\n        }\r\n        else {\r\n            return TraceFormat.Text;\r\n        }\r\n    }\r\n    TraceFormat.fromString = fromString;\r\n})(TraceFormat = exports.TraceFormat || (exports.TraceFormat = {}));\r\nvar SetTraceNotification;\r\n(function (SetTraceNotification) {\r\n    SetTraceNotification.type = new messages_1.NotificationType('$/setTraceNotification');\r\n})(SetTraceNotification = exports.SetTraceNotification || (exports.SetTraceNotification = {}));\r\nvar LogTraceNotification;\r\n(function (LogTraceNotification) {\r\n    LogTraceNotification.type = new messages_1.NotificationType('$/logTraceNotification');\r\n})(LogTraceNotification = exports.LogTraceNotification || (exports.LogTraceNotification = {}));\r\nvar ConnectionErrors;\r\n(function (ConnectionErrors) {\r\n    /**\r\n     * The connection is closed.\r\n     */\r\n    ConnectionErrors[ConnectionErrors[\"Closed\"] = 1] = \"Closed\";\r\n    /**\r\n     * The connection got disposed.\r\n     */\r\n    ConnectionErrors[ConnectionErrors[\"Disposed\"] = 2] = \"Disposed\";\r\n    /**\r\n     * The connection is already in listening mode.\r\n     */\r\n    ConnectionErrors[ConnectionErrors[\"AlreadyListening\"] = 3] = \"AlreadyListening\";\r\n})(ConnectionErrors = exports.ConnectionErrors || (exports.ConnectionErrors = {}));\r\nclass ConnectionError extends Error {\r\n    constructor(code, message) {\r\n        super(message);\r\n        this.code = code;\r\n        Object.setPrototypeOf(this, ConnectionError.prototype);\r\n    }\r\n}\r\nexports.ConnectionError = ConnectionError;\r\nvar ConnectionStrategy;\r\n(function (ConnectionStrategy) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && Is.func(candidate.cancelUndispatched);\r\n    }\r\n    ConnectionStrategy.is = is;\r\n})(ConnectionStrategy = exports.ConnectionStrategy || (exports.ConnectionStrategy = {}));\r\nvar ConnectionState;\r\n(function (ConnectionState) {\r\n    ConnectionState[ConnectionState[\"New\"] = 1] = \"New\";\r\n    ConnectionState[ConnectionState[\"Listening\"] = 2] = \"Listening\";\r\n    ConnectionState[ConnectionState[\"Closed\"] = 3] = \"Closed\";\r\n    ConnectionState[ConnectionState[\"Disposed\"] = 4] = \"Disposed\";\r\n})(ConnectionState || (ConnectionState = {}));\r\nfunction _createMessageConnection(messageReader, messageWriter, logger, strategy) {\r\n    let sequenceNumber = 0;\r\n    let notificationSquenceNumber = 0;\r\n    let unknownResponseSquenceNumber = 0;\r\n    const version = '2.0';\r\n    let starRequestHandler = undefined;\r\n    let requestHandlers = Object.create(null);\r\n    let starNotificationHandler = undefined;\r\n    let notificationHandlers = Object.create(null);\r\n    let progressHandlers = new Map();\r\n    let timer;\r\n    let messageQueue = new linkedMap_1.LinkedMap();\r\n    let responsePromises = Object.create(null);\r\n    let requestTokens = Object.create(null);\r\n    let trace = Trace.Off;\r\n    let traceFormat = TraceFormat.Text;\r\n    let tracer;\r\n    let state = ConnectionState.New;\r\n    let errorEmitter = new events_1.Emitter();\r\n    let closeEmitter = new events_1.Emitter();\r\n    let unhandledNotificationEmitter = new events_1.Emitter();\r\n    let unhandledProgressEmitter = new events_1.Emitter();\r\n    let disposeEmitter = new events_1.Emitter();\r\n    function createRequestQueueKey(id) {\r\n        return 'req-' + id.toString();\r\n    }\r\n    function createResponseQueueKey(id) {\r\n        if (id === null) {\r\n            return 'res-unknown-' + (++unknownResponseSquenceNumber).toString();\r\n        }\r\n        else {\r\n            return 'res-' + id.toString();\r\n        }\r\n    }\r\n    function createNotificationQueueKey() {\r\n        return 'not-' + (++notificationSquenceNumber).toString();\r\n    }\r\n    function addMessageToQueue(queue, message) {\r\n        if (messages_1.isRequestMessage(message)) {\r\n            queue.set(createRequestQueueKey(message.id), message);\r\n        }\r\n        else if (messages_1.isResponseMessage(message)) {\r\n            queue.set(createResponseQueueKey(message.id), message);\r\n        }\r\n        else {\r\n            queue.set(createNotificationQueueKey(), message);\r\n        }\r\n    }\r\n    function cancelUndispatched(_message) {\r\n        return undefined;\r\n    }\r\n    function isListening() {\r\n        return state === ConnectionState.Listening;\r\n    }\r\n    function isClosed() {\r\n        return state === ConnectionState.Closed;\r\n    }\r\n    function isDisposed() {\r\n        return state === ConnectionState.Disposed;\r\n    }\r\n    function closeHandler() {\r\n        if (state === ConnectionState.New || state === ConnectionState.Listening) {\r\n            state = ConnectionState.Closed;\r\n            closeEmitter.fire(undefined);\r\n        }\r\n        // If the connection is disposed don't sent close events.\r\n    }\r\n    ;\r\n    function readErrorHandler(error) {\r\n        errorEmitter.fire([error, undefined, undefined]);\r\n    }\r\n    function writeErrorHandler(data) {\r\n        errorEmitter.fire(data);\r\n    }\r\n    messageReader.onClose(closeHandler);\r\n    messageReader.onError(readErrorHandler);\r\n    messageWriter.onClose(closeHandler);\r\n    messageWriter.onError(writeErrorHandler);\r\n    function triggerMessageQueue() {\r\n        if (timer || messageQueue.size === 0) {\r\n            return;\r\n        }\r\n        timer = setImmediate(() => {\r\n            timer = undefined;\r\n            processMessageQueue();\r\n        });\r\n    }\r\n    function processMessageQueue() {\r\n        if (messageQueue.size === 0) {\r\n            return;\r\n        }\r\n        let message = messageQueue.shift();\r\n        try {\r\n            if (messages_1.isRequestMessage(message)) {\r\n                handleRequest(message);\r\n            }\r\n            else if (messages_1.isNotificationMessage(message)) {\r\n                handleNotification(message);\r\n            }\r\n            else if (messages_1.isResponseMessage(message)) {\r\n                handleResponse(message);\r\n            }\r\n            else {\r\n                handleInvalidMessage(message);\r\n            }\r\n        }\r\n        finally {\r\n            triggerMessageQueue();\r\n        }\r\n    }\r\n    let callback = (message) => {\r\n        try {\r\n            // We have received a cancellation message. Check if the message is still in the queue\r\n            // and cancel it if allowed to do so.\r\n            if (messages_1.isNotificationMessage(message) && message.method === CancelNotification.type.method) {\r\n                let key = createRequestQueueKey(message.params.id);\r\n                let toCancel = messageQueue.get(key);\r\n                if (messages_1.isRequestMessage(toCancel)) {\r\n                    let response = strategy && strategy.cancelUndispatched ? strategy.cancelUndispatched(toCancel, cancelUndispatched) : cancelUndispatched(toCancel);\r\n                    if (response && (response.error !== void 0 || response.result !== void 0)) {\r\n                        messageQueue.delete(key);\r\n                        response.id = toCancel.id;\r\n                        traceSendingResponse(response, message.method, Date.now());\r\n                        messageWriter.write(response);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n            addMessageToQueue(messageQueue, message);\r\n        }\r\n        finally {\r\n            triggerMessageQueue();\r\n        }\r\n    };\r\n    function handleRequest(requestMessage) {\r\n        if (isDisposed()) {\r\n            // we return here silently since we fired an event when the\r\n            // connection got disposed.\r\n            return;\r\n        }\r\n        function reply(resultOrError, method, startTime) {\r\n            let message = {\r\n                jsonrpc: version,\r\n                id: requestMessage.id\r\n            };\r\n            if (resultOrError instanceof messages_1.ResponseError) {\r\n                message.error = resultOrError.toJson();\r\n            }\r\n            else {\r\n                message.result = resultOrError === void 0 ? null : resultOrError;\r\n            }\r\n            traceSendingResponse(message, method, startTime);\r\n            messageWriter.write(message);\r\n        }\r\n        function replyError(error, method, startTime) {\r\n            let message = {\r\n                jsonrpc: version,\r\n                id: requestMessage.id,\r\n                error: error.toJson()\r\n            };\r\n            traceSendingResponse(message, method, startTime);\r\n            messageWriter.write(message);\r\n        }\r\n        function replySuccess(result, method, startTime) {\r\n            // The JSON RPC defines that a response must either have a result or an error\r\n            // So we can't treat undefined as a valid response result.\r\n            if (result === void 0) {\r\n                result = null;\r\n            }\r\n            let message = {\r\n                jsonrpc: version,\r\n                id: requestMessage.id,\r\n                result: result\r\n            };\r\n            traceSendingResponse(message, method, startTime);\r\n            messageWriter.write(message);\r\n        }\r\n        traceReceivedRequest(requestMessage);\r\n        let element = requestHandlers[requestMessage.method];\r\n        let type;\r\n        let requestHandler;\r\n        if (element) {\r\n            type = element.type;\r\n            requestHandler = element.handler;\r\n        }\r\n        let startTime = Date.now();\r\n        if (requestHandler || starRequestHandler) {\r\n            let cancellationSource = new cancellation_1.CancellationTokenSource();\r\n            let tokenKey = String(requestMessage.id);\r\n            requestTokens[tokenKey] = cancellationSource;\r\n            try {\r\n                let handlerResult;\r\n                if (requestMessage.params === void 0 || (type !== void 0 && type.numberOfParams === 0)) {\r\n                    handlerResult = requestHandler\r\n                        ? requestHandler(cancellationSource.token)\r\n                        : starRequestHandler(requestMessage.method, cancellationSource.token);\r\n                }\r\n                else if (Is.array(requestMessage.params) && (type === void 0 || type.numberOfParams > 1)) {\r\n                    handlerResult = requestHandler\r\n                        ? requestHandler(...requestMessage.params, cancellationSource.token)\r\n                        : starRequestHandler(requestMessage.method, ...requestMessage.params, cancellationSource.token);\r\n                }\r\n                else {\r\n                    handlerResult = requestHandler\r\n                        ? requestHandler(requestMessage.params, cancellationSource.token)\r\n                        : starRequestHandler(requestMessage.method, requestMessage.params, cancellationSource.token);\r\n                }\r\n                let promise = handlerResult;\r\n                if (!handlerResult) {\r\n                    delete requestTokens[tokenKey];\r\n                    replySuccess(handlerResult, requestMessage.method, startTime);\r\n                }\r\n                else if (promise.then) {\r\n                    promise.then((resultOrError) => {\r\n                        delete requestTokens[tokenKey];\r\n                        reply(resultOrError, requestMessage.method, startTime);\r\n                    }, error => {\r\n                        delete requestTokens[tokenKey];\r\n                        if (error instanceof messages_1.ResponseError) {\r\n                            replyError(error, requestMessage.method, startTime);\r\n                        }\r\n                        else if (error && Is.string(error.message)) {\r\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed with message: ${error.message}`), requestMessage.method, startTime);\r\n                        }\r\n                        else {\r\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed unexpectedly without providing any details.`), requestMessage.method, startTime);\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    delete requestTokens[tokenKey];\r\n                    reply(handlerResult, requestMessage.method, startTime);\r\n                }\r\n            }\r\n            catch (error) {\r\n                delete requestTokens[tokenKey];\r\n                if (error instanceof messages_1.ResponseError) {\r\n                    reply(error, requestMessage.method, startTime);\r\n                }\r\n                else if (error && Is.string(error.message)) {\r\n                    replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed with message: ${error.message}`), requestMessage.method, startTime);\r\n                }\r\n                else {\r\n                    replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed unexpectedly without providing any details.`), requestMessage.method, startTime);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.MethodNotFound, `Unhandled method ${requestMessage.method}`), requestMessage.method, startTime);\r\n        }\r\n    }\r\n    function handleResponse(responseMessage) {\r\n        if (isDisposed()) {\r\n            // See handle request.\r\n            return;\r\n        }\r\n        if (responseMessage.id === null) {\r\n            if (responseMessage.error) {\r\n                logger.error(`Received response message without id: Error is: \\n${JSON.stringify(responseMessage.error, undefined, 4)}`);\r\n            }\r\n            else {\r\n                logger.error(`Received response message without id. No further error information provided.`);\r\n            }\r\n        }\r\n        else {\r\n            let key = String(responseMessage.id);\r\n            let responsePromise = responsePromises[key];\r\n            traceReceivedResponse(responseMessage, responsePromise);\r\n            if (responsePromise) {\r\n                delete responsePromises[key];\r\n                try {\r\n                    if (responseMessage.error) {\r\n                        let error = responseMessage.error;\r\n                        responsePromise.reject(new messages_1.ResponseError(error.code, error.message, error.data));\r\n                    }\r\n                    else if (responseMessage.result !== void 0) {\r\n                        responsePromise.resolve(responseMessage.result);\r\n                    }\r\n                    else {\r\n                        throw new Error('Should never happen.');\r\n                    }\r\n                }\r\n                catch (error) {\r\n                    if (error.message) {\r\n                        logger.error(`Response handler '${responsePromise.method}' failed with message: ${error.message}`);\r\n                    }\r\n                    else {\r\n                        logger.error(`Response handler '${responsePromise.method}' failed unexpectedly.`);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function handleNotification(message) {\r\n        if (isDisposed()) {\r\n            // See handle request.\r\n            return;\r\n        }\r\n        let type = undefined;\r\n        let notificationHandler;\r\n        if (message.method === CancelNotification.type.method) {\r\n            notificationHandler = (params) => {\r\n                let id = params.id;\r\n                let source = requestTokens[String(id)];\r\n                if (source) {\r\n                    source.cancel();\r\n                }\r\n            };\r\n        }\r\n        else {\r\n            let element = notificationHandlers[message.method];\r\n            if (element) {\r\n                notificationHandler = element.handler;\r\n                type = element.type;\r\n            }\r\n        }\r\n        if (notificationHandler || starNotificationHandler) {\r\n            try {\r\n                traceReceivedNotification(message);\r\n                if (message.params === void 0 || (type !== void 0 && type.numberOfParams === 0)) {\r\n                    notificationHandler ? notificationHandler() : starNotificationHandler(message.method);\r\n                }\r\n                else if (Is.array(message.params) && (type === void 0 || type.numberOfParams > 1)) {\r\n                    notificationHandler ? notificationHandler(...message.params) : starNotificationHandler(message.method, ...message.params);\r\n                }\r\n                else {\r\n                    notificationHandler ? notificationHandler(message.params) : starNotificationHandler(message.method, message.params);\r\n                }\r\n            }\r\n            catch (error) {\r\n                if (error.message) {\r\n                    logger.error(`Notification handler '${message.method}' failed with message: ${error.message}`);\r\n                }\r\n                else {\r\n                    logger.error(`Notification handler '${message.method}' failed unexpectedly.`);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            unhandledNotificationEmitter.fire(message);\r\n        }\r\n    }\r\n    function handleInvalidMessage(message) {\r\n        if (!message) {\r\n            logger.error('Received empty message.');\r\n            return;\r\n        }\r\n        logger.error(`Received message which is neither a response nor a notification message:\\n${JSON.stringify(message, null, 4)}`);\r\n        // Test whether we find an id to reject the promise\r\n        let responseMessage = message;\r\n        if (Is.string(responseMessage.id) || Is.number(responseMessage.id)) {\r\n            let key = String(responseMessage.id);\r\n            let responseHandler = responsePromises[key];\r\n            if (responseHandler) {\r\n                responseHandler.reject(new Error('The received response has neither a result nor an error property.'));\r\n            }\r\n        }\r\n    }\r\n    function traceSendingRequest(message) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose && message.params) {\r\n                data = `Params: ${JSON.stringify(message.params, null, 4)}\\n\\n`;\r\n            }\r\n            tracer.log(`Sending request '${message.method} - (${message.id})'.`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('send-request', message);\r\n        }\r\n    }\r\n    function traceSendingNotification(message) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose) {\r\n                if (message.params) {\r\n                    data = `Params: ${JSON.stringify(message.params, null, 4)}\\n\\n`;\r\n                }\r\n                else {\r\n                    data = 'No parameters provided.\\n\\n';\r\n                }\r\n            }\r\n            tracer.log(`Sending notification '${message.method}'.`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('send-notification', message);\r\n        }\r\n    }\r\n    function traceSendingResponse(message, method, startTime) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose) {\r\n                if (message.error && message.error.data) {\r\n                    data = `Error data: ${JSON.stringify(message.error.data, null, 4)}\\n\\n`;\r\n                }\r\n                else {\r\n                    if (message.result) {\r\n                        data = `Result: ${JSON.stringify(message.result, null, 4)}\\n\\n`;\r\n                    }\r\n                    else if (message.error === void 0) {\r\n                        data = 'No result returned.\\n\\n';\r\n                    }\r\n                }\r\n            }\r\n            tracer.log(`Sending response '${method} - (${message.id})'. Processing request took ${Date.now() - startTime}ms`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('send-response', message);\r\n        }\r\n    }\r\n    function traceReceivedRequest(message) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose && message.params) {\r\n                data = `Params: ${JSON.stringify(message.params, null, 4)}\\n\\n`;\r\n            }\r\n            tracer.log(`Received request '${message.method} - (${message.id})'.`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('receive-request', message);\r\n        }\r\n    }\r\n    function traceReceivedNotification(message) {\r\n        if (trace === Trace.Off || !tracer || message.method === LogTraceNotification.type.method) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose) {\r\n                if (message.params) {\r\n                    data = `Params: ${JSON.stringify(message.params, null, 4)}\\n\\n`;\r\n                }\r\n                else {\r\n                    data = 'No parameters provided.\\n\\n';\r\n                }\r\n            }\r\n            tracer.log(`Received notification '${message.method}'.`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('receive-notification', message);\r\n        }\r\n    }\r\n    function traceReceivedResponse(message, responsePromise) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose) {\r\n                if (message.error && message.error.data) {\r\n                    data = `Error data: ${JSON.stringify(message.error.data, null, 4)}\\n\\n`;\r\n                }\r\n                else {\r\n                    if (message.result) {\r\n                        data = `Result: ${JSON.stringify(message.result, null, 4)}\\n\\n`;\r\n                    }\r\n                    else if (message.error === void 0) {\r\n                        data = 'No result returned.\\n\\n';\r\n                    }\r\n                }\r\n            }\r\n            if (responsePromise) {\r\n                let error = message.error ? ` Request failed: ${message.error.message} (${message.error.code}).` : '';\r\n                tracer.log(`Received response '${responsePromise.method} - (${message.id})' in ${Date.now() - responsePromise.timerStart}ms.${error}`, data);\r\n            }\r\n            else {\r\n                tracer.log(`Received response ${message.id} without active response promise.`, data);\r\n            }\r\n        }\r\n        else {\r\n            logLSPMessage('receive-response', message);\r\n        }\r\n    }\r\n    function logLSPMessage(type, message) {\r\n        if (!tracer || trace === Trace.Off) {\r\n            return;\r\n        }\r\n        const lspMessage = {\r\n            isLSPMessage: true,\r\n            type,\r\n            message,\r\n            timestamp: Date.now()\r\n        };\r\n        tracer.log(lspMessage);\r\n    }\r\n    function throwIfClosedOrDisposed() {\r\n        if (isClosed()) {\r\n            throw new ConnectionError(ConnectionErrors.Closed, 'Connection is closed.');\r\n        }\r\n        if (isDisposed()) {\r\n            throw new ConnectionError(ConnectionErrors.Disposed, 'Connection is disposed.');\r\n        }\r\n    }\r\n    function throwIfListening() {\r\n        if (isListening()) {\r\n            throw new ConnectionError(ConnectionErrors.AlreadyListening, 'Connection is already listening');\r\n        }\r\n    }\r\n    function throwIfNotListening() {\r\n        if (!isListening()) {\r\n            throw new Error('Call listen() first.');\r\n        }\r\n    }\r\n    function undefinedToNull(param) {\r\n        if (param === void 0) {\r\n            return null;\r\n        }\r\n        else {\r\n            return param;\r\n        }\r\n    }\r\n    function computeMessageParams(type, params) {\r\n        let result;\r\n        let numberOfParams = type.numberOfParams;\r\n        switch (numberOfParams) {\r\n            case 0:\r\n                result = null;\r\n                break;\r\n            case 1:\r\n                result = undefinedToNull(params[0]);\r\n                break;\r\n            default:\r\n                result = [];\r\n                for (let i = 0; i < params.length && i < numberOfParams; i++) {\r\n                    result.push(undefinedToNull(params[i]));\r\n                }\r\n                if (params.length < numberOfParams) {\r\n                    for (let i = params.length; i < numberOfParams; i++) {\r\n                        result.push(null);\r\n                    }\r\n                }\r\n                break;\r\n        }\r\n        return result;\r\n    }\r\n    let connection = {\r\n        sendNotification: (type, ...params) => {\r\n            throwIfClosedOrDisposed();\r\n            let method;\r\n            let messageParams;\r\n            if (Is.string(type)) {\r\n                method = type;\r\n                switch (params.length) {\r\n                    case 0:\r\n                        messageParams = null;\r\n                        break;\r\n                    case 1:\r\n                        messageParams = params[0];\r\n                        break;\r\n                    default:\r\n                        messageParams = params;\r\n                        break;\r\n                }\r\n            }\r\n            else {\r\n                method = type.method;\r\n                messageParams = computeMessageParams(type, params);\r\n            }\r\n            let notificationMessage = {\r\n                jsonrpc: version,\r\n                method: method,\r\n                params: messageParams\r\n            };\r\n            traceSendingNotification(notificationMessage);\r\n            messageWriter.write(notificationMessage);\r\n        },\r\n        onNotification: (type, handler) => {\r\n            throwIfClosedOrDisposed();\r\n            if (Is.func(type)) {\r\n                starNotificationHandler = type;\r\n            }\r\n            else if (handler) {\r\n                if (Is.string(type)) {\r\n                    notificationHandlers[type] = { type: undefined, handler };\r\n                }\r\n                else {\r\n                    notificationHandlers[type.method] = { type, handler };\r\n                }\r\n            }\r\n        },\r\n        onProgress: (_type, token, handler) => {\r\n            if (progressHandlers.has(token)) {\r\n                throw new Error(`Progress handler for token ${token} already registered`);\r\n            }\r\n            progressHandlers.set(token, handler);\r\n            return {\r\n                dispose: () => {\r\n                    progressHandlers.delete(token);\r\n                }\r\n            };\r\n        },\r\n        sendProgress: (_type, token, value) => {\r\n            connection.sendNotification(ProgressNotification.type, { token, value });\r\n        },\r\n        onUnhandledProgress: unhandledProgressEmitter.event,\r\n        sendRequest: (type, ...params) => {\r\n            throwIfClosedOrDisposed();\r\n            throwIfNotListening();\r\n            let method;\r\n            let messageParams;\r\n            let token = undefined;\r\n            if (Is.string(type)) {\r\n                method = type;\r\n                switch (params.length) {\r\n                    case 0:\r\n                        messageParams = null;\r\n                        break;\r\n                    case 1:\r\n                        // The cancellation token is optional so it can also be undefined.\r\n                        if (cancellation_1.CancellationToken.is(params[0])) {\r\n                            messageParams = null;\r\n                            token = params[0];\r\n                        }\r\n                        else {\r\n                            messageParams = undefinedToNull(params[0]);\r\n                        }\r\n                        break;\r\n                    default:\r\n                        const last = params.length - 1;\r\n                        if (cancellation_1.CancellationToken.is(params[last])) {\r\n                            token = params[last];\r\n                            if (params.length === 2) {\r\n                                messageParams = undefinedToNull(params[0]);\r\n                            }\r\n                            else {\r\n                                messageParams = params.slice(0, last).map(value => undefinedToNull(value));\r\n                            }\r\n                        }\r\n                        else {\r\n                            messageParams = params.map(value => undefinedToNull(value));\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n            else {\r\n                method = type.method;\r\n                messageParams = computeMessageParams(type, params);\r\n                let numberOfParams = type.numberOfParams;\r\n                token = cancellation_1.CancellationToken.is(params[numberOfParams]) ? params[numberOfParams] : undefined;\r\n            }\r\n            let id = sequenceNumber++;\r\n            let result = new Promise((resolve, reject) => {\r\n                let requestMessage = {\r\n                    jsonrpc: version,\r\n                    id: id,\r\n                    method: method,\r\n                    params: messageParams\r\n                };\r\n                let responsePromise = { method: method, timerStart: Date.now(), resolve, reject };\r\n                traceSendingRequest(requestMessage);\r\n                try {\r\n                    messageWriter.write(requestMessage);\r\n                }\r\n                catch (e) {\r\n                    // Writing the message failed. So we need to reject the promise.\r\n                    responsePromise.reject(new messages_1.ResponseError(messages_1.ErrorCodes.MessageWriteError, e.message ? e.message : 'Unknown reason'));\r\n                    responsePromise = null;\r\n                }\r\n                if (responsePromise) {\r\n                    responsePromises[String(id)] = responsePromise;\r\n                }\r\n            });\r\n            if (token) {\r\n                token.onCancellationRequested(() => {\r\n                    connection.sendNotification(CancelNotification.type, { id });\r\n                });\r\n            }\r\n            return result;\r\n        },\r\n        onRequest: (type, handler) => {\r\n            throwIfClosedOrDisposed();\r\n            if (Is.func(type)) {\r\n                starRequestHandler = type;\r\n            }\r\n            else if (handler) {\r\n                if (Is.string(type)) {\r\n                    requestHandlers[type] = { type: undefined, handler };\r\n                }\r\n                else {\r\n                    requestHandlers[type.method] = { type, handler };\r\n                }\r\n            }\r\n        },\r\n        trace: (_value, _tracer, sendNotificationOrTraceOptions) => {\r\n            let _sendNotification = false;\r\n            let _traceFormat = TraceFormat.Text;\r\n            if (sendNotificationOrTraceOptions !== void 0) {\r\n                if (Is.boolean(sendNotificationOrTraceOptions)) {\r\n                    _sendNotification = sendNotificationOrTraceOptions;\r\n                }\r\n                else {\r\n                    _sendNotification = sendNotificationOrTraceOptions.sendNotification || false;\r\n                    _traceFormat = sendNotificationOrTraceOptions.traceFormat || TraceFormat.Text;\r\n                }\r\n            }\r\n            trace = _value;\r\n            traceFormat = _traceFormat;\r\n            if (trace === Trace.Off) {\r\n                tracer = undefined;\r\n            }\r\n            else {\r\n                tracer = _tracer;\r\n            }\r\n            if (_sendNotification && !isClosed() && !isDisposed()) {\r\n                connection.sendNotification(SetTraceNotification.type, { value: Trace.toString(_value) });\r\n            }\r\n        },\r\n        onError: errorEmitter.event,\r\n        onClose: closeEmitter.event,\r\n        onUnhandledNotification: unhandledNotificationEmitter.event,\r\n        onDispose: disposeEmitter.event,\r\n        dispose: () => {\r\n            if (isDisposed()) {\r\n                return;\r\n            }\r\n            state = ConnectionState.Disposed;\r\n            disposeEmitter.fire(undefined);\r\n            let error = new Error('Connection got disposed.');\r\n            Object.keys(responsePromises).forEach((key) => {\r\n                responsePromises[key].reject(error);\r\n            });\r\n            responsePromises = Object.create(null);\r\n            requestTokens = Object.create(null);\r\n            messageQueue = new linkedMap_1.LinkedMap();\r\n            // Test for backwards compatibility\r\n            if (Is.func(messageWriter.dispose)) {\r\n                messageWriter.dispose();\r\n            }\r\n            if (Is.func(messageReader.dispose)) {\r\n                messageReader.dispose();\r\n            }\r\n        },\r\n        listen: () => {\r\n            throwIfClosedOrDisposed();\r\n            throwIfListening();\r\n            state = ConnectionState.Listening;\r\n            messageReader.listen(callback);\r\n        },\r\n        inspect: () => {\r\n            console.log(\"inspect\");\r\n        }\r\n    };\r\n    connection.onNotification(LogTraceNotification.type, (params) => {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        tracer.log(params.message, trace === Trace.Verbose ? params.verbose : undefined);\r\n    });\r\n    connection.onNotification(ProgressNotification.type, (params) => {\r\n        const handler = progressHandlers.get(params.token);\r\n        if (handler) {\r\n            handler(params.value);\r\n        }\r\n        else {\r\n            unhandledProgressEmitter.fire(params);\r\n        }\r\n    });\r\n    return connection;\r\n}\r\nfunction isMessageReader(value) {\r\n    return value.listen !== void 0 && value.read === void 0;\r\n}\r\nfunction isMessageWriter(value) {\r\n    return value.write !== void 0 && value.end === void 0;\r\n}\r\nfunction createMessageConnection(input, output, logger, strategy) {\r\n    if (!logger) {\r\n        logger = exports.NullLogger;\r\n    }\r\n    let reader = isMessageReader(input) ? input : new messageReader_1.StreamMessageReader(input);\r\n    let writer = isMessageWriter(output) ? output : new messageWriter_1.StreamMessageWriter(output);\r\n    return _createMessageConnection(reader, writer, logger, strategy);\r\n}\r\nexports.createMessageConnection = createMessageConnection;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nexports.ErrorCodes = vscode_jsonrpc_1.ErrorCodes;\r\nexports.ResponseError = vscode_jsonrpc_1.ResponseError;\r\nexports.CancellationToken = vscode_jsonrpc_1.CancellationToken;\r\nexports.CancellationTokenSource = vscode_jsonrpc_1.CancellationTokenSource;\r\nexports.Disposable = vscode_jsonrpc_1.Disposable;\r\nexports.Event = vscode_jsonrpc_1.Event;\r\nexports.Emitter = vscode_jsonrpc_1.Emitter;\r\nexports.Trace = vscode_jsonrpc_1.Trace;\r\nexports.TraceFormat = vscode_jsonrpc_1.TraceFormat;\r\nexports.SetTraceNotification = vscode_jsonrpc_1.SetTraceNotification;\r\nexports.LogTraceNotification = vscode_jsonrpc_1.LogTraceNotification;\r\nexports.RequestType = vscode_jsonrpc_1.RequestType;\r\nexports.RequestType0 = vscode_jsonrpc_1.RequestType0;\r\nexports.NotificationType = vscode_jsonrpc_1.NotificationType;\r\nexports.NotificationType0 = vscode_jsonrpc_1.NotificationType0;\r\nexports.MessageReader = vscode_jsonrpc_1.MessageReader;\r\nexports.MessageWriter = vscode_jsonrpc_1.MessageWriter;\r\nexports.ConnectionStrategy = vscode_jsonrpc_1.ConnectionStrategy;\r\nexports.StreamMessageReader = vscode_jsonrpc_1.StreamMessageReader;\r\nexports.StreamMessageWriter = vscode_jsonrpc_1.StreamMessageWriter;\r\nexports.IPCMessageReader = vscode_jsonrpc_1.IPCMessageReader;\r\nexports.IPCMessageWriter = vscode_jsonrpc_1.IPCMessageWriter;\r\nexports.createClientPipeTransport = vscode_jsonrpc_1.createClientPipeTransport;\r\nexports.createServerPipeTransport = vscode_jsonrpc_1.createServerPipeTransport;\r\nexports.generateRandomPipeName = vscode_jsonrpc_1.generateRandomPipeName;\r\nexports.createClientSocketTransport = vscode_jsonrpc_1.createClientSocketTransport;\r\nexports.createServerSocketTransport = vscode_jsonrpc_1.createServerSocketTransport;\r\nexports.ProgressType = vscode_jsonrpc_1.ProgressType;\r\n__export(require(\"vscode-languageserver-types\"));\r\n__export(require(\"./protocol\"));\r\nconst callHierarchy = require(\"./protocol.callHierarchy.proposed\");\r\nconst progress = require(\"./protocol.progress.proposed\");\r\nvar Proposed;\r\n(function (Proposed) {\r\n    let CallHierarchyRequest;\r\n    (function (CallHierarchyRequest) {\r\n        CallHierarchyRequest.type = callHierarchy.CallHierarchyRequest.type;\r\n    })(CallHierarchyRequest = Proposed.CallHierarchyRequest || (Proposed.CallHierarchyRequest = {}));\r\n    let CallHierarchyDirection;\r\n    (function (CallHierarchyDirection) {\r\n        CallHierarchyDirection.CallsFrom = callHierarchy.CallHierarchyDirection.CallsFrom;\r\n        CallHierarchyDirection.CallsTo = callHierarchy.CallHierarchyDirection.CallsTo;\r\n    })(CallHierarchyDirection = Proposed.CallHierarchyDirection || (Proposed.CallHierarchyDirection = {}));\r\n    // export type ProgressServerCapabilities = progress.ProgressServerCapabilities;\r\n    let WorkDoneProgress;\r\n    (function (WorkDoneProgress) {\r\n        WorkDoneProgress.type = progress.WorkDoneProgress.type;\r\n    })(WorkDoneProgress = Proposed.WorkDoneProgress || (Proposed.WorkDoneProgress = {}));\r\n    let WorkDoneProgressCreateRequest;\r\n    (function (WorkDoneProgressCreateRequest) {\r\n        WorkDoneProgressCreateRequest.type = progress.WorkDoneProgressCreateRequest.type;\r\n    })(WorkDoneProgressCreateRequest = Proposed.WorkDoneProgressCreateRequest || (Proposed.WorkDoneProgressCreateRequest = {}));\r\n    let WorkDoneProgressCancelNotification;\r\n    (function (WorkDoneProgressCancelNotification) {\r\n        WorkDoneProgressCancelNotification.type = progress.WorkDoneProgressCancelNotification.type;\r\n    })(WorkDoneProgressCancelNotification = Proposed.WorkDoneProgressCancelNotification || (Proposed.WorkDoneProgressCancelNotification = {}));\r\n})(Proposed = exports.Proposed || (exports.Proposed = {}));\r\nfunction createProtocolConnection(reader, writer, logger, strategy) {\r\n    return vscode_jsonrpc_1.createMessageConnection(reader, writer, logger, strategy);\r\n}\r\nexports.createProtocolConnection = createProtocolConnection;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction boolean(value) {\r\n    return value === true || value === false;\r\n}\r\nexports.boolean = boolean;\r\nfunction string(value) {\r\n    return typeof value === 'string' || value instanceof String;\r\n}\r\nexports.string = string;\r\nfunction number(value) {\r\n    return typeof value === 'number' || value instanceof Number;\r\n}\r\nexports.number = number;\r\nfunction error(value) {\r\n    return value instanceof Error;\r\n}\r\nexports.error = error;\r\nfunction func(value) {\r\n    return typeof value === 'function';\r\n}\r\nexports.func = func;\r\nfunction array(value) {\r\n    return Array.isArray(value);\r\n}\r\nexports.array = array;\r\nfunction stringArray(value) {\r\n    return array(value) && value.every(elem => string(elem));\r\n}\r\nexports.stringArray = stringArray;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Disposable;\r\n(function (Disposable) {\r\n    function create(func) {\r\n        return {\r\n            dispose: func\r\n        };\r\n    }\r\n    Disposable.create = create;\r\n})(Disposable = exports.Disposable || (exports.Disposable = {}));\r\nvar Event;\r\n(function (Event) {\r\n    const _disposable = { dispose() { } };\r\n    Event.None = function () { return _disposable; };\r\n})(Event = exports.Event || (exports.Event = {}));\r\nclass CallbackList {\r\n    add(callback, context = null, bucket) {\r\n        if (!this._callbacks) {\r\n            this._callbacks = [];\r\n            this._contexts = [];\r\n        }\r\n        this._callbacks.push(callback);\r\n        this._contexts.push(context);\r\n        if (Array.isArray(bucket)) {\r\n            bucket.push({ dispose: () => this.remove(callback, context) });\r\n        }\r\n    }\r\n    remove(callback, context = null) {\r\n        if (!this._callbacks) {\r\n            return;\r\n        }\r\n        var foundCallbackWithDifferentContext = false;\r\n        for (var i = 0, len = this._callbacks.length; i < len; i++) {\r\n            if (this._callbacks[i] === callback) {\r\n                if (this._contexts[i] === context) {\r\n                    // callback & context match => remove it\r\n                    this._callbacks.splice(i, 1);\r\n                    this._contexts.splice(i, 1);\r\n                    return;\r\n                }\r\n                else {\r\n                    foundCallbackWithDifferentContext = true;\r\n                }\r\n            }\r\n        }\r\n        if (foundCallbackWithDifferentContext) {\r\n            throw new Error('When adding a listener with a context, you should remove it with the same context');\r\n        }\r\n    }\r\n    invoke(...args) {\r\n        if (!this._callbacks) {\r\n            return [];\r\n        }\r\n        var ret = [], callbacks = this._callbacks.slice(0), contexts = this._contexts.slice(0);\r\n        for (var i = 0, len = callbacks.length; i < len; i++) {\r\n            try {\r\n                ret.push(callbacks[i].apply(contexts[i], args));\r\n            }\r\n            catch (e) {\r\n                console.error(e);\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    isEmpty() {\r\n        return !this._callbacks || this._callbacks.length === 0;\r\n    }\r\n    dispose() {\r\n        this._callbacks = undefined;\r\n        this._contexts = undefined;\r\n    }\r\n}\r\nclass Emitter {\r\n    constructor(_options) {\r\n        this._options = _options;\r\n    }\r\n    /**\r\n     * For the public to allow to subscribe\r\n     * to events from this Emitter\r\n     */\r\n    get event() {\r\n        if (!this._event) {\r\n            this._event = (listener, thisArgs, disposables) => {\r\n                if (!this._callbacks) {\r\n                    this._callbacks = new CallbackList();\r\n                }\r\n                if (this._options && this._options.onFirstListenerAdd && this._callbacks.isEmpty()) {\r\n                    this._options.onFirstListenerAdd(this);\r\n                }\r\n                this._callbacks.add(listener, thisArgs);\r\n                let result;\r\n                result = {\r\n                    dispose: () => {\r\n                        this._callbacks.remove(listener, thisArgs);\r\n                        result.dispose = Emitter._noop;\r\n                        if (this._options && this._options.onLastListenerRemove && this._callbacks.isEmpty()) {\r\n                            this._options.onLastListenerRemove(this);\r\n                        }\r\n                    }\r\n                };\r\n                if (Array.isArray(disposables)) {\r\n                    disposables.push(result);\r\n                }\r\n                return result;\r\n            };\r\n        }\r\n        return this._event;\r\n    }\r\n    /**\r\n     * To be kept private to fire an event to\r\n     * subscribers\r\n     */\r\n    fire(event) {\r\n        if (this._callbacks) {\r\n            this._callbacks.invoke.call(this._callbacks, event);\r\n        }\r\n    }\r\n    dispose() {\r\n        if (this._callbacks) {\r\n            this._callbacks.dispose();\r\n            this._callbacks = undefined;\r\n        }\r\n    }\r\n}\r\nEmitter._noop = function () { };\r\nexports.Emitter = Emitter;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst events_1 = require(\"./events\");\r\nconst Is = require(\"./is\");\r\nlet DefaultSize = 8192;\r\nlet CR = Buffer.from('\\r', 'ascii')[0];\r\nlet LF = Buffer.from('\\n', 'ascii')[0];\r\nlet CRLF = '\\r\\n';\r\nclass MessageBuffer {\r\n    constructor(encoding = 'utf8') {\r\n        this.encoding = encoding;\r\n        this.index = 0;\r\n        this.buffer = Buffer.allocUnsafe(DefaultSize);\r\n    }\r\n    append(chunk) {\r\n        var toAppend = chunk;\r\n        if (typeof (chunk) === 'string') {\r\n            var str = chunk;\r\n            var bufferLen = Buffer.byteLength(str, this.encoding);\r\n            toAppend = Buffer.allocUnsafe(bufferLen);\r\n            toAppend.write(str, 0, bufferLen, this.encoding);\r\n        }\r\n        if (this.buffer.length - this.index >= toAppend.length) {\r\n            toAppend.copy(this.buffer, this.index, 0, toAppend.length);\r\n        }\r\n        else {\r\n            var newSize = (Math.ceil((this.index + toAppend.length) / DefaultSize) + 1) * DefaultSize;\r\n            if (this.index === 0) {\r\n                this.buffer = Buffer.allocUnsafe(newSize);\r\n                toAppend.copy(this.buffer, 0, 0, toAppend.length);\r\n            }\r\n            else {\r\n                this.buffer = Buffer.concat([this.buffer.slice(0, this.index), toAppend], newSize);\r\n            }\r\n        }\r\n        this.index += toAppend.length;\r\n    }\r\n    tryReadHeaders() {\r\n        let result = undefined;\r\n        let current = 0;\r\n        while (current + 3 < this.index && (this.buffer[current] !== CR || this.buffer[current + 1] !== LF || this.buffer[current + 2] !== CR || this.buffer[current + 3] !== LF)) {\r\n            current++;\r\n        }\r\n        // No header / body separator found (e.g CRLFCRLF)\r\n        if (current + 3 >= this.index) {\r\n            return result;\r\n        }\r\n        result = Object.create(null);\r\n        let headers = this.buffer.toString('ascii', 0, current).split(CRLF);\r\n        headers.forEach((header) => {\r\n            let index = header.indexOf(':');\r\n            if (index === -1) {\r\n                throw new Error('Message header must separate key and value using :');\r\n            }\r\n            let key = header.substr(0, index);\r\n            let value = header.substr(index + 1).trim();\r\n            result[key] = value;\r\n        });\r\n        let nextStart = current + 4;\r\n        this.buffer = this.buffer.slice(nextStart);\r\n        this.index = this.index - nextStart;\r\n        return result;\r\n    }\r\n    tryReadContent(length) {\r\n        if (this.index < length) {\r\n            return null;\r\n        }\r\n        let result = this.buffer.toString(this.encoding, 0, length);\r\n        let nextStart = length;\r\n        this.buffer.copy(this.buffer, 0, nextStart);\r\n        this.index = this.index - nextStart;\r\n        return result;\r\n    }\r\n    get numberOfBytes() {\r\n        return this.index;\r\n    }\r\n}\r\nvar MessageReader;\r\n(function (MessageReader) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && Is.func(candidate.listen) && Is.func(candidate.dispose) &&\r\n            Is.func(candidate.onError) && Is.func(candidate.onClose) && Is.func(candidate.onPartialMessage);\r\n    }\r\n    MessageReader.is = is;\r\n})(MessageReader = exports.MessageReader || (exports.MessageReader = {}));\r\nclass AbstractMessageReader {\r\n    constructor() {\r\n        this.errorEmitter = new events_1.Emitter();\r\n        this.closeEmitter = new events_1.Emitter();\r\n        this.partialMessageEmitter = new events_1.Emitter();\r\n    }\r\n    dispose() {\r\n        this.errorEmitter.dispose();\r\n        this.closeEmitter.dispose();\r\n    }\r\n    get onError() {\r\n        return this.errorEmitter.event;\r\n    }\r\n    fireError(error) {\r\n        this.errorEmitter.fire(this.asError(error));\r\n    }\r\n    get onClose() {\r\n        return this.closeEmitter.event;\r\n    }\r\n    fireClose() {\r\n        this.closeEmitter.fire(undefined);\r\n    }\r\n    get onPartialMessage() {\r\n        return this.partialMessageEmitter.event;\r\n    }\r\n    firePartialMessage(info) {\r\n        this.partialMessageEmitter.fire(info);\r\n    }\r\n    asError(error) {\r\n        if (error instanceof Error) {\r\n            return error;\r\n        }\r\n        else {\r\n            return new Error(`Reader received error. Reason: ${Is.string(error.message) ? error.message : 'unknown'}`);\r\n        }\r\n    }\r\n}\r\nexports.AbstractMessageReader = AbstractMessageReader;\r\nclass StreamMessageReader extends AbstractMessageReader {\r\n    constructor(readable, encoding = 'utf8') {\r\n        super();\r\n        this.readable = readable;\r\n        this.buffer = new MessageBuffer(encoding);\r\n        this._partialMessageTimeout = 10000;\r\n    }\r\n    set partialMessageTimeout(timeout) {\r\n        this._partialMessageTimeout = timeout;\r\n    }\r\n    get partialMessageTimeout() {\r\n        return this._partialMessageTimeout;\r\n    }\r\n    listen(callback) {\r\n        this.nextMessageLength = -1;\r\n        this.messageToken = 0;\r\n        this.partialMessageTimer = undefined;\r\n        this.callback = callback;\r\n        this.readable.on('data', (data) => {\r\n            this.onData(data);\r\n        });\r\n        this.readable.on('error', (error) => this.fireError(error));\r\n        this.readable.on('close', () => this.fireClose());\r\n    }\r\n    onData(data) {\r\n        this.buffer.append(data);\r\n        while (true) {\r\n            if (this.nextMessageLength === -1) {\r\n                let headers = this.buffer.tryReadHeaders();\r\n                if (!headers) {\r\n                    return;\r\n                }\r\n                let contentLength = headers['Content-Length'];\r\n                if (!contentLength) {\r\n                    throw new Error('Header must provide a Content-Length property.');\r\n                }\r\n                let length = parseInt(contentLength);\r\n                if (isNaN(length)) {\r\n                    throw new Error('Content-Length value must be a number.');\r\n                }\r\n                this.nextMessageLength = length;\r\n                // Take the encoding form the header. For compatibility\r\n                // treat both utf-8 and utf8 as node utf8\r\n            }\r\n            var msg = this.buffer.tryReadContent(this.nextMessageLength);\r\n            if (msg === null) {\r\n                /** We haven't received the full message yet. */\r\n                this.setPartialMessageTimer();\r\n                return;\r\n            }\r\n            this.clearPartialMessageTimer();\r\n            this.nextMessageLength = -1;\r\n            this.messageToken++;\r\n            var json = JSON.parse(msg);\r\n            this.callback(json);\r\n        }\r\n    }\r\n    clearPartialMessageTimer() {\r\n        if (this.partialMessageTimer) {\r\n            clearTimeout(this.partialMessageTimer);\r\n            this.partialMessageTimer = undefined;\r\n        }\r\n    }\r\n    setPartialMessageTimer() {\r\n        this.clearPartialMessageTimer();\r\n        if (this._partialMessageTimeout <= 0) {\r\n            return;\r\n        }\r\n        this.partialMessageTimer = setTimeout((token, timeout) => {\r\n            this.partialMessageTimer = undefined;\r\n            if (token === this.messageToken) {\r\n                this.firePartialMessage({ messageToken: token, waitingTime: timeout });\r\n                this.setPartialMessageTimer();\r\n            }\r\n        }, this._partialMessageTimeout, this.messageToken, this._partialMessageTimeout);\r\n    }\r\n}\r\nexports.StreamMessageReader = StreamMessageReader;\r\nclass IPCMessageReader extends AbstractMessageReader {\r\n    constructor(process) {\r\n        super();\r\n        this.process = process;\r\n        let eventEmitter = this.process;\r\n        eventEmitter.on('error', (error) => this.fireError(error));\r\n        eventEmitter.on('close', () => this.fireClose());\r\n    }\r\n    listen(callback) {\r\n        this.process.on('message', callback);\r\n    }\r\n}\r\nexports.IPCMessageReader = IPCMessageReader;\r\nclass SocketMessageReader extends StreamMessageReader {\r\n    constructor(socket, encoding = 'utf-8') {\r\n        super(socket, encoding);\r\n    }\r\n}\r\nexports.SocketMessageReader = SocketMessageReader;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst events_1 = require(\"./events\");\r\nconst Is = require(\"./is\");\r\nlet ContentLength = 'Content-Length: ';\r\nlet CRLF = '\\r\\n';\r\nvar MessageWriter;\r\n(function (MessageWriter) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && Is.func(candidate.dispose) && Is.func(candidate.onClose) &&\r\n            Is.func(candidate.onError) && Is.func(candidate.write);\r\n    }\r\n    MessageWriter.is = is;\r\n})(MessageWriter = exports.MessageWriter || (exports.MessageWriter = {}));\r\nclass AbstractMessageWriter {\r\n    constructor() {\r\n        this.errorEmitter = new events_1.Emitter();\r\n        this.closeEmitter = new events_1.Emitter();\r\n    }\r\n    dispose() {\r\n        this.errorEmitter.dispose();\r\n        this.closeEmitter.dispose();\r\n    }\r\n    get onError() {\r\n        return this.errorEmitter.event;\r\n    }\r\n    fireError(error, message, count) {\r\n        this.errorEmitter.fire([this.asError(error), message, count]);\r\n    }\r\n    get onClose() {\r\n        return this.closeEmitter.event;\r\n    }\r\n    fireClose() {\r\n        this.closeEmitter.fire(undefined);\r\n    }\r\n    asError(error) {\r\n        if (error instanceof Error) {\r\n            return error;\r\n        }\r\n        else {\r\n            return new Error(`Writer received error. Reason: ${Is.string(error.message) ? error.message : 'unknown'}`);\r\n        }\r\n    }\r\n}\r\nexports.AbstractMessageWriter = AbstractMessageWriter;\r\nclass StreamMessageWriter extends AbstractMessageWriter {\r\n    constructor(writable, encoding = 'utf8') {\r\n        super();\r\n        this.writable = writable;\r\n        this.encoding = encoding;\r\n        this.errorCount = 0;\r\n        this.writable.on('error', (error) => this.fireError(error));\r\n        this.writable.on('close', () => this.fireClose());\r\n    }\r\n    write(msg) {\r\n        let json = JSON.stringify(msg);\r\n        let contentLength = Buffer.byteLength(json, this.encoding);\r\n        let headers = [\r\n            ContentLength, contentLength.toString(), CRLF,\r\n            CRLF\r\n        ];\r\n        try {\r\n            // Header must be written in ASCII encoding\r\n            this.writable.write(headers.join(''), 'ascii');\r\n            // Now write the content. This can be written in any encoding\r\n            this.writable.write(json, this.encoding);\r\n            this.errorCount = 0;\r\n        }\r\n        catch (error) {\r\n            this.errorCount++;\r\n            this.fireError(error, msg, this.errorCount);\r\n        }\r\n    }\r\n}\r\nexports.StreamMessageWriter = StreamMessageWriter;\r\nclass IPCMessageWriter extends AbstractMessageWriter {\r\n    constructor(process) {\r\n        super();\r\n        this.process = process;\r\n        this.errorCount = 0;\r\n        this.queue = [];\r\n        this.sending = false;\r\n        let eventEmitter = this.process;\r\n        eventEmitter.on('error', (error) => this.fireError(error));\r\n        eventEmitter.on('close', () => this.fireClose);\r\n    }\r\n    write(msg) {\r\n        if (!this.sending && this.queue.length === 0) {\r\n            // See https://github.com/nodejs/node/issues/7657\r\n            this.doWriteMessage(msg);\r\n        }\r\n        else {\r\n            this.queue.push(msg);\r\n        }\r\n    }\r\n    doWriteMessage(msg) {\r\n        try {\r\n            if (this.process.send) {\r\n                this.sending = true;\r\n                this.process.send(msg, undefined, undefined, (error) => {\r\n                    this.sending = false;\r\n                    if (error) {\r\n                        this.errorCount++;\r\n                        this.fireError(error, msg, this.errorCount);\r\n                    }\r\n                    else {\r\n                        this.errorCount = 0;\r\n                    }\r\n                    if (this.queue.length > 0) {\r\n                        this.doWriteMessage(this.queue.shift());\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        catch (error) {\r\n            this.errorCount++;\r\n            this.fireError(error, msg, this.errorCount);\r\n        }\r\n    }\r\n}\r\nexports.IPCMessageWriter = IPCMessageWriter;\r\nclass SocketMessageWriter extends AbstractMessageWriter {\r\n    constructor(socket, encoding = 'utf8') {\r\n        super();\r\n        this.socket = socket;\r\n        this.queue = [];\r\n        this.sending = false;\r\n        this.encoding = encoding;\r\n        this.errorCount = 0;\r\n        this.socket.on('error', (error) => this.fireError(error));\r\n        this.socket.on('close', () => this.fireClose());\r\n    }\r\n    dispose() {\r\n        super.dispose();\r\n        this.socket.destroy();\r\n    }\r\n    write(msg) {\r\n        if (!this.sending && this.queue.length === 0) {\r\n            // See https://github.com/nodejs/node/issues/7657\r\n            this.doWriteMessage(msg);\r\n        }\r\n        else {\r\n            this.queue.push(msg);\r\n        }\r\n    }\r\n    doWriteMessage(msg) {\r\n        let json = JSON.stringify(msg);\r\n        let contentLength = Buffer.byteLength(json, this.encoding);\r\n        let headers = [\r\n            ContentLength, contentLength.toString(), CRLF,\r\n            CRLF\r\n        ];\r\n        try {\r\n            // Header must be written in ASCII encoding\r\n            this.sending = true;\r\n            this.socket.write(headers.join(''), 'ascii', (error) => {\r\n                if (error) {\r\n                    this.handleError(error, msg);\r\n                }\r\n                try {\r\n                    // Now write the content. This can be written in any encoding\r\n                    this.socket.write(json, this.encoding, (error) => {\r\n                        this.sending = false;\r\n                        if (error) {\r\n                            this.handleError(error, msg);\r\n                        }\r\n                        else {\r\n                            this.errorCount = 0;\r\n                        }\r\n                        if (this.queue.length > 0) {\r\n                            this.doWriteMessage(this.queue.shift());\r\n                        }\r\n                    });\r\n                }\r\n                catch (error) {\r\n                    this.handleError(error, msg);\r\n                }\r\n            });\r\n        }\r\n        catch (error) {\r\n            this.handleError(error, msg);\r\n        }\r\n    }\r\n    handleError(error, msg) {\r\n        this.errorCount++;\r\n        this.fireError(error, msg, this.errorCount);\r\n    }\r\n}\r\nexports.SocketMessageWriter = SocketMessageWriter;\r\n","module.exports = require(\"path\");","module.exports = require(\"os\");","module.exports = require(\"net\");","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction boolean(value) {\r\n    return value === true || value === false;\r\n}\r\nexports.boolean = boolean;\r\nfunction string(value) {\r\n    return typeof value === 'string' || value instanceof String;\r\n}\r\nexports.string = string;\r\nfunction number(value) {\r\n    return typeof value === 'number' || value instanceof Number;\r\n}\r\nexports.number = number;\r\nfunction error(value) {\r\n    return value instanceof Error;\r\n}\r\nexports.error = error;\r\nfunction func(value) {\r\n    return typeof value === 'function';\r\n}\r\nexports.func = func;\r\nfunction array(value) {\r\n    return Array.isArray(value);\r\n}\r\nexports.array = array;\r\nfunction stringArray(value) {\r\n    return array(value) && value.every(elem => string(elem));\r\n}\r\nexports.stringArray = stringArray;\r\nfunction typedArray(value, check) {\r\n    return Array.isArray(value) && value.every(check);\r\n}\r\nexports.typedArray = typedArray;\r\nfunction thenable(value) {\r\n    return value && func(value.then);\r\n}\r\nexports.thenable = thenable;\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass ValueUUID {\r\n    constructor(_value) {\r\n        this._value = _value;\r\n        // empty\r\n    }\r\n    asHex() {\r\n        return this._value;\r\n    }\r\n    equals(other) {\r\n        return this.asHex() === other.asHex();\r\n    }\r\n}\r\nclass V4UUID extends ValueUUID {\r\n    constructor() {\r\n        super([\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            '-',\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            '-',\r\n            '4',\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            '-',\r\n            V4UUID._oneOf(V4UUID._timeHighBits),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            '-',\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n        ].join(''));\r\n    }\r\n    static _oneOf(array) {\r\n        return array[Math.floor(array.length * Math.random())];\r\n    }\r\n    static _randomHex() {\r\n        return V4UUID._oneOf(V4UUID._chars);\r\n    }\r\n}\r\nV4UUID._chars = ['0', '1', '2', '3', '4', '5', '6', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'];\r\nV4UUID._timeHighBits = ['8', '9', 'a', 'b'];\r\n/**\r\n * An empty UUID that contains only zeros.\r\n */\r\nexports.empty = new ValueUUID('00000000-0000-0000-0000-000000000000');\r\nfunction v4() {\r\n    return new V4UUID();\r\n}\r\nexports.v4 = v4;\r\nconst _UUIDPattern = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\r\nfunction isUUID(value) {\r\n    return _UUIDPattern.test(value);\r\n}\r\nexports.isUUID = isUUID;\r\n/**\r\n * Parses a UUID that is of the format xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.\r\n * @param value A uuid string.\r\n */\r\nfunction parse(value) {\r\n    if (!isUUID(value)) {\r\n        throw new Error('invalid uuid');\r\n    }\r\n    return new ValueUUID(value);\r\n}\r\nexports.parse = parse;\r\nfunction generateUuid() {\r\n    return v4().asHex();\r\n}\r\nexports.generateUuid = generateUuid;\r\n","module.exports = require(\"child_process\");","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst position_1 = require(\"./common/position\");\nconst rbTreeBase_1 = require(\"./rbTreeBase\");\n// const lfRegex = new RegExp(/\\r\\n|\\r|\\n/g);\nexports.AverageBufferSize = 65535;\nfunction createUintArray(arr) {\n    let r;\n    if (arr[arr.length - 1] < 65536) {\n        r = new Uint16Array(arr.length);\n    }\n    else {\n        r = new Uint32Array(arr.length);\n    }\n    r.set(arr, 0);\n    return r;\n}\nexports.createUintArray = createUintArray;\nclass LineStarts {\n    constructor(lineStarts, cr, lf, crlf, isBasicASCII) {\n        this.lineStarts = lineStarts;\n        this.cr = cr;\n        this.lf = lf;\n        this.crlf = crlf;\n        this.isBasicASCII = isBasicASCII;\n    }\n}\nexports.LineStarts = LineStarts;\nfunction createLineStartsFast(str, readonly = true) {\n    let r = [0], rLength = 1;\n    for (let i = 0, len = str.length; i < len; i++) {\n        const chr = str.charCodeAt(i);\n        if (chr === 13 /* CarriageReturn */) {\n            if (i + 1 < len && str.charCodeAt(i + 1) === 10 /* LineFeed */) {\n                // \\r\\n... case\n                r[rLength++] = i + 2;\n                i++; // skip \\n\n            }\n            else {\n                // \\r... case\n                r[rLength++] = i + 1;\n            }\n        }\n        else if (chr === 10 /* LineFeed */) {\n            r[rLength++] = i + 1;\n        }\n    }\n    if (readonly) {\n        return createUintArray(r);\n    }\n    else {\n        return r;\n    }\n}\nexports.createLineStartsFast = createLineStartsFast;\nfunction createLineStarts(r, str) {\n    r.length = 0;\n    r[0] = 0;\n    let rLength = 1;\n    let cr = 0, lf = 0, crlf = 0;\n    let isBasicASCII = true;\n    for (let i = 0, len = str.length; i < len; i++) {\n        const chr = str.charCodeAt(i);\n        if (chr === 13 /* CarriageReturn */) {\n            if (i + 1 < len && str.charCodeAt(i + 1) === 10 /* LineFeed */) {\n                // \\r\\n... case\n                crlf++;\n                r[rLength++] = i + 2;\n                i++; // skip \\n\n            }\n            else {\n                cr++;\n                // \\r... case\n                r[rLength++] = i + 1;\n            }\n        }\n        else if (chr === 10 /* LineFeed */) {\n            lf++;\n            r[rLength++] = i + 1;\n        }\n        else {\n            if (isBasicASCII) {\n                if (chr !== 9 /* Tab */ && (chr < 32 || chr > 126)) {\n                    isBasicASCII = false;\n                }\n            }\n        }\n    }\n    const result = new LineStarts(createUintArray(r), cr, lf, crlf, isBasicASCII);\n    r.length = 0;\n    return result;\n}\nexports.createLineStarts = createLineStarts;\nclass Piece {\n    constructor(bufferIndex, start, end, lineFeedCnt, length) {\n        this.bufferIndex = bufferIndex;\n        this.start = start;\n        this.end = end;\n        this.lineFeedCnt = lineFeedCnt;\n        this.length = length;\n    }\n}\nexports.Piece = Piece;\nclass StringBuffer {\n    constructor(buffer, lineStarts) {\n        this.buffer = buffer;\n        this.lineStarts = lineStarts;\n    }\n}\nexports.StringBuffer = StringBuffer;\n/**\n * Readonly snapshot for piece tree.\n * In a real multiple thread environment, to make snapshot reading always work correctly, we need to\n * 1. Make TreeNode.piece immutable, then reading and writing can run in parallel.\n * 2. TreeNode/Buffers normalization should not happen during snapshot reading.\n */\nclass PieceTreeSnapshot {\n    constructor(tree, BOM) {\n        this._pieces = [];\n        this._tree = tree;\n        this._BOM = BOM;\n        this._index = 0;\n        if (tree.root !== rbTreeBase_1.SENTINEL) {\n            tree.iterate(tree.root, node => {\n                if (node !== rbTreeBase_1.SENTINEL) {\n                    this._pieces.push(node.piece);\n                }\n                return true;\n            });\n        }\n    }\n    read() {\n        if (this._pieces.length === 0) {\n            if (this._index === 0) {\n                this._index++;\n                return this._BOM;\n            }\n            else {\n                return null;\n            }\n        }\n        if (this._index > this._pieces.length - 1) {\n            return null;\n        }\n        if (this._index === 0) {\n            return this._BOM + this._tree.getPieceContent(this._pieces[this._index++]);\n        }\n        return this._tree.getPieceContent(this._pieces[this._index++]);\n    }\n}\nclass PieceTreeSearchCache {\n    constructor(limit) {\n        this._limit = limit;\n        this._cache = [];\n    }\n    get(offset) {\n        for (let i = this._cache.length - 1; i >= 0; i--) {\n            let nodePos = this._cache[i];\n            if (nodePos.nodeStartOffset <= offset && nodePos.nodeStartOffset + nodePos.node.piece.length >= offset) {\n                return nodePos;\n            }\n        }\n        return null;\n    }\n    get2(lineNumber) {\n        for (let i = this._cache.length - 1; i >= 0; i--) {\n            let nodePos = this._cache[i];\n            if (nodePos.nodeStartLineNumber && nodePos.nodeStartLineNumber < lineNumber && nodePos.nodeStartLineNumber + nodePos.node.piece.lineFeedCnt >= lineNumber) {\n                return nodePos;\n            }\n        }\n        return null;\n    }\n    set(nodePosition) {\n        if (this._cache.length >= this._limit) {\n            this._cache.shift();\n        }\n        this._cache.push(nodePosition);\n    }\n    valdiate(offset) {\n        let hasInvalidVal = false;\n        let tmp = this._cache;\n        for (let i = 0; i < tmp.length; i++) {\n            let nodePos = tmp[i];\n            if (nodePos.node.parent === null || nodePos.nodeStartOffset >= offset) {\n                tmp[i] = null;\n                hasInvalidVal = true;\n                continue;\n            }\n        }\n        if (hasInvalidVal) {\n            let newArr = [];\n            for (const entry of tmp) {\n                if (entry !== null) {\n                    newArr.push(entry);\n                }\n            }\n            this._cache = newArr;\n        }\n    }\n}\nclass PieceTreeBase {\n    constructor(chunks, eol, eolNormalized) {\n        this.create(chunks, eol, eolNormalized);\n    }\n    create(chunks, eol, eolNormalized) {\n        this._buffers = [\n            new StringBuffer('', [0])\n        ];\n        this._lastChangeBufferPos = { line: 0, column: 0 };\n        this.root = rbTreeBase_1.SENTINEL;\n        this._lineCnt = 1;\n        this._length = 0;\n        this._EOL = eol;\n        this._EOLLength = eol.length;\n        this._EOLNormalized = eolNormalized;\n        let lastNode = null;\n        for (let i = 0, len = chunks.length; i < len; i++) {\n            if (chunks[i].buffer.length > 0) {\n                if (!chunks[i].lineStarts) {\n                    chunks[i].lineStarts = createLineStartsFast(chunks[i].buffer);\n                }\n                let piece = new Piece(i + 1, { line: 0, column: 0 }, { line: chunks[i].lineStarts.length - 1, column: chunks[i].buffer.length - chunks[i].lineStarts[chunks[i].lineStarts.length - 1] }, chunks[i].lineStarts.length - 1, chunks[i].buffer.length);\n                this._buffers.push(chunks[i]);\n                lastNode = this.rbInsertRight(lastNode, piece);\n            }\n        }\n        this._searchCache = new PieceTreeSearchCache(1);\n        this._lastVisitedLine = { lineNumber: 0, value: '' };\n        this.computeBufferMetadata();\n    }\n    normalizeEOL(eol) {\n        let averageBufferSize = exports.AverageBufferSize;\n        let min = averageBufferSize - Math.floor(averageBufferSize / 3);\n        let max = min * 2;\n        let tempChunk = '';\n        let tempChunkLen = 0;\n        let chunks = [];\n        this.iterate(this.root, node => {\n            let str = this.getNodeContent(node);\n            let len = str.length;\n            if (tempChunkLen <= min || tempChunkLen + len < max) {\n                tempChunk += str;\n                tempChunkLen += len;\n                return true;\n            }\n            // flush anyways\n            let text = tempChunk.replace(/\\r\\n|\\r|\\n/g, eol);\n            chunks.push(new StringBuffer(text, createLineStartsFast(text)));\n            tempChunk = str;\n            tempChunkLen = len;\n            return true;\n        });\n        if (tempChunkLen > 0) {\n            let text = tempChunk.replace(/\\r\\n|\\r|\\n/g, eol);\n            chunks.push(new StringBuffer(text, createLineStartsFast(text)));\n        }\n        this.create(chunks, eol, true);\n    }\n    // #region Buffer API\n    getEOL() {\n        return this._EOL;\n    }\n    setEOL(newEOL) {\n        this._EOL = newEOL;\n        this._EOLLength = this._EOL.length;\n        this.normalizeEOL(newEOL);\n    }\n    createSnapshot(BOM) {\n        return new PieceTreeSnapshot(this, BOM);\n    }\n    equal(other) {\n        if (this.getLength() !== other.getLength()) {\n            return false;\n        }\n        if (this.getLineCount() !== other.getLineCount()) {\n            return false;\n        }\n        let offset = 0;\n        let ret = this.iterate(this.root, node => {\n            if (node === rbTreeBase_1.SENTINEL) {\n                return true;\n            }\n            let str = this.getNodeContent(node);\n            let len = str.length;\n            let startPosition = other.nodeAt(offset);\n            let endPosition = other.nodeAt(offset + len);\n            let val = other.getValueInRange2(startPosition, endPosition);\n            return str === val;\n        });\n        return ret;\n    }\n    getOffsetAt(lineNumber, column) {\n        let leftLen = 0; // inorder\n        let x = this.root;\n        while (x !== rbTreeBase_1.SENTINEL) {\n            if (x.left !== rbTreeBase_1.SENTINEL && x.lf_left + 1 >= lineNumber) {\n                x = x.left;\n            }\n            else if (x.lf_left + x.piece.lineFeedCnt + 1 >= lineNumber) {\n                leftLen += x.size_left;\n                // lineNumber >= 2\n                let accumualtedValInCurrentIndex = this.getAccumulatedValue(x, lineNumber - x.lf_left - 2);\n                return leftLen += accumualtedValInCurrentIndex + column - 1;\n            }\n            else {\n                lineNumber -= x.lf_left + x.piece.lineFeedCnt;\n                leftLen += x.size_left + x.piece.length;\n                x = x.right;\n            }\n        }\n        return leftLen;\n    }\n    getPositionAt(offset) {\n        offset = Math.floor(offset);\n        offset = Math.max(0, offset);\n        let x = this.root;\n        let lfCnt = 0;\n        let originalOffset = offset;\n        while (x !== rbTreeBase_1.SENTINEL) {\n            if (x.size_left !== 0 && x.size_left >= offset) {\n                x = x.left;\n            }\n            else if (x.size_left + x.piece.length >= offset) {\n                let out = this.getIndexOf(x, offset - x.size_left);\n                lfCnt += x.lf_left + out.index;\n                if (out.index === 0) {\n                    let lineStartOffset = this.getOffsetAt(lfCnt + 1, 1);\n                    let column = originalOffset - lineStartOffset;\n                    return new position_1.Position(lfCnt + 1, column + 1);\n                }\n                return new position_1.Position(lfCnt + 1, out.remainder + 1);\n            }\n            else {\n                offset -= x.size_left + x.piece.length;\n                lfCnt += x.lf_left + x.piece.lineFeedCnt;\n                if (x.right === rbTreeBase_1.SENTINEL) {\n                    // last node\n                    let lineStartOffset = this.getOffsetAt(lfCnt + 1, 1);\n                    let column = originalOffset - offset - lineStartOffset;\n                    return new position_1.Position(lfCnt + 1, column + 1);\n                }\n                else {\n                    x = x.right;\n                }\n            }\n        }\n        return new position_1.Position(1, 1);\n    }\n    getValueInRange(range, eol) {\n        if (range.startLineNumber === range.endLineNumber && range.startColumn === range.endColumn) {\n            return '';\n        }\n        let startPosition = this.nodeAt2(range.startLineNumber, range.startColumn);\n        let endPosition = this.nodeAt2(range.endLineNumber, range.endColumn);\n        let value = this.getValueInRange2(startPosition, endPosition);\n        if (eol) {\n            if (eol !== this._EOL || !this._EOLNormalized) {\n                return value.replace(/\\r\\n|\\r|\\n/g, eol);\n            }\n            if (eol === this.getEOL() && this._EOLNormalized) {\n                if (eol === '\\r\\n') {\n                }\n                return value;\n            }\n            return value.replace(/\\r\\n|\\r|\\n/g, eol);\n        }\n        return value;\n    }\n    getValueInRange2(startPosition, endPosition) {\n        if (startPosition.node === endPosition.node) {\n            let node = startPosition.node;\n            let buffer = this._buffers[node.piece.bufferIndex].buffer;\n            let startOffset = this.offsetInBuffer(node.piece.bufferIndex, node.piece.start);\n            return buffer.substring(startOffset + startPosition.remainder, startOffset + endPosition.remainder);\n        }\n        let x = startPosition.node;\n        let buffer = this._buffers[x.piece.bufferIndex].buffer;\n        let startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\n        let ret = buffer.substring(startOffset + startPosition.remainder, startOffset + x.piece.length);\n        x = x.next();\n        while (x !== rbTreeBase_1.SENTINEL) {\n            let buffer = this._buffers[x.piece.bufferIndex].buffer;\n            let startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\n            if (x === endPosition.node) {\n                ret += buffer.substring(startOffset, startOffset + endPosition.remainder);\n                break;\n            }\n            else {\n                ret += buffer.substr(startOffset, x.piece.length);\n            }\n            x = x.next();\n        }\n        return ret;\n    }\n    getLinesContent() {\n        return this.getContentOfSubTree(this.root).split(/\\r\\n|\\r|\\n/);\n    }\n    getLength() {\n        return this._length;\n    }\n    getLineCount() {\n        return this._lineCnt;\n    }\n    /**\n     * @param lineNumber 1 based\n     */\n    getLineContent(lineNumber) {\n        if (this._lastVisitedLine.lineNumber === lineNumber) {\n            return this._lastVisitedLine.value;\n        }\n        this._lastVisitedLine.lineNumber = lineNumber;\n        if (lineNumber === this._lineCnt) {\n            this._lastVisitedLine.value = this.getLineRawContent(lineNumber);\n        }\n        else if (this._EOLNormalized) {\n            this._lastVisitedLine.value = this.getLineRawContent(lineNumber, this._EOLLength);\n        }\n        else {\n            this._lastVisitedLine.value = this.getLineRawContent(lineNumber).replace(/(\\r\\n|\\r|\\n)$/, '');\n        }\n        return this._lastVisitedLine.value;\n    }\n    getLineCharCode(lineNumber, index) {\n        let nodePos = this.nodeAt2(lineNumber, index + 1);\n        if (nodePos.remainder === nodePos.node.piece.length) {\n            // the char we want to fetch is at the head of next node.\n            let matchingNode = nodePos.node.next();\n            if (!matchingNode) {\n                return 0;\n            }\n            let buffer = this._buffers[matchingNode.piece.bufferIndex];\n            let startOffset = this.offsetInBuffer(matchingNode.piece.bufferIndex, matchingNode.piece.start);\n            return buffer.buffer.charCodeAt(startOffset);\n        }\n        else {\n            let buffer = this._buffers[nodePos.node.piece.bufferIndex];\n            let startOffset = this.offsetInBuffer(nodePos.node.piece.bufferIndex, nodePos.node.piece.start);\n            let targetOffset = startOffset + nodePos.remainder;\n            return buffer.buffer.charCodeAt(targetOffset);\n        }\n    }\n    getLineLength(lineNumber) {\n        if (lineNumber === this.getLineCount()) {\n            let startOffset = this.getOffsetAt(lineNumber, 1);\n            return this.getLength() - startOffset;\n        }\n        return this.getOffsetAt(lineNumber + 1, 1) - this.getOffsetAt(lineNumber, 1) - this._EOLLength;\n    }\n    // #endregion\n    // #region Piece Table\n    insert(offset, value, eolNormalized = false) {\n        this._EOLNormalized = this._EOLNormalized && eolNormalized;\n        this._lastVisitedLine.lineNumber = 0;\n        this._lastVisitedLine.value = '';\n        if (this.root !== rbTreeBase_1.SENTINEL) {\n            let { node, remainder, nodeStartOffset } = this.nodeAt(offset);\n            let piece = node.piece;\n            let bufferIndex = piece.bufferIndex;\n            let insertPosInBuffer = this.positionInBuffer(node, remainder);\n            if (node.piece.bufferIndex === 0 &&\n                piece.end.line === this._lastChangeBufferPos.line &&\n                piece.end.column === this._lastChangeBufferPos.column &&\n                (nodeStartOffset + piece.length === offset) &&\n                value.length < exports.AverageBufferSize) {\n                // changed buffer\n                this.appendToNode(node, value);\n                this.computeBufferMetadata();\n                return;\n            }\n            if (nodeStartOffset === offset) {\n                this.insertContentToNodeLeft(value, node);\n                this._searchCache.valdiate(offset);\n            }\n            else if (nodeStartOffset + node.piece.length > offset) {\n                // we are inserting into the middle of a node.\n                let nodesToDel = [];\n                let newRightPiece = new Piece(piece.bufferIndex, insertPosInBuffer, piece.end, this.getLineFeedCnt(piece.bufferIndex, insertPosInBuffer, piece.end), this.offsetInBuffer(bufferIndex, piece.end) - this.offsetInBuffer(bufferIndex, insertPosInBuffer));\n                if (this.shouldCheckCRLF() && this.endWithCR(value)) {\n                    let headOfRight = this.nodeCharCodeAt(node, remainder);\n                    if (headOfRight === 10 /** \\n */) {\n                        let newStart = { line: newRightPiece.start.line + 1, column: 0 };\n                        newRightPiece = new Piece(newRightPiece.bufferIndex, newStart, newRightPiece.end, this.getLineFeedCnt(newRightPiece.bufferIndex, newStart, newRightPiece.end), newRightPiece.length - 1);\n                        value += '\\n';\n                    }\n                }\n                // reuse node for content before insertion point.\n                if (this.shouldCheckCRLF() && this.startWithLF(value)) {\n                    let tailOfLeft = this.nodeCharCodeAt(node, remainder - 1);\n                    if (tailOfLeft === 13 /** \\r */) {\n                        let previousPos = this.positionInBuffer(node, remainder - 1);\n                        this.deleteNodeTail(node, previousPos);\n                        value = '\\r' + value;\n                        if (node.piece.length === 0) {\n                            nodesToDel.push(node);\n                        }\n                    }\n                    else {\n                        this.deleteNodeTail(node, insertPosInBuffer);\n                    }\n                }\n                else {\n                    this.deleteNodeTail(node, insertPosInBuffer);\n                }\n                let newPieces = this.createNewPieces(value);\n                if (newRightPiece.length > 0) {\n                    this.rbInsertRight(node, newRightPiece);\n                }\n                let tmpNode = node;\n                for (let k = 0; k < newPieces.length; k++) {\n                    tmpNode = this.rbInsertRight(tmpNode, newPieces[k]);\n                }\n                this.deleteNodes(nodesToDel);\n            }\n            else {\n                this.insertContentToNodeRight(value, node);\n            }\n        }\n        else {\n            // insert new node\n            let pieces = this.createNewPieces(value);\n            let node = this.rbInsertLeft(null, pieces[0]);\n            for (let k = 1; k < pieces.length; k++) {\n                node = this.rbInsertRight(node, pieces[k]);\n            }\n        }\n        // todo, this is too brutal. Total line feed count should be updated the same way as lf_left.\n        this.computeBufferMetadata();\n    }\n    delete(offset, cnt) {\n        this._lastVisitedLine.lineNumber = 0;\n        this._lastVisitedLine.value = '';\n        if (cnt <= 0 || this.root === rbTreeBase_1.SENTINEL) {\n            return;\n        }\n        let startPosition = this.nodeAt(offset);\n        let endPosition = this.nodeAt(offset + cnt);\n        let startNode = startPosition.node;\n        let endNode = endPosition.node;\n        if (startNode === endNode) {\n            let startSplitPosInBuffer = this.positionInBuffer(startNode, startPosition.remainder);\n            let endSplitPosInBuffer = this.positionInBuffer(startNode, endPosition.remainder);\n            if (startPosition.nodeStartOffset === offset) {\n                if (cnt === startNode.piece.length) { // delete node\n                    let next = startNode.next();\n                    rbTreeBase_1.rbDelete(this, startNode);\n                    this.validateCRLFWithPrevNode(next);\n                    this.computeBufferMetadata();\n                    return;\n                }\n                this.deleteNodeHead(startNode, endSplitPosInBuffer);\n                this._searchCache.valdiate(offset);\n                this.validateCRLFWithPrevNode(startNode);\n                this.computeBufferMetadata();\n                return;\n            }\n            if (startPosition.nodeStartOffset + startNode.piece.length === offset + cnt) {\n                this.deleteNodeTail(startNode, startSplitPosInBuffer);\n                this.validateCRLFWithNextNode(startNode);\n                this.computeBufferMetadata();\n                return;\n            }\n            // delete content in the middle, this node will be splitted to nodes\n            this.shrinkNode(startNode, startSplitPosInBuffer, endSplitPosInBuffer);\n            this.computeBufferMetadata();\n            return;\n        }\n        let nodesToDel = [];\n        let startSplitPosInBuffer = this.positionInBuffer(startNode, startPosition.remainder);\n        this.deleteNodeTail(startNode, startSplitPosInBuffer);\n        this._searchCache.valdiate(offset);\n        if (startNode.piece.length === 0) {\n            nodesToDel.push(startNode);\n        }\n        // update last touched node\n        let endSplitPosInBuffer = this.positionInBuffer(endNode, endPosition.remainder);\n        this.deleteNodeHead(endNode, endSplitPosInBuffer);\n        if (endNode.piece.length === 0) {\n            nodesToDel.push(endNode);\n        }\n        // delete nodes in between\n        let secondNode = startNode.next();\n        for (let node = secondNode; node !== rbTreeBase_1.SENTINEL && node !== endNode; node = node.next()) {\n            nodesToDel.push(node);\n        }\n        let prev = startNode.piece.length === 0 ? startNode.prev() : startNode;\n        this.deleteNodes(nodesToDel);\n        this.validateCRLFWithNextNode(prev);\n        this.computeBufferMetadata();\n    }\n    insertContentToNodeLeft(value, node) {\n        // we are inserting content to the beginning of node\n        let nodesToDel = [];\n        if (this.shouldCheckCRLF() && this.endWithCR(value) && this.startWithLF(node)) {\n            // move `\\n` to new node.\n            let piece = node.piece;\n            let newStart = { line: piece.start.line + 1, column: 0 };\n            let nPiece = new Piece(piece.bufferIndex, newStart, piece.end, this.getLineFeedCnt(piece.bufferIndex, newStart, piece.end), piece.length - 1);\n            node.piece = nPiece;\n            value += '\\n';\n            rbTreeBase_1.updateTreeMetadata(this, node, -1, -1);\n            if (node.piece.length === 0) {\n                nodesToDel.push(node);\n            }\n        }\n        let newPieces = this.createNewPieces(value);\n        let newNode = this.rbInsertLeft(node, newPieces[newPieces.length - 1]);\n        for (let k = newPieces.length - 2; k >= 0; k--) {\n            newNode = this.rbInsertLeft(newNode, newPieces[k]);\n        }\n        this.validateCRLFWithPrevNode(newNode);\n        this.deleteNodes(nodesToDel);\n    }\n    insertContentToNodeRight(value, node) {\n        // we are inserting to the right of this node.\n        if (this.adjustCarriageReturnFromNext(value, node)) {\n            // move \\n to the new node.\n            value += '\\n';\n        }\n        let newPieces = this.createNewPieces(value);\n        let newNode = this.rbInsertRight(node, newPieces[0]);\n        let tmpNode = newNode;\n        for (let k = 1; k < newPieces.length; k++) {\n            tmpNode = this.rbInsertRight(tmpNode, newPieces[k]);\n        }\n        this.validateCRLFWithPrevNode(newNode);\n    }\n    positionInBuffer(node, remainder, ret) {\n        let piece = node.piece;\n        let bufferIndex = node.piece.bufferIndex;\n        let lineStarts = this._buffers[bufferIndex].lineStarts;\n        let startOffset = lineStarts[piece.start.line] + piece.start.column;\n        let offset = startOffset + remainder;\n        // binary search offset between startOffset and endOffset\n        let low = piece.start.line;\n        let high = piece.end.line;\n        let mid = 0;\n        let midStop = 0;\n        let midStart = 0;\n        while (low <= high) {\n            mid = low + ((high - low) / 2) | 0;\n            midStart = lineStarts[mid];\n            if (mid === high) {\n                break;\n            }\n            midStop = lineStarts[mid + 1];\n            if (offset < midStart) {\n                high = mid - 1;\n            }\n            else if (offset >= midStop) {\n                low = mid + 1;\n            }\n            else {\n                break;\n            }\n        }\n        if (ret) {\n            ret.line = mid;\n            ret.column = offset - midStart;\n            return null;\n        }\n        return {\n            line: mid,\n            column: offset - midStart\n        };\n    }\n    getLineFeedCnt(bufferIndex, start, end) {\n        // we don't need to worry about start: abc\\r|\\n, or abc|\\r, or abc|\\n, or abc|\\r\\n doesn't change the fact that, there is one line break after start.\n        // now let's take care of end: abc\\r|\\n, if end is in between \\r and \\n, we need to add line feed count by 1\n        if (end.column === 0) {\n            return end.line - start.line;\n        }\n        let lineStarts = this._buffers[bufferIndex].lineStarts;\n        if (end.line === lineStarts.length - 1) { // it means, there is no \\n after end, otherwise, there will be one more lineStart.\n            return end.line - start.line;\n        }\n        let nextLineStartOffset = lineStarts[end.line + 1];\n        let endOffset = lineStarts[end.line] + end.column;\n        if (nextLineStartOffset > endOffset + 1) { // there are more than 1 character after end, which means it can't be \\n\n            return end.line - start.line;\n        }\n        // endOffset + 1 === nextLineStartOffset\n        // character at endOffset is \\n, so we check the character before first\n        // if character at endOffset is \\r, end.column is 0 and we can't get here.\n        let previousCharOffset = endOffset - 1; // end.column > 0 so it's okay.\n        let buffer = this._buffers[bufferIndex].buffer;\n        if (buffer.charCodeAt(previousCharOffset) === 13) {\n            return end.line - start.line + 1;\n        }\n        else {\n            return end.line - start.line;\n        }\n    }\n    offsetInBuffer(bufferIndex, cursor) {\n        let lineStarts = this._buffers[bufferIndex].lineStarts;\n        return lineStarts[cursor.line] + cursor.column;\n    }\n    deleteNodes(nodes) {\n        for (let i = 0; i < nodes.length; i++) {\n            rbTreeBase_1.rbDelete(this, nodes[i]);\n        }\n    }\n    createNewPieces(text) {\n        if (text.length > exports.AverageBufferSize) {\n            // the content is large, operations like substring, charCode becomes slow\n            // so here we split it into smaller chunks, just like what we did for CR/LF normalization\n            let newPieces = [];\n            while (text.length > exports.AverageBufferSize) {\n                const lastChar = text.charCodeAt(exports.AverageBufferSize - 1);\n                let splitText;\n                if (lastChar === 13 /* CarriageReturn */ || (lastChar >= 0xD800 && lastChar <= 0xDBFF)) {\n                    // last character is \\r or a high surrogate => keep it back\n                    splitText = text.substring(0, exports.AverageBufferSize - 1);\n                    text = text.substring(exports.AverageBufferSize - 1);\n                }\n                else {\n                    splitText = text.substring(0, exports.AverageBufferSize);\n                    text = text.substring(exports.AverageBufferSize);\n                }\n                let lineStarts = createLineStartsFast(splitText);\n                newPieces.push(new Piece(this._buffers.length, /* buffer index */ { line: 0, column: 0 }, { line: lineStarts.length - 1, column: splitText.length - lineStarts[lineStarts.length - 1] }, lineStarts.length - 1, splitText.length));\n                this._buffers.push(new StringBuffer(splitText, lineStarts));\n            }\n            let lineStarts = createLineStartsFast(text);\n            newPieces.push(new Piece(this._buffers.length, /* buffer index */ { line: 0, column: 0 }, { line: lineStarts.length - 1, column: text.length - lineStarts[lineStarts.length - 1] }, lineStarts.length - 1, text.length));\n            this._buffers.push(new StringBuffer(text, lineStarts));\n            return newPieces;\n        }\n        let startOffset = this._buffers[0].buffer.length;\n        const lineStarts = createLineStartsFast(text, false);\n        let start = this._lastChangeBufferPos;\n        if (this._buffers[0].lineStarts[this._buffers[0].lineStarts.length - 1] === startOffset\n            && startOffset !== 0\n            && this.startWithLF(text)\n            && this.endWithCR(this._buffers[0].buffer) // todo, we can check this._lastChangeBufferPos's column as it's the last one\n        ) {\n            this._lastChangeBufferPos = { line: this._lastChangeBufferPos.line, column: this._lastChangeBufferPos.column + 1 };\n            start = this._lastChangeBufferPos;\n            for (let i = 0; i < lineStarts.length; i++) {\n                lineStarts[i] += startOffset + 1;\n            }\n            this._buffers[0].lineStarts = this._buffers[0].lineStarts.concat(lineStarts.slice(1));\n            this._buffers[0].buffer += '_' + text;\n            startOffset += 1;\n        }\n        else {\n            if (startOffset !== 0) {\n                for (let i = 0; i < lineStarts.length; i++) {\n                    lineStarts[i] += startOffset;\n                }\n            }\n            this._buffers[0].lineStarts = this._buffers[0].lineStarts.concat(lineStarts.slice(1));\n            this._buffers[0].buffer += text;\n        }\n        const endOffset = this._buffers[0].buffer.length;\n        let endIndex = this._buffers[0].lineStarts.length - 1;\n        let endColumn = endOffset - this._buffers[0].lineStarts[endIndex];\n        let endPos = { line: endIndex, column: endColumn };\n        let newPiece = new Piece(0, /** todo@peng */ start, endPos, this.getLineFeedCnt(0, start, endPos), endOffset - startOffset);\n        this._lastChangeBufferPos = endPos;\n        return [newPiece];\n    }\n    getLinesRawContent() {\n        return this.getContentOfSubTree(this.root);\n    }\n    getLineRawContent(lineNumber, endOffset = 0) {\n        let x = this.root;\n        let ret = '';\n        let cache = this._searchCache.get2(lineNumber);\n        if (cache) {\n            x = cache.node;\n            let prevAccumualtedValue = this.getAccumulatedValue(x, lineNumber - cache.nodeStartLineNumber - 1);\n            let buffer = this._buffers[x.piece.bufferIndex].buffer;\n            let startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\n            if (cache.nodeStartLineNumber + x.piece.lineFeedCnt === lineNumber) {\n                ret = buffer.substring(startOffset + prevAccumualtedValue, startOffset + x.piece.length);\n            }\n            else {\n                let accumualtedValue = this.getAccumulatedValue(x, lineNumber - cache.nodeStartLineNumber);\n                return buffer.substring(startOffset + prevAccumualtedValue, startOffset + accumualtedValue - endOffset);\n            }\n        }\n        else {\n            let nodeStartOffset = 0;\n            const originalLineNumber = lineNumber;\n            while (x !== rbTreeBase_1.SENTINEL) {\n                if (x.left !== rbTreeBase_1.SENTINEL && x.lf_left >= lineNumber - 1) {\n                    x = x.left;\n                }\n                else if (x.lf_left + x.piece.lineFeedCnt > lineNumber - 1) {\n                    let prevAccumualtedValue = this.getAccumulatedValue(x, lineNumber - x.lf_left - 2);\n                    let accumualtedValue = this.getAccumulatedValue(x, lineNumber - x.lf_left - 1);\n                    let buffer = this._buffers[x.piece.bufferIndex].buffer;\n                    let startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\n                    nodeStartOffset += x.size_left;\n                    this._searchCache.set({\n                        node: x,\n                        nodeStartOffset,\n                        nodeStartLineNumber: originalLineNumber - (lineNumber - 1 - x.lf_left)\n                    });\n                    return buffer.substring(startOffset + prevAccumualtedValue, startOffset + accumualtedValue - endOffset);\n                }\n                else if (x.lf_left + x.piece.lineFeedCnt === lineNumber - 1) {\n                    let prevAccumualtedValue = this.getAccumulatedValue(x, lineNumber - x.lf_left - 2);\n                    let buffer = this._buffers[x.piece.bufferIndex].buffer;\n                    let startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\n                    ret = buffer.substring(startOffset + prevAccumualtedValue, startOffset + x.piece.length);\n                    break;\n                }\n                else {\n                    lineNumber -= x.lf_left + x.piece.lineFeedCnt;\n                    nodeStartOffset += x.size_left + x.piece.length;\n                    x = x.right;\n                }\n            }\n        }\n        // search in order, to find the node contains end column\n        x = x.next();\n        while (x !== rbTreeBase_1.SENTINEL) {\n            let buffer = this._buffers[x.piece.bufferIndex].buffer;\n            if (x.piece.lineFeedCnt > 0) {\n                let accumualtedValue = this.getAccumulatedValue(x, 0);\n                let startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\n                ret += buffer.substring(startOffset, startOffset + accumualtedValue - endOffset);\n                return ret;\n            }\n            else {\n                let startOffset = this.offsetInBuffer(x.piece.bufferIndex, x.piece.start);\n                ret += buffer.substr(startOffset, x.piece.length);\n            }\n            x = x.next();\n        }\n        return ret;\n    }\n    computeBufferMetadata() {\n        let x = this.root;\n        let lfCnt = 1;\n        let len = 0;\n        while (x !== rbTreeBase_1.SENTINEL) {\n            lfCnt += x.lf_left + x.piece.lineFeedCnt;\n            len += x.size_left + x.piece.length;\n            x = x.right;\n        }\n        this._lineCnt = lfCnt;\n        this._length = len;\n        this._searchCache.valdiate(this._length);\n    }\n    // #region node operations\n    getIndexOf(node, accumulatedValue) {\n        let piece = node.piece;\n        let pos = this.positionInBuffer(node, accumulatedValue);\n        let lineCnt = pos.line - piece.start.line;\n        if (this.offsetInBuffer(piece.bufferIndex, piece.end) - this.offsetInBuffer(piece.bufferIndex, piece.start) === accumulatedValue) {\n            // we are checking the end of this node, so a CRLF check is necessary.\n            let realLineCnt = this.getLineFeedCnt(node.piece.bufferIndex, piece.start, pos);\n            if (realLineCnt !== lineCnt) {\n                // aha yes, CRLF\n                return { index: realLineCnt, remainder: 0 };\n            }\n        }\n        return { index: lineCnt, remainder: pos.column };\n    }\n    getAccumulatedValue(node, index) {\n        if (index < 0) {\n            return 0;\n        }\n        let piece = node.piece;\n        let lineStarts = this._buffers[piece.bufferIndex].lineStarts;\n        let expectedLineStartIndex = piece.start.line + index + 1;\n        if (expectedLineStartIndex > piece.end.line) {\n            return lineStarts[piece.end.line] + piece.end.column - lineStarts[piece.start.line] - piece.start.column;\n        }\n        else {\n            return lineStarts[expectedLineStartIndex] - lineStarts[piece.start.line] - piece.start.column;\n        }\n    }\n    deleteNodeTail(node, pos) {\n        const piece = node.piece;\n        const originalLFCnt = piece.lineFeedCnt;\n        const originalEndOffset = this.offsetInBuffer(piece.bufferIndex, piece.end);\n        const newEnd = pos;\n        const newEndOffset = this.offsetInBuffer(piece.bufferIndex, newEnd);\n        const newLineFeedCnt = this.getLineFeedCnt(piece.bufferIndex, piece.start, newEnd);\n        const lf_delta = newLineFeedCnt - originalLFCnt;\n        const size_delta = newEndOffset - originalEndOffset;\n        const newLength = piece.length + size_delta;\n        node.piece = new Piece(piece.bufferIndex, piece.start, newEnd, newLineFeedCnt, newLength);\n        rbTreeBase_1.updateTreeMetadata(this, node, size_delta, lf_delta);\n    }\n    deleteNodeHead(node, pos) {\n        const piece = node.piece;\n        const originalLFCnt = piece.lineFeedCnt;\n        const originalStartOffset = this.offsetInBuffer(piece.bufferIndex, piece.start);\n        const newStart = pos;\n        const newLineFeedCnt = this.getLineFeedCnt(piece.bufferIndex, newStart, piece.end);\n        const newStartOffset = this.offsetInBuffer(piece.bufferIndex, newStart);\n        const lf_delta = newLineFeedCnt - originalLFCnt;\n        const size_delta = originalStartOffset - newStartOffset;\n        const newLength = piece.length + size_delta;\n        node.piece = new Piece(piece.bufferIndex, newStart, piece.end, newLineFeedCnt, newLength);\n        rbTreeBase_1.updateTreeMetadata(this, node, size_delta, lf_delta);\n    }\n    shrinkNode(node, start, end) {\n        const piece = node.piece;\n        const originalStartPos = piece.start;\n        const originalEndPos = piece.end;\n        // old piece, originalStartPos, start\n        const oldLength = piece.length;\n        const oldLFCnt = piece.lineFeedCnt;\n        const newEnd = start;\n        const newLineFeedCnt = this.getLineFeedCnt(piece.bufferIndex, piece.start, newEnd);\n        const newLength = this.offsetInBuffer(piece.bufferIndex, start) - this.offsetInBuffer(piece.bufferIndex, originalStartPos);\n        node.piece = new Piece(piece.bufferIndex, piece.start, newEnd, newLineFeedCnt, newLength);\n        rbTreeBase_1.updateTreeMetadata(this, node, newLength - oldLength, newLineFeedCnt - oldLFCnt);\n        // new right piece, end, originalEndPos\n        let newPiece = new Piece(piece.bufferIndex, end, originalEndPos, this.getLineFeedCnt(piece.bufferIndex, end, originalEndPos), this.offsetInBuffer(piece.bufferIndex, originalEndPos) - this.offsetInBuffer(piece.bufferIndex, end));\n        let newNode = this.rbInsertRight(node, newPiece);\n        this.validateCRLFWithPrevNode(newNode);\n    }\n    appendToNode(node, value) {\n        if (this.adjustCarriageReturnFromNext(value, node)) {\n            value += '\\n';\n        }\n        const hitCRLF = this.shouldCheckCRLF() && this.startWithLF(value) && this.endWithCR(node);\n        const startOffset = this._buffers[0].buffer.length;\n        this._buffers[0].buffer += value;\n        const lineStarts = createLineStartsFast(value, false);\n        for (let i = 0; i < lineStarts.length; i++) {\n            lineStarts[i] += startOffset;\n        }\n        if (hitCRLF) {\n            let prevStartOffset = this._buffers[0].lineStarts[this._buffers[0].lineStarts.length - 2];\n            this._buffers[0].lineStarts.pop();\n            // _lastChangeBufferPos is already wrong\n            this._lastChangeBufferPos = { line: this._lastChangeBufferPos.line - 1, column: startOffset - prevStartOffset };\n        }\n        this._buffers[0].lineStarts = this._buffers[0].lineStarts.concat(lineStarts.slice(1));\n        const endIndex = this._buffers[0].lineStarts.length - 1;\n        const endColumn = this._buffers[0].buffer.length - this._buffers[0].lineStarts[endIndex];\n        const newEnd = { line: endIndex, column: endColumn };\n        const newLength = node.piece.length + value.length;\n        const oldLineFeedCnt = node.piece.lineFeedCnt;\n        const newLineFeedCnt = this.getLineFeedCnt(0, node.piece.start, newEnd);\n        const lf_delta = newLineFeedCnt - oldLineFeedCnt;\n        node.piece = new Piece(node.piece.bufferIndex, node.piece.start, newEnd, newLineFeedCnt, newLength);\n        this._lastChangeBufferPos = newEnd;\n        rbTreeBase_1.updateTreeMetadata(this, node, value.length, lf_delta);\n    }\n    nodeAt(offset) {\n        let x = this.root;\n        let cache = this._searchCache.get(offset);\n        if (cache) {\n            return {\n                node: cache.node,\n                nodeStartOffset: cache.nodeStartOffset,\n                remainder: offset - cache.nodeStartOffset\n            };\n        }\n        let nodeStartOffset = 0;\n        while (x !== rbTreeBase_1.SENTINEL) {\n            if (x.size_left > offset) {\n                x = x.left;\n            }\n            else if (x.size_left + x.piece.length >= offset) {\n                nodeStartOffset += x.size_left;\n                let ret = {\n                    node: x,\n                    remainder: offset - x.size_left,\n                    nodeStartOffset\n                };\n                this._searchCache.set(ret);\n                return ret;\n            }\n            else {\n                offset -= x.size_left + x.piece.length;\n                nodeStartOffset += x.size_left + x.piece.length;\n                x = x.right;\n            }\n        }\n        return null;\n    }\n    nodeAt2(lineNumber, column) {\n        let x = this.root;\n        let nodeStartOffset = 0;\n        while (x !== rbTreeBase_1.SENTINEL) {\n            if (x.left !== rbTreeBase_1.SENTINEL && x.lf_left >= lineNumber - 1) {\n                x = x.left;\n            }\n            else if (x.lf_left + x.piece.lineFeedCnt > lineNumber - 1) {\n                let prevAccumualtedValue = this.getAccumulatedValue(x, lineNumber - x.lf_left - 2);\n                let accumualtedValue = this.getAccumulatedValue(x, lineNumber - x.lf_left - 1);\n                nodeStartOffset += x.size_left;\n                return {\n                    node: x,\n                    remainder: Math.min(prevAccumualtedValue + column - 1, accumualtedValue),\n                    nodeStartOffset\n                };\n            }\n            else if (x.lf_left + x.piece.lineFeedCnt === lineNumber - 1) {\n                let prevAccumualtedValue = this.getAccumulatedValue(x, lineNumber - x.lf_left - 2);\n                if (prevAccumualtedValue + column - 1 <= x.piece.length) {\n                    return {\n                        node: x,\n                        remainder: prevAccumualtedValue + column - 1,\n                        nodeStartOffset\n                    };\n                }\n                else {\n                    column -= x.piece.length - prevAccumualtedValue;\n                    break;\n                }\n            }\n            else {\n                lineNumber -= x.lf_left + x.piece.lineFeedCnt;\n                nodeStartOffset += x.size_left + x.piece.length;\n                x = x.right;\n            }\n        }\n        // search in order, to find the node contains position.column\n        x = x.next();\n        while (x !== rbTreeBase_1.SENTINEL) {\n            if (x.piece.lineFeedCnt > 0) {\n                let accumualtedValue = this.getAccumulatedValue(x, 0);\n                let nodeStartOffset = this.offsetOfNode(x);\n                return {\n                    node: x,\n                    remainder: Math.min(column - 1, accumualtedValue),\n                    nodeStartOffset\n                };\n            }\n            else {\n                if (x.piece.length >= column - 1) {\n                    let nodeStartOffset = this.offsetOfNode(x);\n                    return {\n                        node: x,\n                        remainder: column - 1,\n                        nodeStartOffset\n                    };\n                }\n                else {\n                    column -= x.piece.length;\n                }\n            }\n            x = x.next();\n        }\n        return null;\n    }\n    nodeCharCodeAt(node, offset) {\n        if (node.piece.lineFeedCnt < 1) {\n            return -1;\n        }\n        let buffer = this._buffers[node.piece.bufferIndex];\n        let newOffset = this.offsetInBuffer(node.piece.bufferIndex, node.piece.start) + offset;\n        return buffer.buffer.charCodeAt(newOffset);\n    }\n    offsetOfNode(node) {\n        if (!node) {\n            return 0;\n        }\n        let pos = node.size_left;\n        while (node !== this.root) {\n            if (node.parent.right === node) {\n                pos += node.parent.size_left + node.parent.piece.length;\n            }\n            node = node.parent;\n        }\n        return pos;\n    }\n    // #endregion\n    // #region CRLF\n    shouldCheckCRLF() {\n        return !(this._EOLNormalized && this._EOL === '\\n');\n    }\n    startWithLF(val) {\n        if (typeof val === 'string') {\n            return val.charCodeAt(0) === 10;\n        }\n        if (val === rbTreeBase_1.SENTINEL || val.piece.lineFeedCnt === 0) {\n            return false;\n        }\n        let piece = val.piece;\n        let lineStarts = this._buffers[piece.bufferIndex].lineStarts;\n        let line = piece.start.line;\n        let startOffset = lineStarts[line] + piece.start.column;\n        if (line === lineStarts.length - 1) {\n            // last line, so there is no line feed at the end of this line\n            return false;\n        }\n        let nextLineOffset = lineStarts[line + 1];\n        if (nextLineOffset > startOffset + 1) {\n            return false;\n        }\n        return this._buffers[piece.bufferIndex].buffer.charCodeAt(startOffset) === 10;\n    }\n    endWithCR(val) {\n        if (typeof val === 'string') {\n            return val.charCodeAt(val.length - 1) === 13;\n        }\n        if (val === rbTreeBase_1.SENTINEL || val.piece.lineFeedCnt === 0) {\n            return false;\n        }\n        return this.nodeCharCodeAt(val, val.piece.length - 1) === 13;\n    }\n    validateCRLFWithPrevNode(nextNode) {\n        if (this.shouldCheckCRLF() && this.startWithLF(nextNode)) {\n            let node = nextNode.prev();\n            if (this.endWithCR(node)) {\n                this.fixCRLF(node, nextNode);\n            }\n        }\n    }\n    validateCRLFWithNextNode(node) {\n        if (this.shouldCheckCRLF() && this.endWithCR(node)) {\n            let nextNode = node.next();\n            if (this.startWithLF(nextNode)) {\n                this.fixCRLF(node, nextNode);\n            }\n        }\n    }\n    fixCRLF(prev, next) {\n        let nodesToDel = [];\n        // update node\n        let lineStarts = this._buffers[prev.piece.bufferIndex].lineStarts;\n        let newEnd;\n        if (prev.piece.end.column === 0) {\n            // it means, last line ends with \\r, not \\r\\n\n            newEnd = { line: prev.piece.end.line - 1, column: lineStarts[prev.piece.end.line] - lineStarts[prev.piece.end.line - 1] - 1 };\n        }\n        else {\n            // \\r\\n\n            newEnd = { line: prev.piece.end.line, column: prev.piece.end.column - 1 };\n        }\n        const prevNewLength = prev.piece.length - 1;\n        const prevNewLFCnt = prev.piece.lineFeedCnt - 1;\n        prev.piece = new Piece(prev.piece.bufferIndex, prev.piece.start, newEnd, prevNewLFCnt, prevNewLength);\n        rbTreeBase_1.updateTreeMetadata(this, prev, -1, -1);\n        if (prev.piece.length === 0) {\n            nodesToDel.push(prev);\n        }\n        // update nextNode\n        let newStart = { line: next.piece.start.line + 1, column: 0 };\n        const newLength = next.piece.length - 1;\n        const newLineFeedCnt = this.getLineFeedCnt(next.piece.bufferIndex, newStart, next.piece.end);\n        next.piece = new Piece(next.piece.bufferIndex, newStart, next.piece.end, newLineFeedCnt, newLength);\n        rbTreeBase_1.updateTreeMetadata(this, next, -1, -1);\n        if (next.piece.length === 0) {\n            nodesToDel.push(next);\n        }\n        // create new piece which contains \\r\\n\n        let pieces = this.createNewPieces('\\r\\n');\n        this.rbInsertRight(prev, pieces[0]);\n        // delete empty nodes\n        for (let i = 0; i < nodesToDel.length; i++) {\n            rbTreeBase_1.rbDelete(this, nodesToDel[i]);\n        }\n    }\n    adjustCarriageReturnFromNext(value, node) {\n        if (this.shouldCheckCRLF() && this.endWithCR(value)) {\n            let nextNode = node.next();\n            if (this.startWithLF(nextNode)) {\n                // move `\\n` forward\n                value += '\\n';\n                if (nextNode.piece.length === 1) {\n                    rbTreeBase_1.rbDelete(this, nextNode);\n                }\n                else {\n                    const piece = nextNode.piece;\n                    const newStart = { line: piece.start.line + 1, column: 0 };\n                    const newLength = piece.length - 1;\n                    const newLineFeedCnt = this.getLineFeedCnt(piece.bufferIndex, newStart, piece.end);\n                    nextNode.piece = new Piece(piece.bufferIndex, newStart, piece.end, newLineFeedCnt, newLength);\n                    rbTreeBase_1.updateTreeMetadata(this, nextNode, -1, -1);\n                }\n                return true;\n            }\n        }\n        return false;\n    }\n    // #endregion\n    // #endregion\n    // #region Tree operations\n    iterate(node, callback) {\n        if (node === rbTreeBase_1.SENTINEL) {\n            return callback(rbTreeBase_1.SENTINEL);\n        }\n        let leftRet = this.iterate(node.left, callback);\n        if (!leftRet) {\n            return leftRet;\n        }\n        return callback(node) && this.iterate(node.right, callback);\n    }\n    getNodeContent(node) {\n        if (node === rbTreeBase_1.SENTINEL) {\n            return '';\n        }\n        let buffer = this._buffers[node.piece.bufferIndex];\n        let currentContent;\n        let piece = node.piece;\n        let startOffset = this.offsetInBuffer(piece.bufferIndex, piece.start);\n        let endOffset = this.offsetInBuffer(piece.bufferIndex, piece.end);\n        currentContent = buffer.buffer.substring(startOffset, endOffset);\n        return currentContent;\n    }\n    getPieceContent(piece) {\n        let buffer = this._buffers[piece.bufferIndex];\n        let startOffset = this.offsetInBuffer(piece.bufferIndex, piece.start);\n        let endOffset = this.offsetInBuffer(piece.bufferIndex, piece.end);\n        let currentContent = buffer.buffer.substring(startOffset, endOffset);\n        return currentContent;\n    }\n    /**\n     *      node              node\n     *     /  \\              /  \\\n     *    a   b    <----   a    b\n     *                         /\n     *                        z\n     */\n    rbInsertRight(node, p) {\n        let z = new rbTreeBase_1.TreeNode(p, 1 /* Red */);\n        z.left = rbTreeBase_1.SENTINEL;\n        z.right = rbTreeBase_1.SENTINEL;\n        z.parent = rbTreeBase_1.SENTINEL;\n        z.size_left = 0;\n        z.lf_left = 0;\n        let x = this.root;\n        if (x === rbTreeBase_1.SENTINEL) {\n            this.root = z;\n            z.color = 0 /* Black */;\n        }\n        else if (node.right === rbTreeBase_1.SENTINEL) {\n            node.right = z;\n            z.parent = node;\n        }\n        else {\n            let nextNode = rbTreeBase_1.leftest(node.right);\n            nextNode.left = z;\n            z.parent = nextNode;\n        }\n        rbTreeBase_1.fixInsert(this, z);\n        return z;\n    }\n    /**\n     *      node              node\n     *     /  \\              /  \\\n     *    a   b     ---->   a    b\n     *                       \\\n     *                        z\n     */\n    rbInsertLeft(node, p) {\n        let z = new rbTreeBase_1.TreeNode(p, 1 /* Red */);\n        z.left = rbTreeBase_1.SENTINEL;\n        z.right = rbTreeBase_1.SENTINEL;\n        z.parent = rbTreeBase_1.SENTINEL;\n        z.size_left = 0;\n        z.lf_left = 0;\n        if (this.root === rbTreeBase_1.SENTINEL) {\n            this.root = z;\n            z.color = 0 /* Black */;\n        }\n        else if (node.left === rbTreeBase_1.SENTINEL) {\n            node.left = z;\n            z.parent = node;\n        }\n        else {\n            let prevNode = rbTreeBase_1.righttest(node.left); // a\n            prevNode.right = z;\n            z.parent = prevNode;\n        }\n        rbTreeBase_1.fixInsert(this, z);\n        return z;\n    }\n    getContentOfSubTree(node) {\n        let str = '';\n        this.iterate(node, node => {\n            str += this.getNodeContent(node);\n            return true;\n        });\n        return str;\n    }\n}\nexports.PieceTreeBase = PieceTreeBase;\n","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * A position in the editor.\n */\nclass Position {\n    constructor(lineNumber, column) {\n        this.lineNumber = lineNumber;\n        this.column = column;\n    }\n    /**\n     * Create a new postion from this position.\n     *\n     * @param newLineNumber new line number\n     * @param newColumn new column\n     */\n    with(newLineNumber = this.lineNumber, newColumn = this.column) {\n        if (newLineNumber === this.lineNumber && newColumn === this.column) {\n            return this;\n        }\n        else {\n            return new Position(newLineNumber, newColumn);\n        }\n    }\n    /**\n     * Derive a new position from this position.\n     *\n     * @param deltaLineNumber line number delta\n     * @param deltaColumn column delta\n     */\n    delta(deltaLineNumber = 0, deltaColumn = 0) {\n        return this.with(this.lineNumber + deltaLineNumber, this.column + deltaColumn);\n    }\n    /**\n     * Test if this position equals other position\n     */\n    equals(other) {\n        return Position.equals(this, other);\n    }\n    /**\n     * Test if position `a` equals position `b`\n     */\n    static equals(a, b) {\n        if (!a && !b) {\n            return true;\n        }\n        return (!!a &&\n            !!b &&\n            a.lineNumber === b.lineNumber &&\n            a.column === b.column);\n    }\n    /**\n     * Test if this position is before other position.\n     * If the two positions are equal, the result will be false.\n     */\n    isBefore(other) {\n        return Position.isBefore(this, other);\n    }\n    /**\n     * Test if position `a` is before position `b`.\n     * If the two positions are equal, the result will be false.\n     */\n    static isBefore(a, b) {\n        if (a.lineNumber < b.lineNumber) {\n            return true;\n        }\n        if (b.lineNumber < a.lineNumber) {\n            return false;\n        }\n        return a.column < b.column;\n    }\n    /**\n     * Test if this position is before other position.\n     * If the two positions are equal, the result will be true.\n     */\n    isBeforeOrEqual(other) {\n        return Position.isBeforeOrEqual(this, other);\n    }\n    /**\n     * Test if position `a` is before position `b`.\n     * If the two positions are equal, the result will be true.\n     */\n    static isBeforeOrEqual(a, b) {\n        if (a.lineNumber < b.lineNumber) {\n            return true;\n        }\n        if (b.lineNumber < a.lineNumber) {\n            return false;\n        }\n        return a.column <= b.column;\n    }\n    /**\n     * A function that compares positions, useful for sorting\n     */\n    static compare(a, b) {\n        let aLineNumber = a.lineNumber | 0;\n        let bLineNumber = b.lineNumber | 0;\n        if (aLineNumber === bLineNumber) {\n            let aColumn = a.column | 0;\n            let bColumn = b.column | 0;\n            return aColumn - bColumn;\n        }\n        return aLineNumber - bLineNumber;\n    }\n    /**\n     * Clone this position.\n     */\n    clone() {\n        return new Position(this.lineNumber, this.column);\n    }\n    /**\n     * Convert to a human-readable representation.\n     */\n    toString() {\n        return '(' + this.lineNumber + ',' + this.column + ')';\n    }\n    // ---\n    /**\n     * Create a `Position` from an `IPosition`.\n     */\n    static lift(pos) {\n        return new Position(pos.lineNumber, pos.column);\n    }\n    /**\n     * Test if `obj` is an `IPosition`.\n     */\n    static isIPosition(obj) {\n        return (obj\n            && (typeof obj.lineNumber === 'number')\n            && (typeof obj.column === 'number'));\n    }\n}\nexports.Position = Position;\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\n\r\nimport {\r\n\tcreateConnection, IConnection,\r\n\tResponseError, RequestType, NotificationType, ErrorCodes,\r\n\tRequestHandler, NotificationHandler,\r\n\tDiagnostic, DiagnosticSeverity, Range, Files, CancellationToken,\r\n\tTextDocuments, TextDocument, TextDocumentSyncKind, TextEdit, TextDocumentIdentifier, TextDocumentSaveReason,\r\n\tCommand, WorkspaceChange,\r\n\tCodeActionRequest, VersionedTextDocumentIdentifier,\r\n\tExecuteCommandRequest, DidChangeWatchedFilesNotification, DidChangeConfigurationNotification,\r\n\tWorkspaceFolder, DidChangeWorkspaceFoldersNotification, CodeAction, CodeActionKind, Position\r\n} from 'vscode-languageserver';\r\n\r\nimport { URI } from 'vscode-uri';\r\nimport * as path from 'path';\r\nimport { execSync } from 'child_process';\r\nimport { EOL } from 'os';\r\nimport { isFunction } from 'util';\r\n\r\nnamespace Is {\r\n\tconst toString = Object.prototype.toString;\r\n\r\n\texport function boolean(value: any): value is boolean {\r\n\t\treturn value === true || value === false;\r\n\t}\r\n\r\n\texport function string(value: any): value is string {\r\n\t\treturn toString.call(value) === '[object String]';\r\n\t}\r\n}\r\n\r\nnamespace CommandIds {\r\n\texport const applySingleFix: string = 'eslint.applySingleFix';\r\n\texport const applySameFixes: string = 'eslint.applySameFixes';\r\n\texport const applyAllFixes: string = 'eslint.applyAllFixes';\r\n\texport const applyAutoFix: string = 'eslint.applyAutoFix';\r\n\texport const applyDisableLine: string = 'eslint.applyDisableLine';\r\n\texport const applyDisableFile: string = 'eslint.applyDisableFile';\r\n\texport const openRuleDoc: string = 'eslint.openRuleDoc';\r\n}\r\n\r\ninterface ESLintError extends Error {\r\n\tmessageTemplate?: string;\r\n\tmessageData?: {\r\n\t\tpluginName?: string;\r\n\t};\r\n}\r\n\r\nenum Status {\r\n\tok = 1,\r\n\twarn = 2,\r\n\terror = 3\r\n}\r\n\r\ninterface StatusParams {\r\n\tstate: Status;\r\n}\r\n\r\nnamespace StatusNotification {\r\n\texport const type = new NotificationType<StatusParams, void>('eslint/status');\r\n}\r\n\r\ninterface NoConfigParams {\r\n\tmessage: string;\r\n\tdocument: TextDocumentIdentifier;\r\n}\r\n\r\ninterface NoConfigResult {\r\n}\r\n\r\nnamespace NoConfigRequest {\r\n\texport const type = new RequestType<NoConfigParams, NoConfigResult, void, void>('eslint/noConfig');\r\n}\r\n\r\ninterface NoESLintLibraryParams {\r\n\tsource: TextDocumentIdentifier;\r\n}\r\n\r\ninterface NoESLintLibraryResult {\r\n}\r\n\r\nnamespace NoESLintLibraryRequest {\r\n\texport const type = new RequestType<NoESLintLibraryParams, NoESLintLibraryResult, void, void>('eslint/noLibrary');\r\n}\r\n\r\ninterface OpenESLintDocParams {\r\n\turl: string;\r\n}\r\n\r\ninterface OpenESLintDocResult {\r\n\r\n}\r\n\r\nnamespace OpenESLintDocRequest {\r\n\texport const type = new RequestType<OpenESLintDocParams, OpenESLintDocResult, void, void>('eslint/openDoc');\r\n}\r\n\r\ntype RunValues = 'onType' | 'onSave';\r\n\r\ninterface DirectoryItem {\r\n\tdirectory: string;\r\n\tchangeProcessCWD?: boolean;\r\n}\r\n\r\nnamespace DirectoryItem {\r\n\texport function is(item: any): item is DirectoryItem {\r\n\t\tlet candidate = item as DirectoryItem;\r\n\t\treturn candidate && Is.string(candidate.directory) && (Is.boolean(candidate.changeProcessCWD) || candidate.changeProcessCWD === undefined);\r\n\t}\r\n}\r\n\r\ninterface CodeActionSettings {\r\n\tdisableRuleComment: {\r\n\t\tenable: boolean;\r\n\t\tlocation: 'separateLine' | 'sameLine';\r\n\t};\r\n\tshowDocumentation: {\r\n\t\tenable: boolean;\r\n\t};\r\n}\r\n\r\ntype PackageManagers = 'npm' | 'yarn' | 'pnpm';\r\n\r\ntype ESLintOptions = object & { fixTypes?: string[] };\r\ninterface TextDocumentSettings {\r\n\tvalidate: boolean;\r\n\tpackageManager: PackageManagers;\r\n\tautoFix: boolean;\r\n\tautoFixOnSave: boolean;\r\n\tquiet: boolean;\r\n\toptions: ESLintOptions | undefined;\r\n\trun: RunValues;\r\n\tnodePath: string | undefined;\r\n\tworkspaceFolder: WorkspaceFolder | undefined;\r\n\tworkingDirectory: DirectoryItem | undefined;\r\n\tlibrary: ESLintModule | undefined;\r\n\tresolvedGlobalPackageManagerPath: string | undefined;\r\n\tcodeAction: CodeActionSettings;\r\n}\r\n\r\ninterface ESLintAutoFixEdit {\r\n\trange: [number, number];\r\n\ttext: string;\r\n}\r\n\r\ninterface ESLintProblem {\r\n\tline: number;\r\n\tcolumn: number;\r\n\tendLine?: number;\r\n\tendColumn?: number;\r\n\tseverity: number;\r\n\truleId: string;\r\n\tmessage: string;\r\n\tfix?: ESLintAutoFixEdit;\r\n}\r\n\r\ninterface ESLintDocumentReport {\r\n\tfilePath: string;\r\n\terrorCount: number;\r\n\twarningCount: number;\r\n\tmessages: ESLintProblem[];\r\n\toutput?: string;\r\n}\r\n\r\ninterface ESLintReport {\r\n\terrorCount: number;\r\n\twarningCount: number;\r\n\tresults: ESLintDocumentReport[];\r\n}\r\n\r\ninterface CLIOptions {\r\n\tcwd?: string;\r\n\tfixTypes?: string[];\r\n}\r\n\r\n// { meta: { docs: [Object], schema: [Array] }, create: [Function: create] }\r\ninterface RuleData {\r\n\tmeta?: {\r\n\t\tdocs?: {\r\n\t\t\turl?: string;\r\n\t\t};\r\n\t\ttype?: string;\r\n\t};\r\n}\r\n\r\ninterface CLIEngine {\r\n\texecuteOnText(content: string, file?:string): ESLintReport;\r\n\t// This is only available from v4.15.0 forward\r\n\tgetRules?(): Map<string, RuleData>;\r\n}\r\n\r\ninterface CLIEngineConstructor {\r\n\tnew (options: CLIOptions): CLIEngine;\r\n}\r\n\r\ninterface ESLintModule {\r\n\tCLIEngine: CLIEngineConstructor;\r\n}\r\n\r\ndeclare const __webpack_require__: typeof require;\r\ndeclare const __non_webpack_require__: typeof require;\r\nfunction loadNodeModule<T>(moduleName: string): T | undefined {\r\n\tconst r =  typeof __webpack_require__ === 'function' ? __non_webpack_require__ : require;\r\n\ttry {\r\n\t\treturn r(moduleName);\r\n\t} catch (err) {\r\n\t\tconnection.console.error(err.stack.toString());\r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\nfunction makeDiagnostic(problem: ESLintProblem): Diagnostic {\r\n\tlet message = problem.message;\r\n\tlet startLine = Math.max(0, problem.line - 1);\r\n\tlet startChar = Math.max(0, problem.column - 1);\r\n\tlet endLine = problem.endLine !== null ? Math.max(0, problem.endLine - 1) : startLine;\r\n\tlet endChar = problem.endColumn !== null ? Math.max(0, problem.endColumn - 1) : startChar;\r\n\treturn {\r\n\t\tmessage: message,\r\n\t\tseverity: convertSeverity(problem.severity),\r\n\t\tsource: 'eslint',\r\n\t\trange: {\r\n\t\t\tstart: { line: startLine, character: startChar },\r\n\t\t\tend: { line: endLine, character: endChar }\r\n\t\t},\r\n\t\tcode: problem.ruleId\r\n\t};\r\n}\r\n\r\ninterface FixableProblem {\r\n\tlabel: string;\r\n\tdocumentVersion: number;\r\n\truleId: string;\r\n\tline: number;\r\n\tedit?: ESLintAutoFixEdit;\r\n}\r\n\r\nfunction computeKey(diagnostic: Diagnostic): string {\r\n\tlet range = diagnostic.range;\r\n\treturn `[${range.start.line},${range.start.character},${range.end.line},${range.end.character}]-${diagnostic.code}`;\r\n}\r\n\r\nlet codeActions: Map<string, Map<string, FixableProblem>> = new Map<string, Map<string, FixableProblem>>();\r\nfunction recordCodeAction(document: TextDocument, diagnostic: Diagnostic, problem: ESLintProblem): void {\r\n\tif (!problem.ruleId) {\r\n\t\treturn;\r\n\t}\r\n\tlet uri = document.uri;\r\n\tlet edits: Map<string, FixableProblem> = codeActions.get(uri);\r\n\tif (!edits) {\r\n\t\tedits = new Map<string, FixableProblem>();\r\n\t\tcodeActions.set(uri, edits);\r\n\t}\r\n\tedits.set(computeKey(diagnostic), { label: `Fix this ${problem.ruleId} problem`, documentVersion: document.version, ruleId: problem.ruleId, edit: problem.fix, line: problem.line });\r\n}\r\n\r\nfunction convertSeverity(severity: number): DiagnosticSeverity {\r\n\tswitch (severity) {\r\n\t\t// Eslint 1 is warning\r\n\t\tcase 1:\r\n\t\t\treturn DiagnosticSeverity.Warning;\r\n\t\tcase 2:\r\n\t\t\treturn DiagnosticSeverity.Error;\r\n\t\tdefault:\r\n\t\t\treturn DiagnosticSeverity.Error;\r\n\t}\r\n}\r\n\r\nconst enum CharCode {\r\n\t/**\r\n\t * The `\\` character.\r\n\t */\r\n\tBackslash = 92,\r\n}\r\n\r\n/**\r\n * Check if the path follows this pattern: `\\\\hostname\\sharename`.\r\n *\r\n * @see https://msdn.microsoft.com/en-us/library/gg465305.aspx\r\n * @return A boolean indication if the path is a UNC path, on none-windows\r\n * always false.\r\n */\r\nfunction isUNC(path: string): boolean {\r\n\tif (process.platform !== 'win32') {\r\n\t\t// UNC is a windows concept\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif (!path || path.length < 5) {\r\n\t\t// at least \\\\a\\b\r\n\t\treturn false;\r\n\t}\r\n\r\n\tlet code = path.charCodeAt(0);\r\n\tif (code !== CharCode.Backslash) {\r\n\t\treturn false;\r\n\t}\r\n\tcode = path.charCodeAt(1);\r\n\tif (code !== CharCode.Backslash) {\r\n\t\treturn false;\r\n\t}\r\n\tlet pos = 2;\r\n\tlet start = pos;\r\n\tfor (; pos < path.length; pos++) {\r\n\t\tcode = path.charCodeAt(pos);\r\n\t\tif (code === CharCode.Backslash) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tif (start === pos) {\r\n\t\treturn false;\r\n\t}\r\n\tcode = path.charCodeAt(pos + 1);\r\n\tif (isNaN(code) || code === CharCode.Backslash) {\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction getFileSystemPath(uri: URI): string {\r\n\tlet result = uri.fsPath;\r\n\tif (process.platform === 'win32' && result.length >= 2 && result[1] === ':') {\r\n\t\t// Node by default uses an upper case drive letter and ESLint uses\r\n\t\t// === to compare paths which results in the equal check failing\r\n\t\t// if the drive letter is lower case in th URI. Ensure upper case.\r\n\t\treturn result[0].toUpperCase() + result.substr(1);\r\n\t} else {\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\n\r\nfunction getFilePath(documentOrUri: string | TextDocument): string {\r\n\tif (!documentOrUri) {\r\n\t\treturn undefined;\r\n\t}\r\n\tlet uri = Is.string(documentOrUri) ? URI.parse(documentOrUri) : URI.parse(documentOrUri.uri);\r\n\tif (uri.scheme !== 'file') {\r\n\t\treturn undefined;\r\n\t}\r\n\treturn getFileSystemPath(uri);\r\n}\r\n\r\nconst exitCalled = new NotificationType<[number, string], void>('eslint/exitCalled');\r\n\r\nconst nodeExit = process.exit;\r\nprocess.exit = ((code?: number): void => {\r\n\tlet stack = new Error('stack');\r\n\tconnection.sendNotification(exitCalled, [code ? code : 0, stack.stack]);\r\n\tsetTimeout(() => {\r\n\t\tnodeExit(code);\r\n\t}, 1000);\r\n}) as any;\r\nprocess.on('uncaughtException', (error: any) => {\r\n\tlet message: string;\r\n\tif (error) {\r\n\t\tif (typeof error.stack === 'string') {\r\n\t\t\tmessage = error.stack;\r\n\t\t} else if (typeof error.message === 'string') {\r\n\t\t\tmessage = error.message;\r\n\t\t} else if (typeof error === 'string') {\r\n\t\t\tmessage = error;\r\n\t\t}\r\n\t\tif (!message) {\r\n\t\t\ttry {\r\n\t\t\t\tmessage = JSON.stringify(error, undefined, 4);\r\n\t\t\t} catch (e) {\r\n\t\t\t\t// Should not happen.\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// eslint-disable-next-line no-console\r\n\tconsole.error('Uncaught exception received.');\r\n\tif (message) {\r\n\t\t// eslint-disable-next-line no-console\r\n\t\tconsole.error(message);\r\n\t}\r\n});\r\n\r\nlet connection = createConnection();\r\nconnection.console.info(`ESLint server running in node ${process.version}`);\r\n// Is instantiated in the initalize handle;\r\nlet documents!: TextDocuments;\r\n\r\nconst _globalPaths: { [key: string]: { cache: string; get(): string; } } = {\r\n\tyarn: {\r\n\t\tcache: undefined,\r\n\t\tget(): string {\r\n\t\t\treturn Files.resolveGlobalYarnPath(trace);\r\n\t\t}\r\n\t},\r\n\tnpm: {\r\n\t\tcache: undefined,\r\n\t\tget(): string {\r\n\t\t\treturn Files.resolveGlobalNodePath(trace);\r\n\t\t}\r\n\t},\r\n\tpnpm: {\r\n\t\tcache: undefined,\r\n\t\tget(): string {\r\n\t\t\tconst pnpmPath = execSync('pnpm root -g').toString().trim();\r\n\t\t\treturn pnpmPath;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nfunction globalPathGet(packageManager: PackageManagers): string {\r\n\tconst pm = _globalPaths[packageManager];\r\n\tif (pm) {\r\n\t\tif (pm.cache === undefined) {\r\n\t\t\tpm.cache = pm.get();\r\n\t\t}\r\n\t\treturn pm.cache;\r\n\t}\r\n\treturn undefined;\r\n}\r\nlet path2Library: Map<string, ESLintModule> = new Map<string, ESLintModule>();\r\nlet document2Settings: Map<string, Thenable<TextDocumentSettings>> = new Map<string, Thenable<TextDocumentSettings>>();\r\n\r\nfunction resolveSettings(document: TextDocument): Thenable<TextDocumentSettings> {\r\n\tlet uri = document.uri;\r\n\tlet resultPromise = document2Settings.get(uri);\r\n\tif (resultPromise) {\r\n\t\treturn resultPromise;\r\n\t}\r\n\tresultPromise = connection.workspace.getConfiguration({ scopeUri: uri, section: '' }).then((settings: TextDocumentSettings) => {\r\n\t\tsettings.resolvedGlobalPackageManagerPath = globalPathGet(settings.packageManager);\r\n\t\tlet uri = URI.parse(document.uri);\r\n\t\tlet promise: Thenable<string>;\r\n\t\tif (uri.scheme === 'file') {\r\n\t\t\tlet file = uri.fsPath;\r\n\t\t\tlet directory = path.dirname(file);\r\n\t\t\tif (settings.nodePath) {\r\n\t\t\t\tlet nodePath = settings.nodePath;\r\n\t\t\t\tif (!path.isAbsolute(nodePath) && settings.workspaceFolder !== undefined) {\r\n\t\t\t\t\tlet uri = URI.parse(settings.workspaceFolder.uri);\r\n\t\t\t\t\tif (uri.scheme === 'file') {\r\n\t\t\t\t\t\tnodePath = path.join(uri.fsPath, nodePath);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tpromise = Files.resolve('eslint', nodePath, nodePath, trace).then<string, string>(undefined, () => {\r\n\t\t\t\t\treturn Files.resolve('eslint', settings.resolvedGlobalPackageManagerPath, directory, trace);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tpromise = Files.resolve('eslint', settings.resolvedGlobalPackageManagerPath, directory, trace);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tpromise = Files.resolve('eslint', settings.resolvedGlobalPackageManagerPath, settings.workspaceFolder ? settings.workspaceFolder.uri : undefined, trace);\r\n\t\t}\r\n\t\treturn promise.then((path) => {\r\n\t\t\tlet library = path2Library.get(path);\r\n\t\t\tif (!library) {\r\n\t\t\t\tlibrary = loadNodeModule(path);\r\n\t\t\t\tif (!library) {\r\n\t\t\t\t\tsettings.validate = false;\r\n\t\t\t\t\tconnection.console.error(`Failed to load eslint library from ${path}. See output panel for more information.`);\r\n\t\t\t\t} else if (!library.CLIEngine) {\r\n\t\t\t\t\tsettings.validate = false;\r\n\t\t\t\t\tconnection.console.error(`The eslint library loaded from ${path} doesn\\'t export a CLIEngine. You need at least eslint@1.0.0`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconnection.console.info(`ESLint library loaded from: ${path}`);\r\n\t\t\t\t\tsettings.library = library;\r\n\t\t\t\t}\r\n\t\t\t\tpath2Library.set(path, library);\r\n\t\t\t} else {\r\n\t\t\t\tsettings.library = library;\r\n\t\t\t}\r\n\t\t\treturn settings;\r\n\t\t}, () => {\r\n\t\t\tsettings.validate = false;\r\n\t\t\tconnection.sendRequest(NoESLintLibraryRequest.type, { source: { uri: document.uri } });\r\n\t\t\treturn settings;\r\n\t\t});\r\n\t});\r\n\tdocument2Settings.set(uri, resultPromise);\r\n\treturn resultPromise;\r\n}\r\n\r\ninterface Request<P, R> {\r\n\tmethod: string;\r\n\tparams: P;\r\n\tdocumentVersion: number | undefined;\r\n\tresolve: (value: R | Thenable<R>) => void | undefined;\r\n\treject: (error: any) => void | undefined;\r\n\ttoken: CancellationToken | undefined;\r\n}\r\n\r\nnamespace Request {\r\n\texport function is(value: any): value is Request<any, any> {\r\n\t\tlet candidate: Request<any, any> = value;\r\n\t\treturn candidate && !!candidate.token && !!candidate.resolve && !!candidate.reject;\r\n\t}\r\n}\r\n\r\ninterface Notification<P> {\r\n\tmethod: string;\r\n\tparams: P;\r\n\tdocumentVersion: number;\r\n}\r\n\r\ntype Message<P, R> = Notification<P> | Request<P, R>;\r\n\r\ninterface VersionProvider<P> {\r\n\t(params: P): number;\r\n}\r\n\r\nnamespace Thenable {\r\n\texport function is<T>(value: any): value is Thenable<T> {\r\n\t\tlet candidate: Thenable<T> = value;\r\n\t\treturn candidate && typeof candidate.then === 'function';\r\n\t}\r\n}\r\n\r\nclass BufferedMessageQueue {\r\n\r\n\tprivate queue: Message<any, any>[];\r\n\tprivate requestHandlers: Map<string, {handler: RequestHandler<any, any, any>, versionProvider?: VersionProvider<any>}>;\r\n\tprivate notificationHandlers: Map<string, {handler: NotificationHandler<any>, versionProvider?: VersionProvider<any>}>;\r\n\tprivate timer: NodeJS.Immediate | undefined;\r\n\r\n\tconstructor(private connection: IConnection) {\r\n\t\tthis.queue = [];\r\n\t\tthis.requestHandlers = new Map();\r\n\t\tthis.notificationHandlers = new Map();\r\n\t}\r\n\r\n\tpublic registerRequest<P, R, E, RO>(type: RequestType<P, R, E, RO>, handler: RequestHandler<P, R, E>, versionProvider?: VersionProvider<P>): void {\r\n\t\tthis.connection.onRequest(type, (params, token) => {\r\n\t\t\treturn new Promise<R>((resolve, reject) => {\r\n\t\t\t\tthis.queue.push({\r\n\t\t\t\t\tmethod: type.method,\r\n\t\t\t\t\tparams: params,\r\n\t\t\t\t\tdocumentVersion: versionProvider ? versionProvider(params) : undefined,\r\n\t\t\t\t\tresolve: resolve,\r\n\t\t\t\t\treject: reject,\r\n\t\t\t\t\ttoken: token\r\n\t\t\t\t});\r\n\t\t\t\tthis.trigger();\r\n\t\t\t});\r\n\t\t});\r\n\t\tthis.requestHandlers.set(type.method, { handler, versionProvider });\r\n\t}\r\n\r\n\tpublic registerNotification<P, RO>(type: NotificationType<P, RO>, handler: NotificationHandler<P>, versionProvider?: (params: P) => number): void {\r\n\t\tconnection.onNotification(type, (params) => {\r\n\t\t\tthis.queue.push({\r\n\t\t\t\tmethod: type.method,\r\n\t\t\t\tparams: params,\r\n\t\t\t\tdocumentVersion: versionProvider ? versionProvider(params) : undefined,\r\n\t\t\t});\r\n\t\t\tthis.trigger();\r\n\t\t});\r\n\t\tthis.notificationHandlers.set(type.method, { handler, versionProvider });\r\n\t}\r\n\r\n\tpublic addNotificationMessage<P, RO>(type: NotificationType<P, RO>, params: P, version: number) {\r\n\t\tthis.queue.push({\r\n\t\t\tmethod: type.method,\r\n\t\t\tparams,\r\n\t\t\tdocumentVersion: version\r\n\t\t});\r\n\t\tthis.trigger();\r\n\t}\r\n\r\n\tpublic onNotification<P, RO>(type: NotificationType<P, RO>, handler: NotificationHandler<P>, versionProvider?: (params: P) => number): void {\r\n\t\tthis.notificationHandlers.set(type.method, { handler, versionProvider });\r\n\t}\r\n\r\n\tprivate trigger(): void {\r\n\t\tif (this.timer || this.queue.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.timer = setImmediate(() => {\r\n\t\t\tthis.timer = undefined;\r\n\t\t\tthis.processQueue();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate processQueue(): void {\r\n\t\tlet message = this.queue.shift();\r\n\t\tif (!message) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (Request.is(message)) {\r\n\t\t\tlet requestMessage = message;\r\n\t\t\tif (requestMessage.token.isCancellationRequested) {\r\n\t\t\t\trequestMessage.reject(new ResponseError(ErrorCodes.RequestCancelled, 'Request got cancelled'));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet elem = this.requestHandlers.get(requestMessage.method);\r\n\t\t\tif (elem.versionProvider && requestMessage.documentVersion !== undefined && requestMessage.documentVersion !== elem.versionProvider(requestMessage.params)) {\r\n\t\t\t\trequestMessage.reject(new ResponseError(ErrorCodes.RequestCancelled, 'Request got cancelled'));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet result = elem.handler(requestMessage.params, requestMessage.token);\r\n\t\t\tif (Thenable.is(result)) {\r\n\t\t\t\tresult.then((value) => {\r\n\t\t\t\t\trequestMessage.resolve(value);\r\n\t\t\t\t}, (error) => {\r\n\t\t\t\t\trequestMessage.reject(error);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\trequestMessage.resolve(result);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlet notificationMessage = message;\r\n\t\t\tlet elem = this.notificationHandlers.get(notificationMessage.method);\r\n\t\t\tif (elem.versionProvider && notificationMessage.documentVersion !== undefined && notificationMessage.documentVersion !== elem.versionProvider(notificationMessage.params)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\telem.handler(notificationMessage.params);\r\n\t\t}\r\n\t\tthis.trigger();\r\n\t}\r\n}\r\n\r\nlet messageQueue: BufferedMessageQueue = new BufferedMessageQueue(connection);\r\n\r\nnamespace ValidateNotification {\r\n\texport const type: NotificationType<TextDocument, void> = new NotificationType<TextDocument, void>('eslint/validate');\r\n}\r\n\r\nmessageQueue.onNotification(ValidateNotification.type, (document) => {\r\n\tvalidateSingle(document, true);\r\n}, (document): number => {\r\n\treturn document.version;\r\n});\r\n\r\nfunction getFixes(textDocument: TextDocument): TextEdit[] {\r\n\tlet uri = textDocument.uri;\r\n\tlet edits = codeActions.get(uri);\r\n\tfunction createTextEdit(editInfo: FixableProblem): TextEdit {\r\n\t\treturn TextEdit.replace(Range.create(textDocument.positionAt(editInfo.edit.range[0]), textDocument.positionAt(editInfo.edit.range[1])), editInfo.edit.text || '');\r\n\t}\r\n\tif (edits) {\r\n\t\tlet fixes = new Fixes(edits);\r\n\t\tif (fixes.isEmpty() || textDocument.version !== fixes.getDocumentVersion()) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\treturn fixes.getOverlapFree().filter(fix => !!fix.edit).map(createTextEdit);\r\n\t}\r\n\treturn [];\r\n}\r\n\r\nfunction setupDocumentsListeners() {\r\n\t// The documents manager listen for text document create, change\r\n\t// and close on the connection\r\n\tdocuments.listen(connection);\r\n\tdocuments.onDidOpen((event) => {\r\n\t\tresolveSettings(event.document).then((settings) => {\r\n\t\t\tif (!settings.validate) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (settings.run === 'onSave') {\r\n\t\t\t\tmessageQueue.addNotificationMessage(ValidateNotification.type, event.document, event.document.version);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t// A text document has changed. Validate the document according the run setting.\r\n\tdocuments.onDidChangeContent((event) => {\r\n\t\tresolveSettings(event.document).then((settings) => {\r\n\t\t\tif (!settings.validate || settings.run !== 'onType') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tmessageQueue.addNotificationMessage(ValidateNotification.type, event.document, event.document.version);\r\n\t\t});\r\n\t});\r\n\r\n\tdocuments.onWillSaveWaitUntil((event) => {\r\n\t\tif (event.reason === TextDocumentSaveReason.AfterDelay) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tlet document = event.document;\r\n\t\treturn resolveSettings(document).then((settings) => {\r\n\t\t\tif (!settings.autoFixOnSave) {\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\t\t\t// If we validate on save and want to apply fixes on will save\r\n\t\t\t// we need to validate the file.\r\n\t\t\tif (settings.run === 'onSave') {\r\n\t\t\t\t// Do not queue this since we want to get the fixes as fast as possible.\r\n\t\t\t\treturn validateSingle(document, false).then(() => getFixes(document));\r\n\t\t\t} else {\r\n\t\t\t\treturn getFixes(document);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t// A text document has been saved. Validate the document according the run setting.\r\n\tdocuments.onDidSave((event) => {\r\n\t\tresolveSettings(event.document).then((settings) => {\r\n\t\t\tif (!settings.validate || settings.run !== 'onSave') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tmessageQueue.addNotificationMessage(ValidateNotification.type, event.document, event.document.version);\r\n\t\t});\r\n\t});\r\n\r\n\tdocuments.onDidClose((event) => {\r\n\t\tresolveSettings(event.document).then((settings) => {\r\n\t\t\tlet uri = event.document.uri;\r\n\t\t\tdocument2Settings.delete(uri);\r\n\t\t\tcodeActions.delete(uri);\r\n\t\t\tif (settings.validate) {\r\n\t\t\t\tconnection.sendDiagnostics({ uri: uri, diagnostics: [] });\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\nfunction environmentChanged() {\r\n\tdocument2Settings.clear();\r\n\tfor (let document of documents.all()) {\r\n\t\tmessageQueue.addNotificationMessage(ValidateNotification.type, document, document.version);\r\n\t}\r\n}\r\n\r\nfunction trace(message: string, verbose?: string): void {\r\n\tconnection.tracer.log(message, verbose);\r\n}\r\n\r\nconnection.onInitialize((params, _cancel, progress) => {\r\n\tprogress.begin('Initializing ESLint Server');\r\n\tlet syncKind: TextDocumentSyncKind = (params.initializationOptions && !!params.initializationOptions.incrementalSync) ? TextDocumentSyncKind.Incremental : TextDocumentSyncKind.Full;\r\n\tdocuments = new TextDocuments(syncKind);\r\n\tsetupDocumentsListeners();\r\n\tprogress.done();\r\n\treturn {\r\n\t\tcapabilities: {\r\n\t\t\ttextDocumentSync: {\r\n\t\t\t\topenClose: true,\r\n\t\t\t\tchange: syncKind,\r\n\t\t\t\twillSaveWaitUntil: true,\r\n\t\t\t\tsave: {\r\n\t\t\t\t\tincludeText: false\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcodeActionProvider: true,\r\n\t\t\texecuteCommandProvider: {\r\n\t\t\t\tcommands: [\r\n\t\t\t\t\tCommandIds.applySingleFix,\r\n\t\t\t\t\tCommandIds.applySameFixes,\r\n\t\t\t\t\tCommandIds.applyAllFixes,\r\n\t\t\t\t\tCommandIds.applyAutoFix,\r\n\t\t\t\t\tCommandIds.applyDisableLine,\r\n\t\t\t\t\tCommandIds.applyDisableFile,\r\n\t\t\t\t\tCommandIds.openRuleDoc,\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n});\r\n\r\nconnection.onInitialized(() => {\r\n\tconnection.client.register(DidChangeConfigurationNotification.type, undefined);\r\n\tconnection.client.register(DidChangeWorkspaceFoldersNotification.type, undefined);\r\n});\r\n\r\nmessageQueue.registerNotification(DidChangeConfigurationNotification.type, (_params) => {\r\n\tenvironmentChanged();\r\n});\r\n\r\nmessageQueue.registerNotification(DidChangeWorkspaceFoldersNotification.type, (_params) => {\r\n\tenvironmentChanged();\r\n});\r\n\r\nconst singleErrorHandlers: ((error: any, document: TextDocument, library: ESLintModule) => Status)[] = [\r\n\ttryHandleNoConfig,\r\n\ttryHandleConfigError,\r\n\ttryHandleMissingModule,\r\n\tshowErrorMessage\r\n];\r\n\r\nfunction validateSingle(document: TextDocument, publishDiagnostics: boolean = true): Thenable<void> {\r\n\t// We validate document in a queue but open / close documents directly. So we need to deal with the\r\n\t// fact that a document might be gone from the server.\r\n\tif (!documents.get(document.uri)) {\r\n\t\treturn Promise.resolve(undefined);\r\n\t}\r\n\treturn resolveSettings(document).then((settings) => {\r\n\t\tif (!settings.validate) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tvalidate(document, settings, publishDiagnostics);\r\n\t\t\tconnection.sendNotification(StatusNotification.type, { state: Status.ok });\r\n\t\t} catch (err) {\r\n\t\t\tlet status = undefined;\r\n\t\t\tfor (let handler of singleErrorHandlers) {\r\n\t\t\t\tstatus = handler(err, document, settings.library);\r\n\t\t\t\tif (status) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus = status || Status.error;\r\n\t\t\tconnection.sendNotification(StatusNotification.type, { state: status });\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction validateMany(documents: TextDocument[]): void {\r\n\tdocuments.forEach(document => {\r\n\t\tmessageQueue.addNotificationMessage(ValidateNotification.type, document, document.version);\r\n\t});\r\n}\r\n\r\nfunction getMessage(err: any, document: TextDocument): string {\r\n\tlet result: string = null;\r\n\tif (typeof err.message === 'string' || err.message instanceof String) {\r\n\t\tresult = <string>err.message;\r\n\t\tresult = result.replace(/\\r?\\n/g, ' ');\r\n\t\tif (/^CLI: /.test(result)) {\r\n\t\t\tresult = result.substr(5);\r\n\t\t}\r\n\t} else {\r\n\t\tresult = `An unknown error occurred while validating document: ${document.uri}`;\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nlet ruleDocData: {\r\n\thandled: Set<string>;\r\n\turls: Map<string, string>;\r\n} = {\r\n\thandled: new Set<string>(),\r\n\turls: new Map<string, string>()\r\n};\r\n\r\n\r\nconst validFixTypes = new Set<string>(['problem', 'suggestion', 'layout']);\r\nfunction validate(document: TextDocument, settings: TextDocumentSettings, publishDiagnostics: boolean = true): void {\r\n\tlet newOptions: CLIOptions = Object.assign(Object.create(null), settings.options);\r\n\tlet fixTypes: Set<string> | undefined = undefined;\r\n\tif (Array.isArray(newOptions.fixTypes) && newOptions.fixTypes.length > 0) {\r\n\t\tfixTypes = new Set();\r\n\t\tfor (let item of newOptions.fixTypes) {\r\n\t\t\tif (validFixTypes.has(item)) {\r\n\t\t\t\tfixTypes.add(item);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (fixTypes.size === 0) {\r\n\t\t\tfixTypes = undefined;\r\n\t\t}\r\n\t}\r\n\tlet content = document.getText();\r\n\tlet uri = document.uri;\r\n\tlet file = getFilePath(document);\r\n\tlet cwd = process.cwd();\r\n\r\n\ttry {\r\n\t\tif (file) {\r\n\t\t\tif (settings.workingDirectory) {\r\n\t\t\t\tnewOptions.cwd = settings.workingDirectory.directory;\r\n\t\t\t\tif (settings.workingDirectory.changeProcessCWD) {\r\n\t\t\t\t\tprocess.chdir(settings.workingDirectory.directory);\r\n\t\t\t\t}\r\n\t\t\t} else if (settings.workspaceFolder) {\r\n\t\t\t\tlet workspaceFolderUri = URI.parse(settings.workspaceFolder.uri);\r\n\t\t\t\tif (workspaceFolderUri.scheme === 'file') {\r\n\t\t\t\t\tconst fsPath = getFileSystemPath(workspaceFolderUri);\r\n\t\t\t\t\tnewOptions.cwd = fsPath;\r\n\t\t\t\t\tprocess.chdir(fsPath);\r\n\t\t\t\t}\r\n\t\t\t} else if (!settings.workspaceFolder && !isUNC(file)) {\r\n\t\t\t\tlet directory = path.dirname(file);\r\n\t\t\t\tif (directory) {\r\n\t\t\t\t\tif (path.isAbsolute(directory)) {\r\n\t\t\t\t\t\tnewOptions.cwd = directory;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet cli = new settings.library.CLIEngine(newOptions);\r\n\t\t// Clean previously computed code actions.\r\n\t\tcodeActions.delete(uri);\r\n\t\tlet report: ESLintReport = cli.executeOnText(content, file);\r\n\t\tlet diagnostics: Diagnostic[] = [];\r\n\t\tif (report && report.results && Array.isArray(report.results) && report.results.length > 0) {\r\n\t\t\tlet docReport = report.results[0];\r\n\t\t\tif (docReport.messages && Array.isArray(docReport.messages)) {\r\n\t\t\t\tdocReport.messages.forEach((problem) => {\r\n\t\t\t\t\tif (problem) {\r\n\t\t\t\t\t\tconst isWarning = convertSeverity(problem.severity) === DiagnosticSeverity.Warning;\r\n\t\t\t\t\t\tif (settings.quiet && isWarning) {\r\n\t\t\t\t\t\t\t// Filter out warnings when quiet mode is enabled\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet diagnostic = makeDiagnostic(problem);\r\n\t\t\t\t\t\tdiagnostics.push(diagnostic);\r\n\t\t\t\t\t\tif (settings.autoFix) {\r\n\t\t\t\t\t\t\tif (fixTypes !== undefined && isFunction(cli.getRules) && problem.ruleId !== undefined && problem.fix !== undefined) {\r\n\t\t\t\t\t\t\t\tlet rule = cli.getRules().get(problem.ruleId);\r\n\t\t\t\t\t\t\t\tif (rule !== undefined && fixTypes.has(rule.meta.type)) {\r\n\t\t\t\t\t\t\t\t\trecordCodeAction(document, diagnostic, problem);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\trecordCodeAction(document, diagnostic, problem);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (publishDiagnostics) {\r\n\t\t\tconnection.sendDiagnostics({ uri, diagnostics });\r\n\t\t}\r\n\r\n\t\t// cache documentation urls for all rules\r\n\t\tif (isFunction(cli.getRules) && !ruleDocData.handled.has(uri)) {\r\n\t\t\truleDocData.handled.add(uri);\r\n\t\t\tcli.getRules().forEach((rule, key) => {\r\n\t\t\t\tif (rule.meta && rule.meta.docs && Is.string(rule.meta.docs.url)) {\r\n\t\t\t\t\truleDocData.urls.set(key, rule.meta.docs.url);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t} finally {\r\n\t\tif (cwd !== process.cwd()) {\r\n\t\t\tprocess.chdir(cwd);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nlet noConfigReported: Map<string, ESLintModule> = new Map<string, ESLintModule>();\r\n\r\nfunction isNoConfigFoundError(error: any): boolean {\r\n\tlet candidate = error as ESLintError;\r\n\treturn candidate.messageTemplate === 'no-config-found' || candidate.message === 'No ESLint configuration found.';\r\n}\r\n\r\nfunction tryHandleNoConfig(error: any, document: TextDocument, library: ESLintModule): Status {\r\n\tif (!isNoConfigFoundError(error)) {\r\n\t\treturn undefined;\r\n\t}\r\n\tif (!noConfigReported.has(document.uri)) {\r\n\t\tconnection.sendRequest(\r\n\t\t\tNoConfigRequest.type,\r\n\t\t\t{\r\n\t\t\t\tmessage: getMessage(error, document),\r\n\t\t\t\tdocument: {\r\n\t\t\t\t\turi: document.uri\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t).then(undefined, () => { });\r\n\t\tnoConfigReported.set(document.uri, library);\r\n\t}\r\n\treturn Status.warn;\r\n}\r\n\r\nlet configErrorReported: Map<string, ESLintModule> = new Map<string, ESLintModule>();\r\n\r\nfunction tryHandleConfigError(error: any, document: TextDocument, library: ESLintModule): Status {\r\n\tif (!error.message) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tfunction handleFileName(filename: string): Status {\r\n\t\tif (!configErrorReported.has(filename)) {\r\n\t\t\tconnection.console.error(getMessage(error, document));\r\n\t\t\tif (!documents.get(URI.file(filename).toString())) {\r\n\t\t\t\tconnection.window.showInformationMessage(getMessage(error, document));\r\n\t\t\t}\r\n\t\t\tconfigErrorReported.set(filename, library);\r\n\t\t}\r\n\t\treturn Status.warn;\r\n\t}\r\n\r\n\tlet matches = /Cannot read config file:\\s+(.*)\\nError:\\s+(.*)/.exec(error.message);\r\n\tif (matches && matches.length === 3) {\r\n\t\treturn handleFileName(matches[1]);\r\n\t}\r\n\r\n\tmatches = /(.*):\\n\\s*Configuration for rule \\\"(.*)\\\" is /.exec(error.message);\r\n\tif (matches && matches.length === 3) {\r\n\t\treturn handleFileName(matches[1]);\r\n\t}\r\n\r\n\tmatches = /Cannot find module '([^']*)'\\nReferenced from:\\s+(.*)/.exec(error.message);\r\n\tif (matches && matches.length === 3) {\r\n\t\treturn handleFileName(matches[2]);\r\n\t}\r\n\r\n\treturn undefined;\r\n}\r\n\r\nlet missingModuleReported: Map<string, ESLintModule> = new Map<string, ESLintModule>();\r\n\r\nfunction tryHandleMissingModule(error: any, document: TextDocument, library: ESLintModule): Status {\r\n\tif (!error.message) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tfunction handleMissingModule(plugin: string, module: string, error: ESLintError): Status {\r\n\t\tif (!missingModuleReported.has(plugin)) {\r\n\t\t\tlet fsPath = getFilePath(document);\r\n\t\t\tmissingModuleReported.set(plugin, library);\r\n\t\t\tif (error.messageTemplate === 'plugin-missing') {\r\n\t\t\t\tconnection.console.error([\r\n\t\t\t\t\t'',\r\n\t\t\t\t\t`${error.message.toString()}`,\r\n\t\t\t\t\t`Happened while validating ${fsPath ? fsPath : document.uri}`,\r\n\t\t\t\t\t`This can happen for a couple of reasons:`,\r\n\t\t\t\t\t`1. The plugin name is spelled incorrectly in an ESLint configuration file (e.g. .eslintrc).`,\r\n\t\t\t\t\t`2. If ESLint is installed globally, then make sure ${module} is installed globally as well.`,\r\n\t\t\t\t\t`3. If ESLint is installed locally, then ${module} isn't installed correctly.`,\r\n\t\t\t\t\t'',\r\n\t\t\t\t\t`Consider running eslint --debug ${fsPath ? fsPath : document.uri} from a terminal to obtain a trace about the configuration files used.`\r\n\t\t\t\t].join('\\n'));\r\n\t\t\t} else {\r\n\t\t\t\tconnection.console.error([\r\n\t\t\t\t\t`${error.message.toString()}`,\r\n\t\t\t\t\t`Happened while validating ${fsPath ? fsPath : document.uri}`\r\n\t\t\t\t].join('\\n'));\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn Status.warn;\r\n\t}\r\n\r\n\tlet matches = /Failed to load plugin (.*): Cannot find module (.*)/.exec(error.message);\r\n\tif (matches && matches.length === 3) {\r\n\t\treturn handleMissingModule(matches[1], matches[2], error);\r\n\t}\r\n\r\n\treturn undefined;\r\n}\r\n\r\nfunction showErrorMessage(error: any, document: TextDocument): Status {\r\n\tconnection.window.showErrorMessage(`ESLint: ${getMessage(error, document)}. Please see the 'ESLint' output channel for details.`);\r\n\tif (Is.string(error.stack)) {\r\n\t\tconnection.console.error('ESLint stack trace:');\r\n\t\tconnection.console.error(error.stack);\r\n\t}\r\n\treturn Status.error;\r\n}\r\n\r\nmessageQueue.registerNotification(DidChangeWatchedFilesNotification.type, (params) => {\r\n\t// A .eslintrc has change. No smartness here.\r\n\t// Simply revalidate all file.\r\n\truleDocData.handled.clear();\r\n\truleDocData.urls.clear();\r\n\tnoConfigReported = new Map<string, ESLintModule>();\r\n\tmissingModuleReported = new Map<string, ESLintModule>();\r\n\tparams.changes.forEach((change) => {\r\n\t\tlet fsPath = getFilePath(change.uri);\r\n\t\tif (!fsPath || isUNC(fsPath)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet dirname = path.dirname(fsPath);\r\n\t\tif (dirname) {\r\n\t\t\tlet library = configErrorReported.get(fsPath);\r\n\t\t\tif (library) {\r\n\t\t\t\tlet cli = new library.CLIEngine({});\r\n\t\t\t\ttry {\r\n\t\t\t\t\tcli.executeOnText('', path.join(dirname, '___test___.js'));\r\n\t\t\t\t\tconfigErrorReported.delete(fsPath);\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\tvalidateMany(documents.all());\r\n});\r\n\r\nclass Fixes {\r\n\tconstructor (private edits: Map<string, FixableProblem>) {\r\n\t}\r\n\r\n\tpublic static overlaps(lastEdit: FixableProblem, newEdit: FixableProblem): boolean {\r\n\t\treturn !!lastEdit && !!lastEdit.edit && lastEdit.edit.range[1] > newEdit.edit.range[0];\r\n\t}\r\n\r\n\tpublic isEmpty(): boolean {\r\n\t\treturn this.edits.size === 0;\r\n\t}\r\n\r\n\tpublic getDocumentVersion(): number {\r\n\t\tif (this.isEmpty()) {\r\n\t\t\tthrow new Error('No edits recorded.');\r\n\t\t}\r\n\t\treturn this.edits.values().next().value.documentVersion;\r\n\t}\r\n\r\n\tpublic getScoped(diagnostics: Diagnostic[]): FixableProblem[] {\r\n\t\tlet result: FixableProblem[] = [];\r\n\t\tfor(let diagnostic of diagnostics) {\r\n\t\t\tlet key = computeKey(diagnostic);\r\n\t\t\tlet editInfo = this.edits.get(key);\r\n\t\t\tif (editInfo) {\r\n\t\t\t\tresult.push(editInfo);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic getAllSorted(): FixableProblem[] {\r\n\t\tlet result: FixableProblem[] = [];\r\n\t\tthis.edits.forEach((value) => {\r\n\t\t\tif (!!value.edit) {\r\n\t\t\t\tresult.push(value);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn result.sort((a, b) => {\r\n\t\t\tlet d = a.edit.range[0] - b.edit.range[0];\r\n\t\t\tif (d !== 0) {\r\n\t\t\t\treturn d;\r\n\t\t\t}\r\n\t\t\tif (a.edit.range[1] === 0) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t\tif (b.edit.range[1] === 0) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn a.edit.range[1] - b.edit.range[1];\r\n\t\t});\r\n\t}\r\n\r\n\tpublic getOverlapFree(): FixableProblem[] {\r\n\t\tlet sorted = this.getAllSorted();\r\n\t\tif (sorted.length <= 1) {\r\n\t\t\treturn sorted;\r\n\t\t}\r\n\t\tlet result: FixableProblem[] = [];\r\n\t\tlet last: FixableProblem = sorted[0];\r\n\t\tresult.push(last);\r\n\t\tfor (let i = 1; i < sorted.length; i++) {\r\n\t\t\tlet current = sorted[i];\r\n\t\t\tif (!Fixes.overlaps(last, current)) {\r\n\t\t\t\tresult.push(current);\r\n\t\t\t\tlast = current;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\ninterface RuleCodeActions {\r\n\tfixes: CodeAction[];\r\n\tdisable?: CodeAction;\r\n\tfixAll?: CodeAction;\r\n\tdisableFile?: CodeAction;\r\n\tshowDocumentation?: CodeAction;\r\n}\r\n\r\nclass CodeActionResult {\r\n\tprivate _actions: Map<string, RuleCodeActions>;\r\n\tprivate _fixAll: CodeAction | undefined;\r\n\r\n\tpublic constructor() {\r\n\t\tthis._actions = new Map();\r\n\t}\r\n\r\n\tpublic get(ruleId: string): RuleCodeActions {\r\n\t\tlet result: RuleCodeActions = this._actions.get(ruleId);\r\n\t\tif (result === undefined) {\r\n\t\t\tresult = { fixes: [] };\r\n\t\t\tthis._actions.set(ruleId, result);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic set fixAll(action: CodeAction) {\r\n\t\tthis._fixAll = action;\r\n\t}\r\n\r\n\tpublic all(): CodeAction[] {\r\n\t\tlet result: CodeAction[] = [];\r\n\t\tfor (let actions of this._actions.values()) {\r\n\t\t\tresult.push(...actions.fixes);\r\n\t\t\tif (actions.disable) {\r\n\t\t\t\tresult.push(actions.disable);\r\n\t\t\t}\r\n\t\t\tif (actions.fixAll) {\r\n\t\t\t\tresult.push(actions.fixAll);\r\n\t\t\t}\r\n\t\t\tif (actions.disableFile) {\r\n\t\t\t\tresult.push(actions.disableFile);\r\n\t\t\t}\r\n\t\t\tif (actions.showDocumentation) {\r\n\t\t\t\tresult.push(actions.showDocumentation);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this._fixAll !== undefined) {\r\n\t\t\tresult.push(this._fixAll);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic get length(): number {\r\n\t\tlet result: number = 0;\r\n\t\tfor (let actions of this._actions.values()) {\r\n\t\t\tresult += actions.fixes.length;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\nlet commands: Map<string, WorkspaceChange>;\r\nmessageQueue.registerRequest(CodeActionRequest.type, (params) => {\r\n\tcommands = new Map<string, WorkspaceChange>();\r\n\tlet result: CodeActionResult = new CodeActionResult();\r\n\tlet uri = params.textDocument.uri;\r\n\tlet edits = codeActions.get(uri);\r\n\tif (!edits) {\r\n\t\treturn result.all();\r\n\t}\r\n\r\n\tlet fixes = new Fixes(edits);\r\n\tif (fixes.isEmpty()) {\r\n\t\treturn result.all();\r\n\t}\r\n\r\n\tlet textDocument = documents.get(uri);\r\n\tlet documentVersion: number = -1;\r\n\tlet allFixableRuleIds: string[] = [];\r\n\r\n\tfunction createTextEdit(editInfo: FixableProblem): TextEdit {\r\n\t\treturn TextEdit.replace(Range.create(textDocument.positionAt(editInfo.edit.range[0]), textDocument.positionAt(editInfo.edit.range[1])), editInfo.edit.text || '');\r\n\t}\r\n\r\n\tfunction createDisableLineTextEdit(editInfo: FixableProblem, indentationText: string): TextEdit {\r\n\t\treturn TextEdit.insert(Position.create(editInfo.line - 1, 0), `${indentationText}// eslint-disable-next-line ${editInfo.ruleId}${EOL}`);\r\n\t}\r\n\r\n\tfunction createDisableSameLineTextEdit(editInfo: FixableProblem): TextEdit {\r\n\t\treturn TextEdit.insert(Position.create(editInfo.line - 1, Number.MAX_VALUE), ` // eslint-disable-line ${editInfo.ruleId}`);\r\n\t}\r\n\r\n\tfunction createDisableFileTextEdit(editInfo: FixableProblem): TextEdit {\r\n\t\treturn TextEdit.insert(Position.create(0, 0), `/* eslint-disable ${editInfo.ruleId} */${EOL}`);\r\n\t}\r\n\r\n\tfunction getLastEdit(array: FixableProblem[]): FixableProblem {\r\n\t\tlet length = array.length;\r\n\t\tif (length === 0) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\treturn array[length - 1];\r\n\t}\r\n\r\n\treturn resolveSettings(textDocument).then((settings) => {\r\n\t\tfor (let editInfo of fixes.getScoped(params.context.diagnostics)) {\r\n\t\t\tdocumentVersion = editInfo.documentVersion;\r\n\t\t\tlet ruleId = editInfo.ruleId;\r\n\t\t\tallFixableRuleIds.push(ruleId);\r\n\r\n\t\t\tif (!!editInfo.edit) {\r\n\t\t\t\tlet workspaceChange = new WorkspaceChange();\r\n\t\t\t\tworkspaceChange.getTextEditChange({uri, version: documentVersion}).add(createTextEdit(editInfo));\r\n\t\t\t\tcommands.set(`${CommandIds.applySingleFix}:${ruleId}`, workspaceChange);\r\n\t\t\t\tresult.get(ruleId).fixes.push(CodeAction.create(\r\n\t\t\t\t\teditInfo.label,\r\n\t\t\t\t\tCommand.create(editInfo.label, CommandIds.applySingleFix, ruleId),\r\n\t\t\t\t\tCodeActionKind.QuickFix\r\n\t\t\t\t));\r\n\t\t\t}\r\n\r\n\t\t\tif (settings.codeAction.disableRuleComment.enable) {\r\n\t\t\t\tlet workspaceChange = new WorkspaceChange();\r\n\t\t\t\tif (settings.codeAction.disableRuleComment.location === 'sameLine') {\r\n\t\t\t\t\tworkspaceChange.getTextEditChange({uri, version: documentVersion}).add(createDisableSameLineTextEdit(editInfo));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet lineText = textDocument.getText(Range.create(Position.create(editInfo.line - 1, 0), Position.create(editInfo.line - 1, Number.MAX_VALUE)));\r\n\t\t\t\t\tlet indentationText = /^([ \\t]*)/.exec(lineText)[1];\r\n\t\t\t\t\tworkspaceChange.getTextEditChange({uri, version: documentVersion}).add(createDisableLineTextEdit(editInfo, indentationText));\r\n\t\t\t\t}\r\n\t\t\t\tcommands.set(`${CommandIds.applyDisableLine}:${ruleId}`, workspaceChange);\r\n\t\t\t\tlet title = `Disable ${ruleId} for this line`;\r\n\t\t\t\tresult.get(ruleId).disable = CodeAction.create(\r\n\t\t\t\t\ttitle,\r\n\t\t\t\t\tCommand.create(title, CommandIds.applyDisableLine, ruleId),\r\n\t\t\t\t\tCodeActionKind.QuickFix\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (result.get(ruleId).disableFile === undefined) {\r\n\t\t\t\t\tworkspaceChange = new WorkspaceChange();\r\n\t\t\t\t\tworkspaceChange.getTextEditChange({uri, version: documentVersion}).add(createDisableFileTextEdit(editInfo));\r\n\t\t\t\t\tcommands.set(`${CommandIds.applyDisableFile}:${ruleId}`, workspaceChange);\r\n\t\t\t\t\ttitle = `Disable ${ruleId} for the entire file`;\r\n\t\t\t\t\tresult.get(ruleId).disableFile = CodeAction.create(\r\n\t\t\t\t\t\ttitle,\r\n\t\t\t\t\t\tCommand.create(title, CommandIds.applyDisableFile, ruleId),\r\n\t\t\t\t\t\tCodeActionKind.QuickFix\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (settings.codeAction.showDocumentation.enable && result.get(ruleId).showDocumentation === undefined) {\r\n\t\t\t\tif (ruleDocData.urls.has(ruleId)) {\r\n\t\t\t\t\tlet title = `Show documentation for ${ruleId}`;\r\n\t\t\t\t\tresult.get(ruleId).showDocumentation = CodeAction.create(\r\n\t\t\t\t\t\ttitle,\r\n\t\t\t\t\t\tCommand.create(title, CommandIds.openRuleDoc, ruleId),\r\n\t\t\t\t\t\tCodeActionKind.QuickFix\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (result.length > 0) {\r\n\t\t\tlet sameProblems: Map<string, FixableProblem[]> = new Map<string, FixableProblem[]>(allFixableRuleIds.map<[string, FixableProblem[]]>(s => [s, []]));\r\n\t\t\tlet all: FixableProblem[] = [];\r\n\r\n\t\t\tfor (let editInfo of fixes.getAllSorted()) {\r\n\t\t\t\tif (documentVersion === -1) {\r\n\t\t\t\t\tdocumentVersion = editInfo.documentVersion;\r\n\t\t\t\t}\r\n\t\t\t\tif (sameProblems.has(editInfo.ruleId)) {\r\n\t\t\t\t\tlet same = sameProblems.get(editInfo.ruleId);\r\n\t\t\t\t\tif (!Fixes.overlaps(getLastEdit(same), editInfo)) {\r\n\t\t\t\t\t\tsame.push(editInfo);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!Fixes.overlaps(getLastEdit(all), editInfo)) {\r\n\t\t\t\t\tall.push(editInfo);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsameProblems.forEach((same, ruleId) => {\r\n\t\t\t\tif (same.length > 1) {\r\n\t\t\t\t\tlet sameFixes: WorkspaceChange = new WorkspaceChange();\r\n\t\t\t\t\tlet sameTextChange = sameFixes.getTextEditChange({uri, version: documentVersion});\r\n\t\t\t\t\tsame.map(createTextEdit).forEach(edit => sameTextChange.add(edit));\r\n\t\t\t\t\tcommands.set(CommandIds.applySameFixes, sameFixes);\r\n\t\t\t\t\tlet title = `Fix all ${ruleId} problems`;\r\n\t\t\t\t\tlet command = Command.create(title, CommandIds.applySameFixes);\r\n\t\t\t\t\tresult.get(ruleId).fixAll = CodeAction.create(\r\n\t\t\t\t\t\ttitle,\r\n\t\t\t\t\t\tcommand,\r\n\t\t\t\t\t\tCodeActionKind.QuickFix\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (all.length > 1) {\r\n\t\t\t\tlet allFixes: WorkspaceChange = new WorkspaceChange();\r\n\t\t\t\tlet allTextChange = allFixes.getTextEditChange({uri, version: documentVersion});\r\n\t\t\t\tall.map(createTextEdit).forEach(edit => allTextChange.add(edit));\r\n\t\t\t\tcommands.set(CommandIds.applyAllFixes, allFixes);\r\n\t\t\t\tlet title = `Fix all auto-fixable problems`;\r\n\t\t\t\tlet command = Command.create(title, CommandIds.applyAllFixes);\r\n\t\t\t\tresult.fixAll = CodeAction.create(\r\n\t\t\t\t\ttitle,\r\n\t\t\t\t\tcommand,\r\n\t\t\t\t\tCodeActionKind.QuickFix\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result.all();\r\n\t});\r\n}, (params): number => {\r\n\tlet document = documents.get(params.textDocument.uri);\r\n\treturn document ? document.version : undefined;\r\n});\r\n\r\nfunction computeAllFixes(identifier: VersionedTextDocumentIdentifier): TextEdit[] {\r\n\tlet uri = identifier.uri;\r\n\tlet textDocument = documents.get(uri);\r\n\tif (!textDocument || identifier.version !== textDocument.version) {\r\n\t\treturn undefined;\r\n\t}\r\n\tlet edits = codeActions.get(uri);\r\n\tfunction createTextEdit(editInfo: FixableProblem): TextEdit {\r\n\t\treturn TextEdit.replace(Range.create(textDocument.positionAt(editInfo.edit.range[0]), textDocument.positionAt(editInfo.edit.range[1])), editInfo.edit.text || '');\r\n\t}\r\n\r\n\tif (edits) {\r\n\t\tlet fixes = new Fixes(edits);\r\n\t\tif (!fixes.isEmpty()) {\r\n\t\t\treturn fixes.getOverlapFree().filter(fix => !!fix.edit).map(createTextEdit);\r\n\t\t}\r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\nmessageQueue.registerRequest(ExecuteCommandRequest.type, (params) => {\r\n\tlet workspaceChange: WorkspaceChange;\r\n\tif (params.command === CommandIds.applyAutoFix) {\r\n\t\tlet identifier: VersionedTextDocumentIdentifier = params.arguments[0];\r\n\t\tlet edits = computeAllFixes(identifier);\r\n\t\tif (edits) {\r\n\t\t\tworkspaceChange = new WorkspaceChange();\r\n\t\t\tlet textChange = workspaceChange.getTextEditChange(identifier);\r\n\t\t\tedits.forEach(edit => textChange.add(edit));\r\n\t\t}\r\n\t} else {\r\n\t\tif ([CommandIds.applySingleFix, CommandIds.applyDisableLine, CommandIds.applyDisableFile].indexOf(params.command) !== -1) {\r\n\t\t\tlet ruleId = params.arguments[0];\r\n\t\t\tworkspaceChange = commands.get(`${params.command}:${ruleId}`);\r\n\t\t} else if (params.command === CommandIds.openRuleDoc) {\r\n\t\t\tlet ruleId = params.arguments[0];\r\n\t\t\tlet url = ruleDocData.urls.get(ruleId);\r\n\t\t\tif (url) {\r\n\t\t\t\tconnection.sendRequest(OpenESLintDocRequest.type, { url });\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tworkspaceChange = commands.get(params.command);\r\n\t\t}\r\n\t}\r\n\r\n\tif (!workspaceChange) {\r\n\t\treturn {};\r\n\t}\r\n\treturn connection.workspace.applyEdit(workspaceChange.edit).then((response) => {\r\n\t\tif (!response.applied) {\r\n\t\t\tconnection.console.error(`Failed to apply command: ${params.command}`);\r\n\t\t}\r\n\t\treturn {};\r\n\t}, () => {\r\n\t\tconnection.console.error(`Failed to apply command: ${params.command}`);\r\n\t});\r\n}, (params): number => {\r\n\tif (params.command === CommandIds.applyAutoFix) {\r\n\t\tlet identifier: VersionedTextDocumentIdentifier = params.arguments[0];\r\n\t\treturn identifier.version;\r\n\t} else {\r\n\t\treturn undefined;\r\n\t}\r\n});\r\n\r\nconnection.listen();","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n/// <reference path=\"./thenable.ts\" />\r\n'use strict';\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nexports.Event = vscode_languageserver_protocol_1.Event;\r\nconst configuration_1 = require(\"./configuration\");\r\nconst workspaceFolders_1 = require(\"./workspaceFolders\");\r\nconst Is = require(\"./utils/is\");\r\nconst UUID = require(\"./utils/uuid\");\r\n// ------------- Reexport the API surface of the language worker API ----------------------\r\n__export(require(\"vscode-languageserver-protocol\"));\r\nconst fm = require(\"./files\");\r\nconst vscode_textbuffer_1 = require(\"vscode-textbuffer\");\r\nconst range_1 = require(\"vscode-textbuffer/lib/common/range\");\r\nvar Files;\r\n(function (Files) {\r\n    Files.uriToFilePath = fm.uriToFilePath;\r\n    Files.resolveGlobalNodePath = fm.resolveGlobalNodePath;\r\n    Files.resolveGlobalYarnPath = fm.resolveGlobalYarnPath;\r\n    Files.resolve = fm.resolve;\r\n    Files.resolveModulePath = fm.resolveModulePath;\r\n})(Files = exports.Files || (exports.Files = {}));\r\nlet shutdownReceived = false;\r\nlet exitTimer = undefined;\r\nfunction setupExitTimer() {\r\n    const argName = '--clientProcessId';\r\n    function runTimer(value) {\r\n        try {\r\n            let processId = parseInt(value);\r\n            if (!isNaN(processId)) {\r\n                exitTimer = setInterval(() => {\r\n                    try {\r\n                        process.kill(processId, 0);\r\n                    }\r\n                    catch (ex) {\r\n                        // Parent process doesn't exist anymore. Exit the server.\r\n                        process.exit(shutdownReceived ? 0 : 1);\r\n                    }\r\n                }, 3000);\r\n            }\r\n        }\r\n        catch (e) {\r\n            // Ignore errors;\r\n        }\r\n    }\r\n    for (let i = 2; i < process.argv.length; i++) {\r\n        let arg = process.argv[i];\r\n        if (arg === argName && i + 1 < process.argv.length) {\r\n            runTimer(process.argv[i + 1]);\r\n            return;\r\n        }\r\n        else {\r\n            let args = arg.split('=');\r\n            if (args[0] === argName) {\r\n                runTimer(args[1]);\r\n            }\r\n        }\r\n    }\r\n}\r\nsetupExitTimer();\r\nfunction null2Undefined(value) {\r\n    if (value === null) {\r\n        return void 0;\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * Incrementally-synchronized Text Document implementation that leverages a\r\n * \"Piece Tree\" as text buffer. See the following for details:\r\n *  - https://github.com/microsoft/vscode-textbuffer\r\n *  - https://code.visualstudio.com/blogs/2018/03/23/text-buffer-reimplementation\r\n *\r\n * This text document implementation only supports \"Incremental\" text document\r\n * sync. If you wish to use \"Full\" text document sync, use FullTextDocument, as it\r\n * uses a simple JS string as an underlying text buffer, since the full text gets\r\n * swapped out on every update.\r\n */\r\nclass IncrementalTextDocument {\r\n    constructor(uri, languageId, version, content) {\r\n        this._uri = uri;\r\n        this._languageId = languageId;\r\n        this._version = version;\r\n        // Prepare Piece Tree\r\n        const ptBuilder = new vscode_textbuffer_1.PieceTreeTextBufferBuilder();\r\n        ptBuilder.acceptChunk(content);\r\n        const ptFactory = ptBuilder.finish(true);\r\n        this._tree = ptFactory.create(1 /* LF */);\r\n    }\r\n    get uri() {\r\n        return this._uri;\r\n    }\r\n    get languageId() {\r\n        return this._languageId;\r\n    }\r\n    get version() {\r\n        return this._version;\r\n    }\r\n    getText(range) {\r\n        if (range) {\r\n            const { start, end } = range;\r\n            // Clamp last line and last character appropriately when\r\n            // given range is beyond the document's end\r\n            const [clampedEndLine, clampedEndChar] = end.line + 1 > this.lineCount\r\n                ? [this.lineCount, this._tree.getLineLength(this.lineCount) + 1]\r\n                : [end.line + 1, end.character + 1];\r\n            const ptRange = new range_1.Range(start.line + 1, start.character + 1, clampedEndLine, clampedEndChar);\r\n            return this._tree.getValueInRange(ptRange);\r\n        }\r\n        return this._tree.getLinesRawContent();\r\n    }\r\n    update(event, version) {\r\n        const { text, range } = event;\r\n        if (range == null) {\r\n            throw new Error(`FullPieceTreeTextDocument#update called with invalid event range ${range}`);\r\n        }\r\n        const startOffset = this.offsetAt(range.start);\r\n        const endOffset = this.offsetAt(range.end);\r\n        // Delete previous text at range and insert new text at appropriate offset\r\n        this._tree.delete(startOffset, endOffset - startOffset);\r\n        this._tree.insert(startOffset, text);\r\n        this._version = version;\r\n    }\r\n    positionAt(offset) {\r\n        const clampedOffset = Math.min(offset, this._tree.getLength());\r\n        const ptPosition = this._tree.getPositionAt(clampedOffset);\r\n        return vscode_languageserver_protocol_1.Position.create(ptPosition.lineNumber - 1, ptPosition.column - 1);\r\n    }\r\n    offsetAt(position) {\r\n        if (position.line < 0) {\r\n            return 0;\r\n        }\r\n        const clampedChar = Math.max(1, position.character + 1);\r\n        return Math.min(this._tree.getOffsetAt(position.line + 1, clampedChar), this._tree.getLength());\r\n    }\r\n    get lineCount() {\r\n        return this._tree.getLineCount();\r\n    }\r\n}\r\n/**\r\n * A manager for simple text documents\r\n */\r\nclass TextDocuments {\r\n    /**\r\n     * Create a new text document manager.\r\n     */\r\n    constructor(syncKind = vscode_languageserver_protocol_1.TextDocumentSyncKind.Full) {\r\n        this._documents = Object.create(null);\r\n        this._syncKind = syncKind;\r\n        this._onDidChangeContent = new vscode_languageserver_protocol_1.Emitter();\r\n        this._onDidOpen = new vscode_languageserver_protocol_1.Emitter();\r\n        this._onDidClose = new vscode_languageserver_protocol_1.Emitter();\r\n        this._onDidSave = new vscode_languageserver_protocol_1.Emitter();\r\n        this._onWillSave = new vscode_languageserver_protocol_1.Emitter();\r\n    }\r\n    /**\r\n     * Returns the [TextDocumentSyncKind](#TextDocumentSyncKind) used by\r\n     * this text document manager.\r\n     */\r\n    get syncKind() {\r\n        return this._syncKind;\r\n    }\r\n    /**\r\n     * An event that fires when a text document managed by this manager\r\n     * has been opened or the content changes.\r\n     */\r\n    get onDidChangeContent() {\r\n        return this._onDidChangeContent.event;\r\n    }\r\n    /**\r\n     * An event that fires when a text document managed by this manager\r\n     * has been opened.\r\n     */\r\n    get onDidOpen() {\r\n        return this._onDidOpen.event;\r\n    }\r\n    /**\r\n     * An event that fires when a text document managed by this manager\r\n     * will be saved.\r\n     */\r\n    get onWillSave() {\r\n        return this._onWillSave.event;\r\n    }\r\n    /**\r\n     * Sets a handler that will be called if a participant wants to provide\r\n     * edits during a text document save.\r\n     */\r\n    onWillSaveWaitUntil(handler) {\r\n        this._willSaveWaitUntil = handler;\r\n    }\r\n    /**\r\n     * An event that fires when a text document managed by this manager\r\n     * has been saved.\r\n     */\r\n    get onDidSave() {\r\n        return this._onDidSave.event;\r\n    }\r\n    /**\r\n     * An event that fires when a text document managed by this manager\r\n     * has been closed.\r\n     */\r\n    get onDidClose() {\r\n        return this._onDidClose.event;\r\n    }\r\n    /**\r\n     * Returns the document for the given URI. Returns undefined if\r\n     * the document is not mananged by this instance.\r\n     *\r\n     * @param uri The text document's URI to retrieve.\r\n     * @return the text document or `undefined`.\r\n     */\r\n    get(uri) {\r\n        return this._documents[uri];\r\n    }\r\n    /**\r\n     * Returns all text documents managed by this instance.\r\n     *\r\n     * @return all text documents.\r\n     */\r\n    all() {\r\n        return Object.keys(this._documents).map(key => this._documents[key]);\r\n    }\r\n    /**\r\n     * Returns the URIs of all text documents managed by this instance.\r\n     *\r\n     * @return the URI's of all text documents.\r\n     */\r\n    keys() {\r\n        return Object.keys(this._documents);\r\n    }\r\n    /**\r\n     * Listens for `low level` notification on the given connection to\r\n     * update the text documents managed by this instance.\r\n     *\r\n     * @param connection The connection to listen on.\r\n     */\r\n    listen(connection) {\r\n        function isUpdateableDocument(value) {\r\n            return Is.func(value.update);\r\n        }\r\n        connection.__textDocumentSync = vscode_languageserver_protocol_1.TextDocumentSyncKind.Full;\r\n        connection.onDidOpenTextDocument((event) => {\r\n            let td = event.textDocument;\r\n            let document;\r\n            switch (this.syncKind) {\r\n                case vscode_languageserver_protocol_1.TextDocumentSyncKind.Full:\r\n                    document = vscode_languageserver_protocol_1.TextDocument.create(td.uri, td.languageId, td.version, td.text);\r\n                    break;\r\n                case vscode_languageserver_protocol_1.TextDocumentSyncKind.Incremental:\r\n                    document = new IncrementalTextDocument(td.uri, td.languageId, td.version, td.text);\r\n                    break;\r\n                default:\r\n                    throw new Error(`Invalid TextDocumentSyncKind: ${this.syncKind}`);\r\n            }\r\n            this._documents[td.uri] = document;\r\n            let toFire = Object.freeze({ document });\r\n            this._onDidOpen.fire(toFire);\r\n            this._onDidChangeContent.fire(toFire);\r\n        });\r\n        connection.onDidChangeTextDocument((event) => {\r\n            let td = event.textDocument;\r\n            let changes = event.contentChanges;\r\n            if (changes.length === 0) {\r\n                return;\r\n            }\r\n            let document = this._documents[td.uri];\r\n            if (!document || !isUpdateableDocument(document)) {\r\n                return;\r\n            }\r\n            const { version } = td;\r\n            if (version == null || version === void 0) {\r\n                throw new Error(`Received document change event for ${td.uri} without valid version identifier`);\r\n            }\r\n            switch (this.syncKind) {\r\n                case vscode_languageserver_protocol_1.TextDocumentSyncKind.Full:\r\n                    let last = changes[changes.length - 1];\r\n                    document.update(last, version);\r\n                    this._onDidChangeContent.fire(Object.freeze({ document }));\r\n                    break;\r\n                case vscode_languageserver_protocol_1.TextDocumentSyncKind.Incremental:\r\n                    let updatedDoc = changes.reduce((workingTextDoc, change) => {\r\n                        workingTextDoc.update(change, version);\r\n                        return workingTextDoc;\r\n                    }, document);\r\n                    this._onDidChangeContent.fire(Object.freeze({ document: updatedDoc }));\r\n                    break;\r\n                case vscode_languageserver_protocol_1.TextDocumentSyncKind.None:\r\n                    break;\r\n            }\r\n        });\r\n        connection.onDidCloseTextDocument((event) => {\r\n            let document = this._documents[event.textDocument.uri];\r\n            if (document) {\r\n                delete this._documents[event.textDocument.uri];\r\n                this._onDidClose.fire(Object.freeze({ document }));\r\n            }\r\n        });\r\n        connection.onWillSaveTextDocument((event) => {\r\n            let document = this._documents[event.textDocument.uri];\r\n            if (document) {\r\n                this._onWillSave.fire(Object.freeze({ document, reason: event.reason }));\r\n            }\r\n        });\r\n        connection.onWillSaveTextDocumentWaitUntil((event, token) => {\r\n            let document = this._documents[event.textDocument.uri];\r\n            if (document && this._willSaveWaitUntil) {\r\n                return this._willSaveWaitUntil(Object.freeze({ document, reason: event.reason }), token);\r\n            }\r\n            else {\r\n                return [];\r\n            }\r\n        });\r\n        connection.onDidSaveTextDocument((event) => {\r\n            let document = this._documents[event.textDocument.uri];\r\n            if (document) {\r\n                this._onDidSave.fire(Object.freeze({ document }));\r\n            }\r\n        });\r\n    }\r\n}\r\nexports.TextDocuments = TextDocuments;\r\n/**\r\n * Helps tracking error message. Equal occurences of the same\r\n * message are only stored once. This class is for example\r\n * useful if text documents are validated in a loop and equal\r\n * error message should be folded into one.\r\n */\r\nclass ErrorMessageTracker {\r\n    constructor() {\r\n        this._messages = Object.create(null);\r\n    }\r\n    /**\r\n     * Add a message to the tracker.\r\n     *\r\n     * @param message The message to add.\r\n     */\r\n    add(message) {\r\n        let count = this._messages[message];\r\n        if (!count) {\r\n            count = 0;\r\n        }\r\n        count++;\r\n        this._messages[message] = count;\r\n    }\r\n    /**\r\n     * Send all tracked messages to the connection's window.\r\n     *\r\n     * @param connection The connection established between client and server.\r\n     */\r\n    sendErrors(connection) {\r\n        Object.keys(this._messages).forEach(message => {\r\n            connection.window.showErrorMessage(message);\r\n        });\r\n    }\r\n}\r\nexports.ErrorMessageTracker = ErrorMessageTracker;\r\nvar BulkRegistration;\r\n(function (BulkRegistration) {\r\n    /**\r\n     * Creates a new bulk registration.\r\n     * @return an empty bulk registration.\r\n     */\r\n    function create() {\r\n        return new BulkRegistrationImpl();\r\n    }\r\n    BulkRegistration.create = create;\r\n})(BulkRegistration = exports.BulkRegistration || (exports.BulkRegistration = {}));\r\nclass BulkRegistrationImpl {\r\n    constructor() {\r\n        this._registrations = [];\r\n        this._registered = new Set();\r\n    }\r\n    add(type, registerOptions) {\r\n        const method = Is.string(type) ? type : type.method;\r\n        if (this._registered.has(method)) {\r\n            throw new Error(`${method} is already added to this registration`);\r\n        }\r\n        const id = UUID.generateUuid();\r\n        this._registrations.push({\r\n            id: id,\r\n            method: method,\r\n            registerOptions: registerOptions || {}\r\n        });\r\n        this._registered.add(method);\r\n    }\r\n    asRegistrationParams() {\r\n        return {\r\n            registrations: this._registrations\r\n        };\r\n    }\r\n}\r\nvar BulkUnregistration;\r\n(function (BulkUnregistration) {\r\n    function create() {\r\n        return new BulkUnregistrationImpl(undefined, []);\r\n    }\r\n    BulkUnregistration.create = create;\r\n})(BulkUnregistration = exports.BulkUnregistration || (exports.BulkUnregistration = {}));\r\nclass BulkUnregistrationImpl {\r\n    constructor(_connection, unregistrations) {\r\n        this._connection = _connection;\r\n        this._unregistrations = new Map();\r\n        unregistrations.forEach(unregistration => {\r\n            this._unregistrations.set(unregistration.method, unregistration);\r\n        });\r\n    }\r\n    get isAttached() {\r\n        return !!this._connection;\r\n    }\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    add(unregistration) {\r\n        this._unregistrations.set(unregistration.method, unregistration);\r\n    }\r\n    dispose() {\r\n        let unregistrations = [];\r\n        for (let unregistration of this._unregistrations.values()) {\r\n            unregistrations.push(unregistration);\r\n        }\r\n        let params = {\r\n            unregisterations: unregistrations\r\n        };\r\n        this._connection.sendRequest(vscode_languageserver_protocol_1.UnregistrationRequest.type, params).then(undefined, (_error) => {\r\n            this._connection.console.info(`Bulk unregistration failed.`);\r\n        });\r\n    }\r\n    disposeSingle(arg) {\r\n        const method = Is.string(arg) ? arg : arg.method;\r\n        const unregistration = this._unregistrations.get(method);\r\n        if (!unregistration) {\r\n            return false;\r\n        }\r\n        let params = {\r\n            unregisterations: [unregistration]\r\n        };\r\n        this._connection.sendRequest(vscode_languageserver_protocol_1.UnregistrationRequest.type, params).then(() => {\r\n            this._unregistrations.delete(method);\r\n        }, (_error) => {\r\n            this._connection.console.info(`Unregistering request handler for ${unregistration.id} failed.`);\r\n        });\r\n        return true;\r\n    }\r\n}\r\nclass ConnectionLogger {\r\n    constructor() {\r\n    }\r\n    rawAttach(connection) {\r\n        this._rawConnection = connection;\r\n    }\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    get connection() {\r\n        if (!this._connection) {\r\n            throw new Error('Remote is not attached to a connection yet.');\r\n        }\r\n        return this._connection;\r\n    }\r\n    fillServerCapabilities(_capabilities) {\r\n    }\r\n    initialize(_capabilities) {\r\n    }\r\n    error(message) {\r\n        this.send(vscode_languageserver_protocol_1.MessageType.Error, message);\r\n    }\r\n    warn(message) {\r\n        this.send(vscode_languageserver_protocol_1.MessageType.Warning, message);\r\n    }\r\n    info(message) {\r\n        this.send(vscode_languageserver_protocol_1.MessageType.Info, message);\r\n    }\r\n    log(message) {\r\n        this.send(vscode_languageserver_protocol_1.MessageType.Log, message);\r\n    }\r\n    send(type, message) {\r\n        if (this._rawConnection) {\r\n            this._rawConnection.sendNotification(vscode_languageserver_protocol_1.LogMessageNotification.type, { type, message });\r\n        }\r\n    }\r\n}\r\nclass RemoteWindowImpl {\r\n    constructor() {\r\n    }\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    get connection() {\r\n        if (!this._connection) {\r\n            throw new Error('Remote is not attached to a connection yet.');\r\n        }\r\n        return this._connection;\r\n    }\r\n    initialize(_capabilities) {\r\n    }\r\n    fillServerCapabilities(_capabilities) {\r\n    }\r\n    showErrorMessage(message, ...actions) {\r\n        let params = { type: vscode_languageserver_protocol_1.MessageType.Error, message, actions };\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.ShowMessageRequest.type, params).then(null2Undefined);\r\n    }\r\n    showWarningMessage(message, ...actions) {\r\n        let params = { type: vscode_languageserver_protocol_1.MessageType.Warning, message, actions };\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.ShowMessageRequest.type, params).then(null2Undefined);\r\n    }\r\n    showInformationMessage(message, ...actions) {\r\n        let params = { type: vscode_languageserver_protocol_1.MessageType.Info, message, actions };\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.ShowMessageRequest.type, params).then(null2Undefined);\r\n    }\r\n}\r\nclass RemoteClientImpl {\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    get connection() {\r\n        if (!this._connection) {\r\n            throw new Error('Remote is not attached to a connection yet.');\r\n        }\r\n        return this._connection;\r\n    }\r\n    initialize(_capabilities) {\r\n    }\r\n    fillServerCapabilities(_capabilities) {\r\n    }\r\n    register(typeOrRegistrations, registerOptionsOrType, registerOptions) {\r\n        if (typeOrRegistrations instanceof BulkRegistrationImpl) {\r\n            return this.registerMany(typeOrRegistrations);\r\n        }\r\n        else if (typeOrRegistrations instanceof BulkUnregistrationImpl) {\r\n            return this.registerSingle1(typeOrRegistrations, registerOptionsOrType, registerOptions);\r\n        }\r\n        else {\r\n            return this.registerSingle2(typeOrRegistrations, registerOptionsOrType);\r\n        }\r\n    }\r\n    registerSingle1(unregistration, type, registerOptions) {\r\n        const method = Is.string(type) ? type : type.method;\r\n        const id = UUID.generateUuid();\r\n        let params = {\r\n            registrations: [{ id, method, registerOptions: registerOptions || {} }]\r\n        };\r\n        if (!unregistration.isAttached) {\r\n            unregistration.attach(this._connection);\r\n        }\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.RegistrationRequest.type, params).then((_result) => {\r\n            unregistration.add({ id: id, method: method });\r\n            return unregistration;\r\n        }, (_error) => {\r\n            this.connection.console.info(`Registering request handler for ${method} failed.`);\r\n            return Promise.reject(_error);\r\n        });\r\n    }\r\n    registerSingle2(type, registerOptions) {\r\n        const method = Is.string(type) ? type : type.method;\r\n        const id = UUID.generateUuid();\r\n        let params = {\r\n            registrations: [{ id, method, registerOptions: registerOptions || {} }]\r\n        };\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.RegistrationRequest.type, params).then((_result) => {\r\n            return vscode_languageserver_protocol_1.Disposable.create(() => {\r\n                this.unregisterSingle(id, method);\r\n            });\r\n        }, (_error) => {\r\n            this.connection.console.info(`Registering request handler for ${method} failed.`);\r\n            return Promise.reject(_error);\r\n        });\r\n    }\r\n    unregisterSingle(id, method) {\r\n        let params = {\r\n            unregisterations: [{ id, method }]\r\n        };\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.UnregistrationRequest.type, params).then(undefined, (_error) => {\r\n            this.connection.console.info(`Unregistering request handler for ${id} failed.`);\r\n        });\r\n    }\r\n    registerMany(registrations) {\r\n        let params = registrations.asRegistrationParams();\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.RegistrationRequest.type, params).then(() => {\r\n            return new BulkUnregistrationImpl(this._connection, params.registrations.map(registration => { return { id: registration.id, method: registration.method }; }));\r\n        }, (_error) => {\r\n            this.connection.console.info(`Bulk registration failed.`);\r\n            return Promise.reject(_error);\r\n        });\r\n    }\r\n}\r\nclass _RemoteWorkspaceImpl {\r\n    constructor() {\r\n    }\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    get connection() {\r\n        if (!this._connection) {\r\n            throw new Error('Remote is not attached to a connection yet.');\r\n        }\r\n        return this._connection;\r\n    }\r\n    initialize(_capabilities) {\r\n    }\r\n    fillServerCapabilities(_capabilities) {\r\n    }\r\n    applyEdit(paramOrEdit) {\r\n        function isApplyWorkspaceEditParams(value) {\r\n            return value && !!value.edit;\r\n        }\r\n        let params = isApplyWorkspaceEditParams(paramOrEdit) ? paramOrEdit : { edit: paramOrEdit };\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.ApplyWorkspaceEditRequest.type, params);\r\n    }\r\n}\r\nconst RemoteWorkspaceImpl = workspaceFolders_1.WorkspaceFoldersFeature(configuration_1.ConfigurationFeature(_RemoteWorkspaceImpl));\r\nclass TracerImpl {\r\n    constructor() {\r\n        this._trace = vscode_languageserver_protocol_1.Trace.Off;\r\n    }\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    get connection() {\r\n        if (!this._connection) {\r\n            throw new Error('Remote is not attached to a connection yet.');\r\n        }\r\n        return this._connection;\r\n    }\r\n    initialize(_capabilities) {\r\n    }\r\n    fillServerCapabilities(_capabilities) {\r\n    }\r\n    set trace(value) {\r\n        this._trace = value;\r\n    }\r\n    log(message, verbose) {\r\n        if (this._trace === vscode_languageserver_protocol_1.Trace.Off) {\r\n            return;\r\n        }\r\n        this._connection.sendNotification(vscode_languageserver_protocol_1.LogTraceNotification.type, {\r\n            message: message,\r\n            verbose: this._trace === vscode_languageserver_protocol_1.Trace.Verbose ? verbose : undefined\r\n        });\r\n    }\r\n}\r\nclass TelemetryImpl {\r\n    constructor() {\r\n    }\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    get connection() {\r\n        if (!this._connection) {\r\n            throw new Error('Remote is not attached to a connection yet.');\r\n        }\r\n        return this._connection;\r\n    }\r\n    initialize(_capabilities) {\r\n    }\r\n    fillServerCapabilities(_capabilities) {\r\n    }\r\n    logEvent(data) {\r\n        this._connection.sendNotification(vscode_languageserver_protocol_1.TelemetryEventNotification.type, data);\r\n    }\r\n}\r\nfunction combineConsoleFeatures(one, two) {\r\n    return function (Base) {\r\n        return two(one(Base));\r\n    };\r\n}\r\nexports.combineConsoleFeatures = combineConsoleFeatures;\r\nfunction combineTelemetryFeatures(one, two) {\r\n    return function (Base) {\r\n        return two(one(Base));\r\n    };\r\n}\r\nexports.combineTelemetryFeatures = combineTelemetryFeatures;\r\nfunction combineTracerFeatures(one, two) {\r\n    return function (Base) {\r\n        return two(one(Base));\r\n    };\r\n}\r\nexports.combineTracerFeatures = combineTracerFeatures;\r\nfunction combineClientFeatures(one, two) {\r\n    return function (Base) {\r\n        return two(one(Base));\r\n    };\r\n}\r\nexports.combineClientFeatures = combineClientFeatures;\r\nfunction combineWindowFeatures(one, two) {\r\n    return function (Base) {\r\n        return two(one(Base));\r\n    };\r\n}\r\nexports.combineWindowFeatures = combineWindowFeatures;\r\nfunction combineWorkspaceFeatures(one, two) {\r\n    return function (Base) {\r\n        return two(one(Base));\r\n    };\r\n}\r\nexports.combineWorkspaceFeatures = combineWorkspaceFeatures;\r\nfunction combineFeatures(one, two) {\r\n    function combine(one, two, func) {\r\n        if (one && two) {\r\n            return func(one, two);\r\n        }\r\n        else if (one) {\r\n            return one;\r\n        }\r\n        else {\r\n            return two;\r\n        }\r\n    }\r\n    let result = {\r\n        __brand: 'features',\r\n        console: combine(one.console, two.console, combineConsoleFeatures),\r\n        tracer: combine(one.tracer, two.tracer, combineTracerFeatures),\r\n        telemetry: combine(one.telemetry, two.telemetry, combineTelemetryFeatures),\r\n        client: combine(one.client, two.client, combineClientFeatures),\r\n        window: combine(one.window, two.window, combineWindowFeatures),\r\n        workspace: combine(one.workspace, two.workspace, combineWorkspaceFeatures)\r\n    };\r\n    return result;\r\n}\r\nexports.combineFeatures = combineFeatures;\r\nfunction createConnection(arg1, arg2, arg3, arg4) {\r\n    let factories;\r\n    let input;\r\n    let output;\r\n    let strategy;\r\n    if (arg1 !== void 0 && arg1.__brand === 'features') {\r\n        factories = arg1;\r\n        arg1 = arg2;\r\n        arg2 = arg3;\r\n        arg3 = arg4;\r\n    }\r\n    if (vscode_languageserver_protocol_1.ConnectionStrategy.is(arg1)) {\r\n        strategy = arg1;\r\n    }\r\n    else {\r\n        input = arg1;\r\n        output = arg2;\r\n        strategy = arg3;\r\n    }\r\n    return _createConnection(input, output, strategy, factories);\r\n}\r\nexports.createConnection = createConnection;\r\nfunction _createConnection(input, output, strategy, factories) {\r\n    if (!input && !output && process.argv.length > 2) {\r\n        let port = void 0;\r\n        let pipeName = void 0;\r\n        let argv = process.argv.slice(2);\r\n        for (let i = 0; i < argv.length; i++) {\r\n            let arg = argv[i];\r\n            if (arg === '--node-ipc') {\r\n                input = new vscode_languageserver_protocol_1.IPCMessageReader(process);\r\n                output = new vscode_languageserver_protocol_1.IPCMessageWriter(process);\r\n                break;\r\n            }\r\n            else if (arg === '--stdio') {\r\n                input = process.stdin;\r\n                output = process.stdout;\r\n                break;\r\n            }\r\n            else if (arg === '--socket') {\r\n                port = parseInt(argv[i + 1]);\r\n                break;\r\n            }\r\n            else if (arg === '--pipe') {\r\n                pipeName = argv[i + 1];\r\n                break;\r\n            }\r\n            else {\r\n                var args = arg.split('=');\r\n                if (args[0] === '--socket') {\r\n                    port = parseInt(args[1]);\r\n                    break;\r\n                }\r\n                else if (args[0] === '--pipe') {\r\n                    pipeName = args[1];\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (port) {\r\n            let transport = vscode_languageserver_protocol_1.createServerSocketTransport(port);\r\n            input = transport[0];\r\n            output = transport[1];\r\n        }\r\n        else if (pipeName) {\r\n            let transport = vscode_languageserver_protocol_1.createServerPipeTransport(pipeName);\r\n            input = transport[0];\r\n            output = transport[1];\r\n        }\r\n    }\r\n    var commandLineMessage = \"Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'\";\r\n    if (!input) {\r\n        throw new Error(\"Connection input stream is not set. \" + commandLineMessage);\r\n    }\r\n    if (!output) {\r\n        throw new Error(\"Connection output stream is not set. \" + commandLineMessage);\r\n    }\r\n    // Backwards compatibility\r\n    if (Is.func(input.read) && Is.func(input.on)) {\r\n        let inputStream = input;\r\n        inputStream.on('end', () => {\r\n            process.exit(shutdownReceived ? 0 : 1);\r\n        });\r\n        inputStream.on('close', () => {\r\n            process.exit(shutdownReceived ? 0 : 1);\r\n        });\r\n    }\r\n    const logger = (factories && factories.console ? new (factories.console(ConnectionLogger))() : new ConnectionLogger());\r\n    const connection = vscode_languageserver_protocol_1.createProtocolConnection(input, output, logger, strategy);\r\n    logger.rawAttach(connection);\r\n    const tracer = (factories && factories.tracer ? new (factories.tracer(TracerImpl))() : new TracerImpl());\r\n    const telemetry = (factories && factories.telemetry ? new (factories.telemetry(TelemetryImpl))() : new TelemetryImpl());\r\n    const client = (factories && factories.client ? new (factories.client(RemoteClientImpl))() : new RemoteClientImpl());\r\n    const remoteWindow = (factories && factories.window ? new (factories.window(RemoteWindowImpl))() : new RemoteWindowImpl());\r\n    const workspace = (factories && factories.workspace ? new (factories.workspace(RemoteWorkspaceImpl))() : new RemoteWorkspaceImpl());\r\n    const allRemotes = [logger, tracer, telemetry, client, remoteWindow, workspace];\r\n    function asThenable(value) {\r\n        if (Is.thenable(value)) {\r\n            return value;\r\n        }\r\n        else {\r\n            return Promise.resolve(value);\r\n        }\r\n    }\r\n    let shutdownHandler = undefined;\r\n    let initializeHandler = undefined;\r\n    let exitHandler = undefined;\r\n    let protocolConnection = {\r\n        listen: () => connection.listen(),\r\n        sendRequest: (type, ...params) => connection.sendRequest(Is.string(type) ? type : type.method, ...params),\r\n        onRequest: (type, handler) => connection.onRequest(type, handler),\r\n        sendNotification: (type, param) => {\r\n            const method = Is.string(type) ? type : type.method;\r\n            if (arguments.length === 1) {\r\n                connection.sendNotification(method);\r\n            }\r\n            else {\r\n                connection.sendNotification(method, param);\r\n            }\r\n        },\r\n        onNotification: (type, handler) => connection.onNotification(type, handler),\r\n        onProgress: connection.onProgress,\r\n        sendProgress: connection.sendProgress,\r\n        onInitialize: (handler) => initializeHandler = handler,\r\n        onInitialized: (handler) => connection.onNotification(vscode_languageserver_protocol_1.InitializedNotification.type, handler),\r\n        onShutdown: (handler) => shutdownHandler = handler,\r\n        onExit: (handler) => exitHandler = handler,\r\n        get console() { return logger; },\r\n        get telemetry() { return telemetry; },\r\n        get tracer() { return tracer; },\r\n        get client() { return client; },\r\n        get window() { return remoteWindow; },\r\n        get workspace() { return workspace; },\r\n        onDidChangeConfiguration: (handler) => connection.onNotification(vscode_languageserver_protocol_1.DidChangeConfigurationNotification.type, handler),\r\n        onDidChangeWatchedFiles: (handler) => connection.onNotification(vscode_languageserver_protocol_1.DidChangeWatchedFilesNotification.type, handler),\r\n        __textDocumentSync: undefined,\r\n        onDidOpenTextDocument: (handler) => connection.onNotification(vscode_languageserver_protocol_1.DidOpenTextDocumentNotification.type, handler),\r\n        onDidChangeTextDocument: (handler) => connection.onNotification(vscode_languageserver_protocol_1.DidChangeTextDocumentNotification.type, handler),\r\n        onDidCloseTextDocument: (handler) => connection.onNotification(vscode_languageserver_protocol_1.DidCloseTextDocumentNotification.type, handler),\r\n        onWillSaveTextDocument: (handler) => connection.onNotification(vscode_languageserver_protocol_1.WillSaveTextDocumentNotification.type, handler),\r\n        onWillSaveTextDocumentWaitUntil: (handler) => connection.onRequest(vscode_languageserver_protocol_1.WillSaveTextDocumentWaitUntilRequest.type, handler),\r\n        onDidSaveTextDocument: (handler) => connection.onNotification(vscode_languageserver_protocol_1.DidSaveTextDocumentNotification.type, handler),\r\n        sendDiagnostics: (params) => connection.sendNotification(vscode_languageserver_protocol_1.PublishDiagnosticsNotification.type, params),\r\n        onHover: (handler) => connection.onRequest(vscode_languageserver_protocol_1.HoverRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), undefined);\r\n        }),\r\n        onCompletion: (handler) => connection.onRequest(vscode_languageserver_protocol_1.CompletionRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onCompletionResolve: (handler) => connection.onRequest(vscode_languageserver_protocol_1.CompletionResolveRequest.type, handler),\r\n        onSignatureHelp: (handler) => connection.onRequest(vscode_languageserver_protocol_1.SignatureHelpRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), undefined);\r\n        }),\r\n        onDeclaration: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DeclarationRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onDefinition: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DefinitionRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onTypeDefinition: (handler) => connection.onRequest(vscode_languageserver_protocol_1.TypeDefinitionRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onImplementation: (handler) => connection.onRequest(vscode_languageserver_protocol_1.ImplementationRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onReferences: (handler) => connection.onRequest(vscode_languageserver_protocol_1.ReferencesRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onDocumentHighlight: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentHighlightRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onDocumentSymbol: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentSymbolRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onWorkspaceSymbol: (handler) => connection.onRequest(vscode_languageserver_protocol_1.WorkspaceSymbolRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onCodeAction: (handler) => connection.onRequest(vscode_languageserver_protocol_1.CodeActionRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onCodeLens: (handler) => connection.onRequest(vscode_languageserver_protocol_1.CodeLensRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onCodeLensResolve: (handler) => connection.onRequest(vscode_languageserver_protocol_1.CodeLensResolveRequest.type, handler),\r\n        onDocumentFormatting: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentFormattingRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), undefined);\r\n        }),\r\n        onDocumentRangeFormatting: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentRangeFormattingRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), undefined);\r\n        }),\r\n        onDocumentOnTypeFormatting: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentOnTypeFormattingRequest.type, handler),\r\n        onRenameRequest: (handler) => connection.onRequest(vscode_languageserver_protocol_1.RenameRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), undefined);\r\n        }),\r\n        onPrepareRename: (handler) => connection.onRequest(vscode_languageserver_protocol_1.PrepareRenameRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), undefined);\r\n        }),\r\n        onDocumentLinks: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentLinkRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onDocumentLinkResolve: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentLinkResolveRequest.type, handler),\r\n        onDocumentColor: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentColorRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onColorPresentation: (handler) => connection.onRequest(vscode_languageserver_protocol_1.ColorPresentationRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onFoldingRanges: (handler) => connection.onRequest(vscode_languageserver_protocol_1.FoldingRangeRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onSelectionRanges: (handler) => connection.onRequest(vscode_languageserver_protocol_1.SelectionRangeRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), proposed_progress_1.attachPartialResult(connection, params));\r\n        }),\r\n        onExecuteCommand: (handler) => connection.onRequest(vscode_languageserver_protocol_1.ExecuteCommandRequest.type, (params, cancel) => {\r\n            return handler(params, cancel, proposed_progress_1.attachWorkDone(connection, params), undefined);\r\n        }),\r\n        dispose: () => connection.dispose()\r\n    };\r\n    for (let remote of allRemotes) {\r\n        remote.attach(protocolConnection);\r\n    }\r\n    connection.onRequest(vscode_languageserver_protocol_1.InitializeRequest.type, (params) => {\r\n        const processId = params.processId;\r\n        if (Is.number(processId) && exitTimer === void 0) {\r\n            // We received a parent process id. Set up a timer to periodically check\r\n            // if the parent is still alive.\r\n            setInterval(() => {\r\n                try {\r\n                    process.kill(processId, 0);\r\n                }\r\n                catch (ex) {\r\n                    // Parent process doesn't exist anymore. Exit the server.\r\n                    process.exit(shutdownReceived ? 0 : 1);\r\n                }\r\n            }, 3000);\r\n        }\r\n        if (Is.string(params.trace)) {\r\n            tracer.trace = vscode_languageserver_protocol_1.Trace.fromString(params.trace);\r\n        }\r\n        for (let remote of allRemotes) {\r\n            remote.initialize(params.capabilities);\r\n        }\r\n        if (initializeHandler) {\r\n            let result = initializeHandler(params, new vscode_languageserver_protocol_1.CancellationTokenSource().token, proposed_progress_1.attachWorkDone(connection, params), undefined);\r\n            return asThenable(result).then((value) => {\r\n                if (value instanceof vscode_languageserver_protocol_1.ResponseError) {\r\n                    return value;\r\n                }\r\n                let result = value;\r\n                if (!result) {\r\n                    result = { capabilities: {} };\r\n                }\r\n                let capabilities = result.capabilities;\r\n                if (!capabilities) {\r\n                    capabilities = {};\r\n                    result.capabilities = capabilities;\r\n                }\r\n                if (capabilities.textDocumentSync === void 0 || capabilities.textDocumentSync === null) {\r\n                    capabilities.textDocumentSync = Is.number(protocolConnection.__textDocumentSync) ? protocolConnection.__textDocumentSync : vscode_languageserver_protocol_1.TextDocumentSyncKind.None;\r\n                }\r\n                else if (!Is.number(capabilities.textDocumentSync) && !Is.number(capabilities.textDocumentSync.change)) {\r\n                    capabilities.textDocumentSync.change = Is.number(protocolConnection.__textDocumentSync) ? protocolConnection.__textDocumentSync : vscode_languageserver_protocol_1.TextDocumentSyncKind.None;\r\n                }\r\n                for (let remote of allRemotes) {\r\n                    remote.fillServerCapabilities(capabilities);\r\n                }\r\n                return result;\r\n            });\r\n        }\r\n        else {\r\n            let result = { capabilities: { textDocumentSync: vscode_languageserver_protocol_1.TextDocumentSyncKind.None } };\r\n            for (let remote of allRemotes) {\r\n                remote.fillServerCapabilities(result.capabilities);\r\n            }\r\n            return result;\r\n        }\r\n    });\r\n    connection.onRequest(vscode_languageserver_protocol_1.ShutdownRequest.type, () => {\r\n        shutdownReceived = true;\r\n        if (shutdownHandler) {\r\n            return shutdownHandler(new vscode_languageserver_protocol_1.CancellationTokenSource().token);\r\n        }\r\n        else {\r\n            return undefined;\r\n        }\r\n    });\r\n    connection.onNotification(vscode_languageserver_protocol_1.ExitNotification.type, () => {\r\n        try {\r\n            if (exitHandler) {\r\n                exitHandler();\r\n            }\r\n        }\r\n        finally {\r\n            if (shutdownReceived) {\r\n                process.exit(0);\r\n            }\r\n            else {\r\n                process.exit(1);\r\n            }\r\n        }\r\n    });\r\n    connection.onNotification(vscode_languageserver_protocol_1.SetTraceNotification.type, (params) => {\r\n        tracer.trace = vscode_languageserver_protocol_1.Trace.fromString(params.value);\r\n    });\r\n    return protocolConnection;\r\n}\r\n// Export the protocol currently in proposed state.\r\nconst proposed_progress_1 = require(\"./proposed.progress\");\r\nvar ProposedFeatures;\r\n(function (ProposedFeatures) {\r\n    ProposedFeatures.all = {\r\n        __brand: 'features',\r\n        window: proposed_progress_1.ProgressFeature\r\n    };\r\n})(ProposedFeatures = exports.ProposedFeatures || (exports.ProposedFeatures = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst is = require(\"./is\");\r\n/**\r\n * Predefined error codes.\r\n */\r\nvar ErrorCodes;\r\n(function (ErrorCodes) {\r\n    // Defined by JSON RPC\r\n    ErrorCodes.ParseError = -32700;\r\n    ErrorCodes.InvalidRequest = -32600;\r\n    ErrorCodes.MethodNotFound = -32601;\r\n    ErrorCodes.InvalidParams = -32602;\r\n    ErrorCodes.InternalError = -32603;\r\n    ErrorCodes.serverErrorStart = -32099;\r\n    ErrorCodes.serverErrorEnd = -32000;\r\n    ErrorCodes.ServerNotInitialized = -32002;\r\n    ErrorCodes.UnknownErrorCode = -32001;\r\n    // Defined by the protocol.\r\n    ErrorCodes.RequestCancelled = -32800;\r\n    ErrorCodes.ContentModified = -32801;\r\n    // Defined by VSCode library.\r\n    ErrorCodes.MessageWriteError = 1;\r\n    ErrorCodes.MessageReadError = 2;\r\n})(ErrorCodes = exports.ErrorCodes || (exports.ErrorCodes = {}));\r\n/**\r\n * An error object return in a response in case a request\r\n * has failed.\r\n */\r\nclass ResponseError extends Error {\r\n    constructor(code, message, data) {\r\n        super(message);\r\n        this.code = is.number(code) ? code : ErrorCodes.UnknownErrorCode;\r\n        this.data = data;\r\n        Object.setPrototypeOf(this, ResponseError.prototype);\r\n    }\r\n    toJson() {\r\n        return {\r\n            code: this.code,\r\n            message: this.message,\r\n            data: this.data,\r\n        };\r\n    }\r\n}\r\nexports.ResponseError = ResponseError;\r\n/**\r\n * An abstract implementation of a MessageType.\r\n */\r\nclass AbstractMessageType {\r\n    constructor(_method, _numberOfParams) {\r\n        this._method = _method;\r\n        this._numberOfParams = _numberOfParams;\r\n    }\r\n    get method() {\r\n        return this._method;\r\n    }\r\n    get numberOfParams() {\r\n        return this._numberOfParams;\r\n    }\r\n}\r\nexports.AbstractMessageType = AbstractMessageType;\r\n/**\r\n * Classes to type request response pairs\r\n */\r\nclass RequestType0 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 0);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType0 = RequestType0;\r\nclass RequestType extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 1);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType = RequestType;\r\nclass RequestType1 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 1);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType1 = RequestType1;\r\nclass RequestType2 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 2);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType2 = RequestType2;\r\nclass RequestType3 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 3);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType3 = RequestType3;\r\nclass RequestType4 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 4);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType4 = RequestType4;\r\nclass RequestType5 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 5);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType5 = RequestType5;\r\nclass RequestType6 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 6);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType6 = RequestType6;\r\nclass RequestType7 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 7);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType7 = RequestType7;\r\nclass RequestType8 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 8);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType8 = RequestType8;\r\nclass RequestType9 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 9);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType9 = RequestType9;\r\nclass NotificationType extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 1);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType = NotificationType;\r\nclass NotificationType0 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 0);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType0 = NotificationType0;\r\nclass NotificationType1 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 1);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType1 = NotificationType1;\r\nclass NotificationType2 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 2);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType2 = NotificationType2;\r\nclass NotificationType3 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 3);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType3 = NotificationType3;\r\nclass NotificationType4 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 4);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType4 = NotificationType4;\r\nclass NotificationType5 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 5);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType5 = NotificationType5;\r\nclass NotificationType6 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 6);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType6 = NotificationType6;\r\nclass NotificationType7 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 7);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType7 = NotificationType7;\r\nclass NotificationType8 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 8);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType8 = NotificationType8;\r\nclass NotificationType9 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 9);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType9 = NotificationType9;\r\n/**\r\n * Tests if the given message is a request message\r\n */\r\nfunction isRequestMessage(message) {\r\n    let candidate = message;\r\n    return candidate && is.string(candidate.method) && (is.string(candidate.id) || is.number(candidate.id));\r\n}\r\nexports.isRequestMessage = isRequestMessage;\r\n/**\r\n * Tests if the given message is a notification message\r\n */\r\nfunction isNotificationMessage(message) {\r\n    let candidate = message;\r\n    return candidate && is.string(candidate.method) && message.id === void 0;\r\n}\r\nexports.isNotificationMessage = isNotificationMessage;\r\n/**\r\n * Tests if the given message is a response message\r\n */\r\nfunction isResponseMessage(message) {\r\n    let candidate = message;\r\n    return candidate && (candidate.result !== void 0 || !!candidate.error) && (is.string(candidate.id) || is.number(candidate.id) || candidate.id === null);\r\n}\r\nexports.isResponseMessage = isResponseMessage;\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst events_1 = require(\"./events\");\r\nconst Is = require(\"./is\");\r\nvar CancellationToken;\r\n(function (CancellationToken) {\r\n    CancellationToken.None = Object.freeze({\r\n        isCancellationRequested: false,\r\n        onCancellationRequested: events_1.Event.None\r\n    });\r\n    CancellationToken.Cancelled = Object.freeze({\r\n        isCancellationRequested: true,\r\n        onCancellationRequested: events_1.Event.None\r\n    });\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && (candidate === CancellationToken.None\r\n            || candidate === CancellationToken.Cancelled\r\n            || (Is.boolean(candidate.isCancellationRequested) && !!candidate.onCancellationRequested));\r\n    }\r\n    CancellationToken.is = is;\r\n})(CancellationToken = exports.CancellationToken || (exports.CancellationToken = {}));\r\nconst shortcutEvent = Object.freeze(function (callback, context) {\r\n    let handle = setTimeout(callback.bind(context), 0);\r\n    return { dispose() { clearTimeout(handle); } };\r\n});\r\nclass MutableToken {\r\n    constructor() {\r\n        this._isCancelled = false;\r\n    }\r\n    cancel() {\r\n        if (!this._isCancelled) {\r\n            this._isCancelled = true;\r\n            if (this._emitter) {\r\n                this._emitter.fire(undefined);\r\n                this.dispose();\r\n            }\r\n        }\r\n    }\r\n    get isCancellationRequested() {\r\n        return this._isCancelled;\r\n    }\r\n    get onCancellationRequested() {\r\n        if (this._isCancelled) {\r\n            return shortcutEvent;\r\n        }\r\n        if (!this._emitter) {\r\n            this._emitter = new events_1.Emitter();\r\n        }\r\n        return this._emitter.event;\r\n    }\r\n    dispose() {\r\n        if (this._emitter) {\r\n            this._emitter.dispose();\r\n            this._emitter = undefined;\r\n        }\r\n    }\r\n}\r\nclass CancellationTokenSource {\r\n    get token() {\r\n        if (!this._token) {\r\n            // be lazy and create the token only when\r\n            // actually needed\r\n            this._token = new MutableToken();\r\n        }\r\n        return this._token;\r\n    }\r\n    cancel() {\r\n        if (!this._token) {\r\n            // save an object by returning the default\r\n            // cancelled token when cancellation happens\r\n            // before someone asks for the token\r\n            this._token = CancellationToken.Cancelled;\r\n        }\r\n        else {\r\n            this._token.cancel();\r\n        }\r\n    }\r\n    dispose() {\r\n        if (!this._token) {\r\n            // ensure to initialize with an empty token if we had none\r\n            this._token = CancellationToken.None;\r\n        }\r\n        else if (this._token instanceof MutableToken) {\r\n            // actually dispose\r\n            this._token.dispose();\r\n        }\r\n    }\r\n}\r\nexports.CancellationTokenSource = CancellationTokenSource;\r\n","\"use strict\";\r\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Touch;\r\n(function (Touch) {\r\n    Touch.None = 0;\r\n    Touch.First = 1;\r\n    Touch.Last = 2;\r\n})(Touch = exports.Touch || (exports.Touch = {}));\r\nclass LinkedMap {\r\n    constructor() {\r\n        this._map = new Map();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n        this._size = 0;\r\n    }\r\n    clear() {\r\n        this._map.clear();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n        this._size = 0;\r\n    }\r\n    isEmpty() {\r\n        return !this._head && !this._tail;\r\n    }\r\n    get size() {\r\n        return this._size;\r\n    }\r\n    has(key) {\r\n        return this._map.has(key);\r\n    }\r\n    get(key) {\r\n        const item = this._map.get(key);\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        return item.value;\r\n    }\r\n    set(key, value, touch = Touch.None) {\r\n        let item = this._map.get(key);\r\n        if (item) {\r\n            item.value = value;\r\n            if (touch !== Touch.None) {\r\n                this.touch(item, touch);\r\n            }\r\n        }\r\n        else {\r\n            item = { key, value, next: undefined, previous: undefined };\r\n            switch (touch) {\r\n                case Touch.None:\r\n                    this.addItemLast(item);\r\n                    break;\r\n                case Touch.First:\r\n                    this.addItemFirst(item);\r\n                    break;\r\n                case Touch.Last:\r\n                    this.addItemLast(item);\r\n                    break;\r\n                default:\r\n                    this.addItemLast(item);\r\n                    break;\r\n            }\r\n            this._map.set(key, item);\r\n            this._size++;\r\n        }\r\n    }\r\n    delete(key) {\r\n        const item = this._map.get(key);\r\n        if (!item) {\r\n            return false;\r\n        }\r\n        this._map.delete(key);\r\n        this.removeItem(item);\r\n        this._size--;\r\n        return true;\r\n    }\r\n    shift() {\r\n        if (!this._head && !this._tail) {\r\n            return undefined;\r\n        }\r\n        if (!this._head || !this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        const item = this._head;\r\n        this._map.delete(item.key);\r\n        this.removeItem(item);\r\n        this._size--;\r\n        return item.value;\r\n    }\r\n    forEach(callbackfn, thisArg) {\r\n        let current = this._head;\r\n        while (current) {\r\n            if (thisArg) {\r\n                callbackfn.bind(thisArg)(current.value, current.key, this);\r\n            }\r\n            else {\r\n                callbackfn(current.value, current.key, this);\r\n            }\r\n            current = current.next;\r\n        }\r\n    }\r\n    forEachReverse(callbackfn, thisArg) {\r\n        let current = this._tail;\r\n        while (current) {\r\n            if (thisArg) {\r\n                callbackfn.bind(thisArg)(current.value, current.key, this);\r\n            }\r\n            else {\r\n                callbackfn(current.value, current.key, this);\r\n            }\r\n            current = current.previous;\r\n        }\r\n    }\r\n    values() {\r\n        let result = [];\r\n        let current = this._head;\r\n        while (current) {\r\n            result.push(current.value);\r\n            current = current.next;\r\n        }\r\n        return result;\r\n    }\r\n    keys() {\r\n        let result = [];\r\n        let current = this._head;\r\n        while (current) {\r\n            result.push(current.key);\r\n            current = current.next;\r\n        }\r\n        return result;\r\n    }\r\n    /* JSON RPC run on es5 which has no Symbol.iterator\r\n    public keys(): IterableIterator<K> {\r\n        let current = this._head;\r\n        let iterator: IterableIterator<K> = {\r\n            [Symbol.iterator]() {\r\n                return iterator;\r\n            },\r\n            next():IteratorResult<K> {\r\n                if (current) {\r\n                    let result = { value: current.key, done: false };\r\n                    current = current.next;\r\n                    return result;\r\n                } else {\r\n                    return { value: undefined, done: true };\r\n                }\r\n            }\r\n        };\r\n        return iterator;\r\n    }\r\n\r\n    public values(): IterableIterator<V> {\r\n        let current = this._head;\r\n        let iterator: IterableIterator<V> = {\r\n            [Symbol.iterator]() {\r\n                return iterator;\r\n            },\r\n            next():IteratorResult<V> {\r\n                if (current) {\r\n                    let result = { value: current.value, done: false };\r\n                    current = current.next;\r\n                    return result;\r\n                } else {\r\n                    return { value: undefined, done: true };\r\n                }\r\n            }\r\n        };\r\n        return iterator;\r\n    }\r\n    */\r\n    addItemFirst(item) {\r\n        // First time Insert\r\n        if (!this._head && !this._tail) {\r\n            this._tail = item;\r\n        }\r\n        else if (!this._head) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        else {\r\n            item.next = this._head;\r\n            this._head.previous = item;\r\n        }\r\n        this._head = item;\r\n    }\r\n    addItemLast(item) {\r\n        // First time Insert\r\n        if (!this._head && !this._tail) {\r\n            this._head = item;\r\n        }\r\n        else if (!this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        else {\r\n            item.previous = this._tail;\r\n            this._tail.next = item;\r\n        }\r\n        this._tail = item;\r\n    }\r\n    removeItem(item) {\r\n        if (item === this._head && item === this._tail) {\r\n            this._head = undefined;\r\n            this._tail = undefined;\r\n        }\r\n        else if (item === this._head) {\r\n            this._head = item.next;\r\n        }\r\n        else if (item === this._tail) {\r\n            this._tail = item.previous;\r\n        }\r\n        else {\r\n            const next = item.next;\r\n            const previous = item.previous;\r\n            if (!next || !previous) {\r\n                throw new Error('Invalid list');\r\n            }\r\n            next.previous = previous;\r\n            previous.next = next;\r\n        }\r\n    }\r\n    touch(item, touch) {\r\n        if (!this._head || !this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        if ((touch !== Touch.First && touch !== Touch.Last)) {\r\n            return;\r\n        }\r\n        if (touch === Touch.First) {\r\n            if (item === this._head) {\r\n                return;\r\n            }\r\n            const next = item.next;\r\n            const previous = item.previous;\r\n            // Unlink the item\r\n            if (item === this._tail) {\r\n                // previous must be defined since item was not head but is tail\r\n                // So there are more than on item in the map\r\n                previous.next = undefined;\r\n                this._tail = previous;\r\n            }\r\n            else {\r\n                // Both next and previous are not undefined since item was neither head nor tail.\r\n                next.previous = previous;\r\n                previous.next = next;\r\n            }\r\n            // Insert the node at head\r\n            item.previous = undefined;\r\n            item.next = this._head;\r\n            this._head.previous = item;\r\n            this._head = item;\r\n        }\r\n        else if (touch === Touch.Last) {\r\n            if (item === this._tail) {\r\n                return;\r\n            }\r\n            const next = item.next;\r\n            const previous = item.previous;\r\n            // Unlink the item.\r\n            if (item === this._head) {\r\n                // next must be defined since item was not tail but is head\r\n                // So there are more than on item in the map\r\n                next.previous = undefined;\r\n                this._head = next;\r\n            }\r\n            else {\r\n                // Both next and previous are not undefined since item was neither head nor tail.\r\n                next.previous = previous;\r\n                previous.next = next;\r\n            }\r\n            item.next = undefined;\r\n            item.previous = this._tail;\r\n            this._tail.next = item;\r\n            this._tail = item;\r\n        }\r\n    }\r\n}\r\nexports.LinkedMap = LinkedMap;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst path_1 = require(\"path\");\r\nconst os_1 = require(\"os\");\r\nconst crypto_1 = require(\"crypto\");\r\nconst net_1 = require(\"net\");\r\nconst messageReader_1 = require(\"./messageReader\");\r\nconst messageWriter_1 = require(\"./messageWriter\");\r\nfunction generateRandomPipeName() {\r\n    const randomSuffix = crypto_1.randomBytes(21).toString('hex');\r\n    if (process.platform === 'win32') {\r\n        return `\\\\\\\\.\\\\pipe\\\\vscode-jsonrpc-${randomSuffix}-sock`;\r\n    }\r\n    else {\r\n        // Mac/Unix: use socket file\r\n        return path_1.join(os_1.tmpdir(), `vscode-${randomSuffix}.sock`);\r\n    }\r\n}\r\nexports.generateRandomPipeName = generateRandomPipeName;\r\nfunction createClientPipeTransport(pipeName, encoding = 'utf-8') {\r\n    let connectResolve;\r\n    let connected = new Promise((resolve, _reject) => {\r\n        connectResolve = resolve;\r\n    });\r\n    return new Promise((resolve, reject) => {\r\n        let server = net_1.createServer((socket) => {\r\n            server.close();\r\n            connectResolve([\r\n                new messageReader_1.SocketMessageReader(socket, encoding),\r\n                new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n            ]);\r\n        });\r\n        server.on('error', reject);\r\n        server.listen(pipeName, () => {\r\n            server.removeListener('error', reject);\r\n            resolve({\r\n                onConnected: () => { return connected; }\r\n            });\r\n        });\r\n    });\r\n}\r\nexports.createClientPipeTransport = createClientPipeTransport;\r\nfunction createServerPipeTransport(pipeName, encoding = 'utf-8') {\r\n    const socket = net_1.createConnection(pipeName);\r\n    return [\r\n        new messageReader_1.SocketMessageReader(socket, encoding),\r\n        new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n    ];\r\n}\r\nexports.createServerPipeTransport = createServerPipeTransport;\r\n","module.exports = require(\"crypto\");","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst net_1 = require(\"net\");\r\nconst messageReader_1 = require(\"./messageReader\");\r\nconst messageWriter_1 = require(\"./messageWriter\");\r\nfunction createClientSocketTransport(port, encoding = 'utf-8') {\r\n    let connectResolve;\r\n    let connected = new Promise((resolve, _reject) => {\r\n        connectResolve = resolve;\r\n    });\r\n    return new Promise((resolve, reject) => {\r\n        let server = net_1.createServer((socket) => {\r\n            server.close();\r\n            connectResolve([\r\n                new messageReader_1.SocketMessageReader(socket, encoding),\r\n                new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n            ]);\r\n        });\r\n        server.on('error', reject);\r\n        server.listen(port, '127.0.0.1', () => {\r\n            server.removeListener('error', reject);\r\n            resolve({\r\n                onConnected: () => { return connected; }\r\n            });\r\n        });\r\n    });\r\n}\r\nexports.createClientSocketTransport = createClientSocketTransport;\r\nfunction createServerSocketTransport(port, encoding = 'utf-8') {\r\n    const socket = net_1.createConnection(port, '127.0.0.1');\r\n    return [\r\n        new messageReader_1.SocketMessageReader(socket, encoding),\r\n        new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n    ];\r\n}\r\nexports.createServerSocketTransport = createServerSocketTransport;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\n/**\r\n * The Position namespace provides helper functions to work with\r\n * [Position](#Position) literals.\r\n */\r\nexport var Position;\r\n(function (Position) {\r\n    /**\r\n     * Creates a new Position literal from the given line and character.\r\n     * @param line The position's line.\r\n     * @param character The position's character.\r\n     */\r\n    function create(line, character) {\r\n        return { line: line, character: character };\r\n    }\r\n    Position.create = create;\r\n    /**\r\n     * Checks whether the given liternal conforms to the [Position](#Position) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.objectLiteral(candidate) && Is.number(candidate.line) && Is.number(candidate.character);\r\n    }\r\n    Position.is = is;\r\n})(Position || (Position = {}));\r\n/**\r\n * The Range namespace provides helper functions to work with\r\n * [Range](#Range) literals.\r\n */\r\nexport var Range;\r\n(function (Range) {\r\n    function create(one, two, three, four) {\r\n        if (Is.number(one) && Is.number(two) && Is.number(three) && Is.number(four)) {\r\n            return { start: Position.create(one, two), end: Position.create(three, four) };\r\n        }\r\n        else if (Position.is(one) && Position.is(two)) {\r\n            return { start: one, end: two };\r\n        }\r\n        else {\r\n            throw new Error(\"Range#create called with invalid arguments[\" + one + \", \" + two + \", \" + three + \", \" + four + \"]\");\r\n        }\r\n    }\r\n    Range.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Range](#Range) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.objectLiteral(candidate) && Position.is(candidate.start) && Position.is(candidate.end);\r\n    }\r\n    Range.is = is;\r\n})(Range || (Range = {}));\r\n/**\r\n * The Location namespace provides helper functions to work with\r\n * [Location](#Location) literals.\r\n */\r\nexport var Location;\r\n(function (Location) {\r\n    /**\r\n     * Creates a Location literal.\r\n     * @param uri The location's uri.\r\n     * @param range The location's range.\r\n     */\r\n    function create(uri, range) {\r\n        return { uri: uri, range: range };\r\n    }\r\n    Location.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Location](#Location) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Range.is(candidate.range) && (Is.string(candidate.uri) || Is.undefined(candidate.uri));\r\n    }\r\n    Location.is = is;\r\n})(Location || (Location = {}));\r\n/**\r\n * The LocationLink namespace provides helper functions to work with\r\n * [LocationLink](#LocationLink) literals.\r\n */\r\nexport var LocationLink;\r\n(function (LocationLink) {\r\n    /**\r\n     * Creates a LocationLink literal.\r\n     * @param targetUri The definition's uri.\r\n     * @param targetRange The full range of the definition.\r\n     * @param targetSelectionRange The span of the symbol definition at the target.\r\n     * @param originSelectionRange The span of the symbol being defined in the originating source file.\r\n     */\r\n    function create(targetUri, targetRange, targetSelectionRange, originSelectionRange) {\r\n        return { targetUri: targetUri, targetRange: targetRange, targetSelectionRange: targetSelectionRange, originSelectionRange: originSelectionRange };\r\n    }\r\n    LocationLink.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [LocationLink](#LocationLink) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Range.is(candidate.targetRange) && Is.string(candidate.targetUri)\r\n            && (Range.is(candidate.targetSelectionRange) || Is.undefined(candidate.targetSelectionRange))\r\n            && (Range.is(candidate.originSelectionRange) || Is.undefined(candidate.originSelectionRange));\r\n    }\r\n    LocationLink.is = is;\r\n})(LocationLink || (LocationLink = {}));\r\n/**\r\n * The Color namespace provides helper functions to work with\r\n * [Color](#Color) literals.\r\n */\r\nexport var Color;\r\n(function (Color) {\r\n    /**\r\n     * Creates a new Color literal.\r\n     */\r\n    function create(red, green, blue, alpha) {\r\n        return {\r\n            red: red,\r\n            green: green,\r\n            blue: blue,\r\n            alpha: alpha,\r\n        };\r\n    }\r\n    Color.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Color](#Color) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.number(candidate.red)\r\n            && Is.number(candidate.green)\r\n            && Is.number(candidate.blue)\r\n            && Is.number(candidate.alpha);\r\n    }\r\n    Color.is = is;\r\n})(Color || (Color = {}));\r\n/**\r\n * The ColorInformation namespace provides helper functions to work with\r\n * [ColorInformation](#ColorInformation) literals.\r\n */\r\nexport var ColorInformation;\r\n(function (ColorInformation) {\r\n    /**\r\n     * Creates a new ColorInformation literal.\r\n     */\r\n    function create(range, color) {\r\n        return {\r\n            range: range,\r\n            color: color,\r\n        };\r\n    }\r\n    ColorInformation.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [ColorInformation](#ColorInformation) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Range.is(candidate.range) && Color.is(candidate.color);\r\n    }\r\n    ColorInformation.is = is;\r\n})(ColorInformation || (ColorInformation = {}));\r\n/**\r\n * The Color namespace provides helper functions to work with\r\n * [ColorPresentation](#ColorPresentation) literals.\r\n */\r\nexport var ColorPresentation;\r\n(function (ColorPresentation) {\r\n    /**\r\n     * Creates a new ColorInformation literal.\r\n     */\r\n    function create(label, textEdit, additionalTextEdits) {\r\n        return {\r\n            label: label,\r\n            textEdit: textEdit,\r\n            additionalTextEdits: additionalTextEdits,\r\n        };\r\n    }\r\n    ColorPresentation.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [ColorInformation](#ColorInformation) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.string(candidate.label)\r\n            && (Is.undefined(candidate.textEdit) || TextEdit.is(candidate))\r\n            && (Is.undefined(candidate.additionalTextEdits) || Is.typedArray(candidate.additionalTextEdits, TextEdit.is));\r\n    }\r\n    ColorPresentation.is = is;\r\n})(ColorPresentation || (ColorPresentation = {}));\r\n/**\r\n * Enum of known range kinds\r\n */\r\nexport var FoldingRangeKind;\r\n(function (FoldingRangeKind) {\r\n    /**\r\n     * Folding range for a comment\r\n     */\r\n    FoldingRangeKind[\"Comment\"] = \"comment\";\r\n    /**\r\n     * Folding range for a imports or includes\r\n     */\r\n    FoldingRangeKind[\"Imports\"] = \"imports\";\r\n    /**\r\n     * Folding range for a region (e.g. `#region`)\r\n     */\r\n    FoldingRangeKind[\"Region\"] = \"region\";\r\n})(FoldingRangeKind || (FoldingRangeKind = {}));\r\n/**\r\n * The folding range namespace provides helper functions to work with\r\n * [FoldingRange](#FoldingRange) literals.\r\n */\r\nexport var FoldingRange;\r\n(function (FoldingRange) {\r\n    /**\r\n     * Creates a new FoldingRange literal.\r\n     */\r\n    function create(startLine, endLine, startCharacter, endCharacter, kind) {\r\n        var result = {\r\n            startLine: startLine,\r\n            endLine: endLine\r\n        };\r\n        if (Is.defined(startCharacter)) {\r\n            result.startCharacter = startCharacter;\r\n        }\r\n        if (Is.defined(endCharacter)) {\r\n            result.endCharacter = endCharacter;\r\n        }\r\n        if (Is.defined(kind)) {\r\n            result.kind = kind;\r\n        }\r\n        return result;\r\n    }\r\n    FoldingRange.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [FoldingRange](#FoldingRange) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.number(candidate.startLine) && Is.number(candidate.startLine)\r\n            && (Is.undefined(candidate.startCharacter) || Is.number(candidate.startCharacter))\r\n            && (Is.undefined(candidate.endCharacter) || Is.number(candidate.endCharacter))\r\n            && (Is.undefined(candidate.kind) || Is.string(candidate.kind));\r\n    }\r\n    FoldingRange.is = is;\r\n})(FoldingRange || (FoldingRange = {}));\r\n/**\r\n * The DiagnosticRelatedInformation namespace provides helper functions to work with\r\n * [DiagnosticRelatedInformation](#DiagnosticRelatedInformation) literals.\r\n */\r\nexport var DiagnosticRelatedInformation;\r\n(function (DiagnosticRelatedInformation) {\r\n    /**\r\n     * Creates a new DiagnosticRelatedInformation literal.\r\n     */\r\n    function create(location, message) {\r\n        return {\r\n            location: location,\r\n            message: message\r\n        };\r\n    }\r\n    DiagnosticRelatedInformation.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [DiagnosticRelatedInformation](#DiagnosticRelatedInformation) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Location.is(candidate.location) && Is.string(candidate.message);\r\n    }\r\n    DiagnosticRelatedInformation.is = is;\r\n})(DiagnosticRelatedInformation || (DiagnosticRelatedInformation = {}));\r\n/**\r\n * The diagnostic's severity.\r\n */\r\nexport var DiagnosticSeverity;\r\n(function (DiagnosticSeverity) {\r\n    /**\r\n     * Reports an error.\r\n     */\r\n    DiagnosticSeverity.Error = 1;\r\n    /**\r\n     * Reports a warning.\r\n     */\r\n    DiagnosticSeverity.Warning = 2;\r\n    /**\r\n     * Reports an information.\r\n     */\r\n    DiagnosticSeverity.Information = 3;\r\n    /**\r\n     * Reports a hint.\r\n     */\r\n    DiagnosticSeverity.Hint = 4;\r\n})(DiagnosticSeverity || (DiagnosticSeverity = {}));\r\nexport var DiagnosticTag;\r\n(function (DiagnosticTag) {\r\n    /**\r\n     * Unused or unnecessary code.\r\n     *\r\n     * Clients are allowed to render diagnostics with this tag faded out instead of having\r\n     * an error squiggle.\r\n     */\r\n    DiagnosticTag.Unnecessary = 1;\r\n})(DiagnosticTag || (DiagnosticTag = {}));\r\n/**\r\n * The Diagnostic namespace provides helper functions to work with\r\n * [Diagnostic](#Diagnostic) literals.\r\n */\r\nexport var Diagnostic;\r\n(function (Diagnostic) {\r\n    /**\r\n     * Creates a new Diagnostic literal.\r\n     */\r\n    function create(range, message, severity, code, source, relatedInformation) {\r\n        var result = { range: range, message: message };\r\n        if (Is.defined(severity)) {\r\n            result.severity = severity;\r\n        }\r\n        if (Is.defined(code)) {\r\n            result.code = code;\r\n        }\r\n        if (Is.defined(source)) {\r\n            result.source = source;\r\n        }\r\n        if (Is.defined(relatedInformation)) {\r\n            result.relatedInformation = relatedInformation;\r\n        }\r\n        return result;\r\n    }\r\n    Diagnostic.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Diagnostic](#Diagnostic) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate)\r\n            && Range.is(candidate.range)\r\n            && Is.string(candidate.message)\r\n            && (Is.number(candidate.severity) || Is.undefined(candidate.severity))\r\n            && (Is.number(candidate.code) || Is.string(candidate.code) || Is.undefined(candidate.code))\r\n            && (Is.string(candidate.source) || Is.undefined(candidate.source))\r\n            && (Is.undefined(candidate.relatedInformation) || Is.typedArray(candidate.relatedInformation, DiagnosticRelatedInformation.is));\r\n    }\r\n    Diagnostic.is = is;\r\n})(Diagnostic || (Diagnostic = {}));\r\n/**\r\n * The Command namespace provides helper functions to work with\r\n * [Command](#Command) literals.\r\n */\r\nexport var Command;\r\n(function (Command) {\r\n    /**\r\n     * Creates a new Command literal.\r\n     */\r\n    function create(title, command) {\r\n        var args = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            args[_i - 2] = arguments[_i];\r\n        }\r\n        var result = { title: title, command: command };\r\n        if (Is.defined(args) && args.length > 0) {\r\n            result.arguments = args;\r\n        }\r\n        return result;\r\n    }\r\n    Command.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Command](#Command) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.title) && Is.string(candidate.command);\r\n    }\r\n    Command.is = is;\r\n})(Command || (Command = {}));\r\n/**\r\n * The TextEdit namespace provides helper function to create replace,\r\n * insert and delete edits more easily.\r\n */\r\nexport var TextEdit;\r\n(function (TextEdit) {\r\n    /**\r\n     * Creates a replace text edit.\r\n     * @param range The range of text to be replaced.\r\n     * @param newText The new text.\r\n     */\r\n    function replace(range, newText) {\r\n        return { range: range, newText: newText };\r\n    }\r\n    TextEdit.replace = replace;\r\n    /**\r\n     * Creates a insert text edit.\r\n     * @param position The position to insert the text at.\r\n     * @param newText The text to be inserted.\r\n     */\r\n    function insert(position, newText) {\r\n        return { range: { start: position, end: position }, newText: newText };\r\n    }\r\n    TextEdit.insert = insert;\r\n    /**\r\n     * Creates a delete text edit.\r\n     * @param range The range of text to be deleted.\r\n     */\r\n    function del(range) {\r\n        return { range: range, newText: '' };\r\n    }\r\n    TextEdit.del = del;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.objectLiteral(candidate)\r\n            && Is.string(candidate.newText)\r\n            && Range.is(candidate.range);\r\n    }\r\n    TextEdit.is = is;\r\n})(TextEdit || (TextEdit = {}));\r\n/**\r\n * The TextDocumentEdit namespace provides helper function to create\r\n * an edit that manipulates a text document.\r\n */\r\nexport var TextDocumentEdit;\r\n(function (TextDocumentEdit) {\r\n    /**\r\n     * Creates a new `TextDocumentEdit`\r\n     */\r\n    function create(textDocument, edits) {\r\n        return { textDocument: textDocument, edits: edits };\r\n    }\r\n    TextDocumentEdit.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate)\r\n            && VersionedTextDocumentIdentifier.is(candidate.textDocument)\r\n            && Array.isArray(candidate.edits);\r\n    }\r\n    TextDocumentEdit.is = is;\r\n})(TextDocumentEdit || (TextDocumentEdit = {}));\r\nexport var CreateFile;\r\n(function (CreateFile) {\r\n    function create(uri, options) {\r\n        var result = {\r\n            kind: 'create',\r\n            uri: uri\r\n        };\r\n        if (options !== void 0 && (options.overwrite !== void 0 || options.ignoreIfExists !== void 0)) {\r\n            result.options = options;\r\n        }\r\n        return result;\r\n    }\r\n    CreateFile.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && candidate.kind === 'create' && Is.string(candidate.uri) &&\r\n            (candidate.options === void 0 ||\r\n                ((candidate.options.overwrite === void 0 || Is.boolean(candidate.options.overwrite)) && (candidate.options.ignoreIfExists === void 0 || Is.boolean(candidate.options.ignoreIfExists))));\r\n    }\r\n    CreateFile.is = is;\r\n})(CreateFile || (CreateFile = {}));\r\nexport var RenameFile;\r\n(function (RenameFile) {\r\n    function create(oldUri, newUri, options) {\r\n        var result = {\r\n            kind: 'rename',\r\n            oldUri: oldUri,\r\n            newUri: newUri\r\n        };\r\n        if (options !== void 0 && (options.overwrite !== void 0 || options.ignoreIfExists !== void 0)) {\r\n            result.options = options;\r\n        }\r\n        return result;\r\n    }\r\n    RenameFile.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && candidate.kind === 'rename' && Is.string(candidate.oldUri) && Is.string(candidate.newUri) &&\r\n            (candidate.options === void 0 ||\r\n                ((candidate.options.overwrite === void 0 || Is.boolean(candidate.options.overwrite)) && (candidate.options.ignoreIfExists === void 0 || Is.boolean(candidate.options.ignoreIfExists))));\r\n    }\r\n    RenameFile.is = is;\r\n})(RenameFile || (RenameFile = {}));\r\nexport var DeleteFile;\r\n(function (DeleteFile) {\r\n    function create(uri, options) {\r\n        var result = {\r\n            kind: 'delete',\r\n            uri: uri\r\n        };\r\n        if (options !== void 0 && (options.recursive !== void 0 || options.ignoreIfNotExists !== void 0)) {\r\n            result.options = options;\r\n        }\r\n        return result;\r\n    }\r\n    DeleteFile.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && candidate.kind === 'delete' && Is.string(candidate.uri) &&\r\n            (candidate.options === void 0 ||\r\n                ((candidate.options.recursive === void 0 || Is.boolean(candidate.options.recursive)) && (candidate.options.ignoreIfNotExists === void 0 || Is.boolean(candidate.options.ignoreIfNotExists))));\r\n    }\r\n    DeleteFile.is = is;\r\n})(DeleteFile || (DeleteFile = {}));\r\nexport var WorkspaceEdit;\r\n(function (WorkspaceEdit) {\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate &&\r\n            (candidate.changes !== void 0 || candidate.documentChanges !== void 0) &&\r\n            (candidate.documentChanges === void 0 || candidate.documentChanges.every(function (change) {\r\n                if (Is.string(change.kind)) {\r\n                    return CreateFile.is(change) || RenameFile.is(change) || DeleteFile.is(change);\r\n                }\r\n                else {\r\n                    return TextDocumentEdit.is(change);\r\n                }\r\n            }));\r\n    }\r\n    WorkspaceEdit.is = is;\r\n})(WorkspaceEdit || (WorkspaceEdit = {}));\r\nvar TextEditChangeImpl = /** @class */ (function () {\r\n    function TextEditChangeImpl(edits) {\r\n        this.edits = edits;\r\n    }\r\n    TextEditChangeImpl.prototype.insert = function (position, newText) {\r\n        this.edits.push(TextEdit.insert(position, newText));\r\n    };\r\n    TextEditChangeImpl.prototype.replace = function (range, newText) {\r\n        this.edits.push(TextEdit.replace(range, newText));\r\n    };\r\n    TextEditChangeImpl.prototype.delete = function (range) {\r\n        this.edits.push(TextEdit.del(range));\r\n    };\r\n    TextEditChangeImpl.prototype.add = function (edit) {\r\n        this.edits.push(edit);\r\n    };\r\n    TextEditChangeImpl.prototype.all = function () {\r\n        return this.edits;\r\n    };\r\n    TextEditChangeImpl.prototype.clear = function () {\r\n        this.edits.splice(0, this.edits.length);\r\n    };\r\n    return TextEditChangeImpl;\r\n}());\r\n/**\r\n * A workspace change helps constructing changes to a workspace.\r\n */\r\nvar WorkspaceChange = /** @class */ (function () {\r\n    function WorkspaceChange(workspaceEdit) {\r\n        var _this = this;\r\n        this._textEditChanges = Object.create(null);\r\n        if (workspaceEdit) {\r\n            this._workspaceEdit = workspaceEdit;\r\n            if (workspaceEdit.documentChanges) {\r\n                workspaceEdit.documentChanges.forEach(function (change) {\r\n                    if (TextDocumentEdit.is(change)) {\r\n                        var textEditChange = new TextEditChangeImpl(change.edits);\r\n                        _this._textEditChanges[change.textDocument.uri] = textEditChange;\r\n                    }\r\n                });\r\n            }\r\n            else if (workspaceEdit.changes) {\r\n                Object.keys(workspaceEdit.changes).forEach(function (key) {\r\n                    var textEditChange = new TextEditChangeImpl(workspaceEdit.changes[key]);\r\n                    _this._textEditChanges[key] = textEditChange;\r\n                });\r\n            }\r\n        }\r\n    }\r\n    Object.defineProperty(WorkspaceChange.prototype, \"edit\", {\r\n        /**\r\n         * Returns the underlying [WorkspaceEdit](#WorkspaceEdit) literal\r\n         * use to be returned from a workspace edit operation like rename.\r\n         */\r\n        get: function () {\r\n            return this._workspaceEdit;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    WorkspaceChange.prototype.getTextEditChange = function (key) {\r\n        if (VersionedTextDocumentIdentifier.is(key)) {\r\n            if (!this._workspaceEdit) {\r\n                this._workspaceEdit = {\r\n                    documentChanges: []\r\n                };\r\n            }\r\n            if (!this._workspaceEdit.documentChanges) {\r\n                throw new Error('Workspace edit is not configured for document changes.');\r\n            }\r\n            var textDocument = key;\r\n            var result = this._textEditChanges[textDocument.uri];\r\n            if (!result) {\r\n                var edits = [];\r\n                var textDocumentEdit = {\r\n                    textDocument: textDocument,\r\n                    edits: edits\r\n                };\r\n                this._workspaceEdit.documentChanges.push(textDocumentEdit);\r\n                result = new TextEditChangeImpl(edits);\r\n                this._textEditChanges[textDocument.uri] = result;\r\n            }\r\n            return result;\r\n        }\r\n        else {\r\n            if (!this._workspaceEdit) {\r\n                this._workspaceEdit = {\r\n                    changes: Object.create(null)\r\n                };\r\n            }\r\n            if (!this._workspaceEdit.changes) {\r\n                throw new Error('Workspace edit is not configured for normal text edit changes.');\r\n            }\r\n            var result = this._textEditChanges[key];\r\n            if (!result) {\r\n                var edits = [];\r\n                this._workspaceEdit.changes[key] = edits;\r\n                result = new TextEditChangeImpl(edits);\r\n                this._textEditChanges[key] = result;\r\n            }\r\n            return result;\r\n        }\r\n    };\r\n    WorkspaceChange.prototype.createFile = function (uri, options) {\r\n        this.checkDocumentChanges();\r\n        this._workspaceEdit.documentChanges.push(CreateFile.create(uri, options));\r\n    };\r\n    WorkspaceChange.prototype.renameFile = function (oldUri, newUri, options) {\r\n        this.checkDocumentChanges();\r\n        this._workspaceEdit.documentChanges.push(RenameFile.create(oldUri, newUri, options));\r\n    };\r\n    WorkspaceChange.prototype.deleteFile = function (uri, options) {\r\n        this.checkDocumentChanges();\r\n        this._workspaceEdit.documentChanges.push(DeleteFile.create(uri, options));\r\n    };\r\n    WorkspaceChange.prototype.checkDocumentChanges = function () {\r\n        if (!this._workspaceEdit || !this._workspaceEdit.documentChanges) {\r\n            throw new Error('Workspace edit is not configured for document changes.');\r\n        }\r\n    };\r\n    return WorkspaceChange;\r\n}());\r\nexport { WorkspaceChange };\r\n/**\r\n * The TextDocumentIdentifier namespace provides helper functions to work with\r\n * [TextDocumentIdentifier](#TextDocumentIdentifier) literals.\r\n */\r\nexport var TextDocumentIdentifier;\r\n(function (TextDocumentIdentifier) {\r\n    /**\r\n     * Creates a new TextDocumentIdentifier literal.\r\n     * @param uri The document's uri.\r\n     */\r\n    function create(uri) {\r\n        return { uri: uri };\r\n    }\r\n    TextDocumentIdentifier.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [TextDocumentIdentifier](#TextDocumentIdentifier) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.uri);\r\n    }\r\n    TextDocumentIdentifier.is = is;\r\n})(TextDocumentIdentifier || (TextDocumentIdentifier = {}));\r\n/**\r\n * The VersionedTextDocumentIdentifier namespace provides helper functions to work with\r\n * [VersionedTextDocumentIdentifier](#VersionedTextDocumentIdentifier) literals.\r\n */\r\nexport var VersionedTextDocumentIdentifier;\r\n(function (VersionedTextDocumentIdentifier) {\r\n    /**\r\n     * Creates a new VersionedTextDocumentIdentifier literal.\r\n     * @param uri The document's uri.\r\n     * @param uri The document's text.\r\n     */\r\n    function create(uri, version) {\r\n        return { uri: uri, version: version };\r\n    }\r\n    VersionedTextDocumentIdentifier.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [VersionedTextDocumentIdentifier](#VersionedTextDocumentIdentifier) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.uri) && (candidate.version === null || Is.number(candidate.version));\r\n    }\r\n    VersionedTextDocumentIdentifier.is = is;\r\n})(VersionedTextDocumentIdentifier || (VersionedTextDocumentIdentifier = {}));\r\n/**\r\n * The TextDocumentItem namespace provides helper functions to work with\r\n * [TextDocumentItem](#TextDocumentItem) literals.\r\n */\r\nexport var TextDocumentItem;\r\n(function (TextDocumentItem) {\r\n    /**\r\n     * Creates a new TextDocumentItem literal.\r\n     * @param uri The document's uri.\r\n     * @param languageId The document's language identifier.\r\n     * @param version The document's version number.\r\n     * @param text The document's text.\r\n     */\r\n    function create(uri, languageId, version, text) {\r\n        return { uri: uri, languageId: languageId, version: version, text: text };\r\n    }\r\n    TextDocumentItem.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [TextDocumentItem](#TextDocumentItem) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.uri) && Is.string(candidate.languageId) && Is.number(candidate.version) && Is.string(candidate.text);\r\n    }\r\n    TextDocumentItem.is = is;\r\n})(TextDocumentItem || (TextDocumentItem = {}));\r\n/**\r\n * Describes the content type that a client supports in various\r\n * result literals like `Hover`, `ParameterInfo` or `CompletionItem`.\r\n *\r\n * Please note that `MarkupKinds` must not start with a `$`. This kinds\r\n * are reserved for internal usage.\r\n */\r\nexport var MarkupKind;\r\n(function (MarkupKind) {\r\n    /**\r\n     * Plain text is supported as a content format\r\n     */\r\n    MarkupKind.PlainText = 'plaintext';\r\n    /**\r\n     * Markdown is supported as a content format\r\n     */\r\n    MarkupKind.Markdown = 'markdown';\r\n})(MarkupKind || (MarkupKind = {}));\r\n(function (MarkupKind) {\r\n    /**\r\n     * Checks whether the given value is a value of the [MarkupKind](#MarkupKind) type.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate === MarkupKind.PlainText || candidate === MarkupKind.Markdown;\r\n    }\r\n    MarkupKind.is = is;\r\n})(MarkupKind || (MarkupKind = {}));\r\nexport var MarkupContent;\r\n(function (MarkupContent) {\r\n    /**\r\n     * Checks whether the given value conforms to the [MarkupContent](#MarkupContent) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.objectLiteral(value) && MarkupKind.is(candidate.kind) && Is.string(candidate.value);\r\n    }\r\n    MarkupContent.is = is;\r\n})(MarkupContent || (MarkupContent = {}));\r\n/**\r\n * The kind of a completion entry.\r\n */\r\nexport var CompletionItemKind;\r\n(function (CompletionItemKind) {\r\n    CompletionItemKind.Text = 1;\r\n    CompletionItemKind.Method = 2;\r\n    CompletionItemKind.Function = 3;\r\n    CompletionItemKind.Constructor = 4;\r\n    CompletionItemKind.Field = 5;\r\n    CompletionItemKind.Variable = 6;\r\n    CompletionItemKind.Class = 7;\r\n    CompletionItemKind.Interface = 8;\r\n    CompletionItemKind.Module = 9;\r\n    CompletionItemKind.Property = 10;\r\n    CompletionItemKind.Unit = 11;\r\n    CompletionItemKind.Value = 12;\r\n    CompletionItemKind.Enum = 13;\r\n    CompletionItemKind.Keyword = 14;\r\n    CompletionItemKind.Snippet = 15;\r\n    CompletionItemKind.Color = 16;\r\n    CompletionItemKind.File = 17;\r\n    CompletionItemKind.Reference = 18;\r\n    CompletionItemKind.Folder = 19;\r\n    CompletionItemKind.EnumMember = 20;\r\n    CompletionItemKind.Constant = 21;\r\n    CompletionItemKind.Struct = 22;\r\n    CompletionItemKind.Event = 23;\r\n    CompletionItemKind.Operator = 24;\r\n    CompletionItemKind.TypeParameter = 25;\r\n})(CompletionItemKind || (CompletionItemKind = {}));\r\n/**\r\n * Defines whether the insert text in a completion item should be interpreted as\r\n * plain text or a snippet.\r\n */\r\nexport var InsertTextFormat;\r\n(function (InsertTextFormat) {\r\n    /**\r\n     * The primary text to be inserted is treated as a plain string.\r\n     */\r\n    InsertTextFormat.PlainText = 1;\r\n    /**\r\n     * The primary text to be inserted is treated as a snippet.\r\n     *\r\n     * A snippet can define tab stops and placeholders with `$1`, `$2`\r\n     * and `${3:foo}`. `$0` defines the final tab stop, it defaults to\r\n     * the end of the snippet. Placeholders with equal identifiers are linked,\r\n     * that is typing in one will update others too.\r\n     *\r\n     * See also: https://github.com/Microsoft/vscode/blob/master/src/vs/editor/contrib/snippet/common/snippet.md\r\n     */\r\n    InsertTextFormat.Snippet = 2;\r\n})(InsertTextFormat || (InsertTextFormat = {}));\r\n/**\r\n * The CompletionItem namespace provides functions to deal with\r\n * completion items.\r\n */\r\nexport var CompletionItem;\r\n(function (CompletionItem) {\r\n    /**\r\n     * Create a completion item and seed it with a label.\r\n     * @param label The completion item's label\r\n     */\r\n    function create(label) {\r\n        return { label: label };\r\n    }\r\n    CompletionItem.create = create;\r\n})(CompletionItem || (CompletionItem = {}));\r\n/**\r\n * The CompletionList namespace provides functions to deal with\r\n * completion lists.\r\n */\r\nexport var CompletionList;\r\n(function (CompletionList) {\r\n    /**\r\n     * Creates a new completion list.\r\n     *\r\n     * @param items The completion items.\r\n     * @param isIncomplete The list is not complete.\r\n     */\r\n    function create(items, isIncomplete) {\r\n        return { items: items ? items : [], isIncomplete: !!isIncomplete };\r\n    }\r\n    CompletionList.create = create;\r\n})(CompletionList || (CompletionList = {}));\r\nexport var MarkedString;\r\n(function (MarkedString) {\r\n    /**\r\n     * Creates a marked string from plain text.\r\n     *\r\n     * @param plainText The plain text.\r\n     */\r\n    function fromPlainText(plainText) {\r\n        return plainText.replace(/[\\\\`*_{}[\\]()#+\\-.!]/g, \"\\\\$&\"); // escape markdown syntax tokens: http://daringfireball.net/projects/markdown/syntax#backslash\r\n    }\r\n    MarkedString.fromPlainText = fromPlainText;\r\n    /**\r\n     * Checks whether the given value conforms to the [MarkedString](#MarkedString) type.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.string(candidate) || (Is.objectLiteral(candidate) && Is.string(candidate.language) && Is.string(candidate.value));\r\n    }\r\n    MarkedString.is = is;\r\n})(MarkedString || (MarkedString = {}));\r\nexport var Hover;\r\n(function (Hover) {\r\n    /**\r\n     * Checks whether the given value conforms to the [Hover](#Hover) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return !!candidate && Is.objectLiteral(candidate) && (MarkupContent.is(candidate.contents) ||\r\n            MarkedString.is(candidate.contents) ||\r\n            Is.typedArray(candidate.contents, MarkedString.is)) && (value.range === void 0 || Range.is(value.range));\r\n    }\r\n    Hover.is = is;\r\n})(Hover || (Hover = {}));\r\n/**\r\n * The ParameterInformation namespace provides helper functions to work with\r\n * [ParameterInformation](#ParameterInformation) literals.\r\n */\r\nexport var ParameterInformation;\r\n(function (ParameterInformation) {\r\n    /**\r\n     * Creates a new parameter information literal.\r\n     *\r\n     * @param label A label string.\r\n     * @param documentation A doc string.\r\n     */\r\n    function create(label, documentation) {\r\n        return documentation ? { label: label, documentation: documentation } : { label: label };\r\n    }\r\n    ParameterInformation.create = create;\r\n    ;\r\n})(ParameterInformation || (ParameterInformation = {}));\r\n/**\r\n * The SignatureInformation namespace provides helper functions to work with\r\n * [SignatureInformation](#SignatureInformation) literals.\r\n */\r\nexport var SignatureInformation;\r\n(function (SignatureInformation) {\r\n    function create(label, documentation) {\r\n        var parameters = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            parameters[_i - 2] = arguments[_i];\r\n        }\r\n        var result = { label: label };\r\n        if (Is.defined(documentation)) {\r\n            result.documentation = documentation;\r\n        }\r\n        if (Is.defined(parameters)) {\r\n            result.parameters = parameters;\r\n        }\r\n        else {\r\n            result.parameters = [];\r\n        }\r\n        return result;\r\n    }\r\n    SignatureInformation.create = create;\r\n})(SignatureInformation || (SignatureInformation = {}));\r\n/**\r\n * A document highlight kind.\r\n */\r\nexport var DocumentHighlightKind;\r\n(function (DocumentHighlightKind) {\r\n    /**\r\n     * A textual occurrence.\r\n     */\r\n    DocumentHighlightKind.Text = 1;\r\n    /**\r\n     * Read-access of a symbol, like reading a variable.\r\n     */\r\n    DocumentHighlightKind.Read = 2;\r\n    /**\r\n     * Write-access of a symbol, like writing to a variable.\r\n     */\r\n    DocumentHighlightKind.Write = 3;\r\n})(DocumentHighlightKind || (DocumentHighlightKind = {}));\r\n/**\r\n * DocumentHighlight namespace to provide helper functions to work with\r\n * [DocumentHighlight](#DocumentHighlight) literals.\r\n */\r\nexport var DocumentHighlight;\r\n(function (DocumentHighlight) {\r\n    /**\r\n     * Create a DocumentHighlight object.\r\n     * @param range The range the highlight applies to.\r\n     */\r\n    function create(range, kind) {\r\n        var result = { range: range };\r\n        if (Is.number(kind)) {\r\n            result.kind = kind;\r\n        }\r\n        return result;\r\n    }\r\n    DocumentHighlight.create = create;\r\n})(DocumentHighlight || (DocumentHighlight = {}));\r\n/**\r\n * A symbol kind.\r\n */\r\nexport var SymbolKind;\r\n(function (SymbolKind) {\r\n    SymbolKind.File = 1;\r\n    SymbolKind.Module = 2;\r\n    SymbolKind.Namespace = 3;\r\n    SymbolKind.Package = 4;\r\n    SymbolKind.Class = 5;\r\n    SymbolKind.Method = 6;\r\n    SymbolKind.Property = 7;\r\n    SymbolKind.Field = 8;\r\n    SymbolKind.Constructor = 9;\r\n    SymbolKind.Enum = 10;\r\n    SymbolKind.Interface = 11;\r\n    SymbolKind.Function = 12;\r\n    SymbolKind.Variable = 13;\r\n    SymbolKind.Constant = 14;\r\n    SymbolKind.String = 15;\r\n    SymbolKind.Number = 16;\r\n    SymbolKind.Boolean = 17;\r\n    SymbolKind.Array = 18;\r\n    SymbolKind.Object = 19;\r\n    SymbolKind.Key = 20;\r\n    SymbolKind.Null = 21;\r\n    SymbolKind.EnumMember = 22;\r\n    SymbolKind.Struct = 23;\r\n    SymbolKind.Event = 24;\r\n    SymbolKind.Operator = 25;\r\n    SymbolKind.TypeParameter = 26;\r\n})(SymbolKind || (SymbolKind = {}));\r\nexport var SymbolInformation;\r\n(function (SymbolInformation) {\r\n    /**\r\n     * Creates a new symbol information literal.\r\n     *\r\n     * @param name The name of the symbol.\r\n     * @param kind The kind of the symbol.\r\n     * @param range The range of the location of the symbol.\r\n     * @param uri The resource of the location of symbol, defaults to the current document.\r\n     * @param containerName The name of the symbol containing the symbol.\r\n     */\r\n    function create(name, kind, range, uri, containerName) {\r\n        var result = {\r\n            name: name,\r\n            kind: kind,\r\n            location: { uri: uri, range: range }\r\n        };\r\n        if (containerName) {\r\n            result.containerName = containerName;\r\n        }\r\n        return result;\r\n    }\r\n    SymbolInformation.create = create;\r\n})(SymbolInformation || (SymbolInformation = {}));\r\n/**\r\n * Represents programming constructs like variables, classes, interfaces etc.\r\n * that appear in a document. Document symbols can be hierarchical and they\r\n * have two ranges: one that encloses its definition and one that points to\r\n * its most interesting range, e.g. the range of an identifier.\r\n */\r\nvar DocumentSymbol = /** @class */ (function () {\r\n    function DocumentSymbol() {\r\n    }\r\n    return DocumentSymbol;\r\n}());\r\nexport { DocumentSymbol };\r\n(function (DocumentSymbol) {\r\n    /**\r\n     * Creates a new symbol information literal.\r\n     *\r\n     * @param name The name of the symbol.\r\n     * @param detail The detail of the symbol.\r\n     * @param kind The kind of the symbol.\r\n     * @param range The range of the symbol.\r\n     * @param selectionRange The selectionRange of the symbol.\r\n     * @param children Children of the symbol.\r\n     */\r\n    function create(name, detail, kind, range, selectionRange, children) {\r\n        var result = {\r\n            name: name,\r\n            detail: detail,\r\n            kind: kind,\r\n            range: range,\r\n            selectionRange: selectionRange\r\n        };\r\n        if (children !== void 0) {\r\n            result.children = children;\r\n        }\r\n        return result;\r\n    }\r\n    DocumentSymbol.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [DocumentSymbol](#DocumentSymbol) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate &&\r\n            Is.string(candidate.name) && Is.number(candidate.kind) &&\r\n            Range.is(candidate.range) && Range.is(candidate.selectionRange) &&\r\n            (candidate.detail === void 0 || Is.string(candidate.detail)) &&\r\n            (candidate.deprecated === void 0 || Is.boolean(candidate.deprecated)) &&\r\n            (candidate.children === void 0 || Array.isArray(candidate.children));\r\n    }\r\n    DocumentSymbol.is = is;\r\n})(DocumentSymbol || (DocumentSymbol = {}));\r\n/**\r\n * A set of predefined code action kinds\r\n */\r\nexport var CodeActionKind;\r\n(function (CodeActionKind) {\r\n    /**\r\n     * Empty kind.\r\n     */\r\n    CodeActionKind.Empty = '';\r\n    /**\r\n     * Base kind for quickfix actions: 'quickfix'\r\n     */\r\n    CodeActionKind.QuickFix = 'quickfix';\r\n    /**\r\n     * Base kind for refactoring actions: 'refactor'\r\n     */\r\n    CodeActionKind.Refactor = 'refactor';\r\n    /**\r\n     * Base kind for refactoring extraction actions: 'refactor.extract'\r\n     *\r\n     * Example extract actions:\r\n     *\r\n     * - Extract method\r\n     * - Extract function\r\n     * - Extract variable\r\n     * - Extract interface from class\r\n     * - ...\r\n     */\r\n    CodeActionKind.RefactorExtract = 'refactor.extract';\r\n    /**\r\n     * Base kind for refactoring inline actions: 'refactor.inline'\r\n     *\r\n     * Example inline actions:\r\n     *\r\n     * - Inline function\r\n     * - Inline variable\r\n     * - Inline constant\r\n     * - ...\r\n     */\r\n    CodeActionKind.RefactorInline = 'refactor.inline';\r\n    /**\r\n     * Base kind for refactoring rewrite actions: 'refactor.rewrite'\r\n     *\r\n     * Example rewrite actions:\r\n     *\r\n     * - Convert JavaScript function to class\r\n     * - Add or remove parameter\r\n     * - Encapsulate field\r\n     * - Make method static\r\n     * - Move method to base class\r\n     * - ...\r\n     */\r\n    CodeActionKind.RefactorRewrite = 'refactor.rewrite';\r\n    /**\r\n     * Base kind for source actions: `source`\r\n     *\r\n     * Source code actions apply to the entire file.\r\n     */\r\n    CodeActionKind.Source = 'source';\r\n    /**\r\n     * Base kind for an organize imports source action: `source.organizeImports`\r\n     */\r\n    CodeActionKind.SourceOrganizeImports = 'source.organizeImports';\r\n})(CodeActionKind || (CodeActionKind = {}));\r\n/**\r\n * The CodeActionContext namespace provides helper functions to work with\r\n * [CodeActionContext](#CodeActionContext) literals.\r\n */\r\nexport var CodeActionContext;\r\n(function (CodeActionContext) {\r\n    /**\r\n     * Creates a new CodeActionContext literal.\r\n     */\r\n    function create(diagnostics, only) {\r\n        var result = { diagnostics: diagnostics };\r\n        if (only !== void 0 && only !== null) {\r\n            result.only = only;\r\n        }\r\n        return result;\r\n    }\r\n    CodeActionContext.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [CodeActionContext](#CodeActionContext) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.typedArray(candidate.diagnostics, Diagnostic.is) && (candidate.only === void 0 || Is.typedArray(candidate.only, Is.string));\r\n    }\r\n    CodeActionContext.is = is;\r\n})(CodeActionContext || (CodeActionContext = {}));\r\nexport var CodeAction;\r\n(function (CodeAction) {\r\n    function create(title, commandOrEdit, kind) {\r\n        var result = { title: title };\r\n        if (Command.is(commandOrEdit)) {\r\n            result.command = commandOrEdit;\r\n        }\r\n        else {\r\n            result.edit = commandOrEdit;\r\n        }\r\n        if (kind !== void null) {\r\n            result.kind = kind;\r\n        }\r\n        return result;\r\n    }\r\n    CodeAction.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && Is.string(candidate.title) &&\r\n            (candidate.diagnostics === void 0 || Is.typedArray(candidate.diagnostics, Diagnostic.is)) &&\r\n            (candidate.kind === void 0 || Is.string(candidate.kind)) &&\r\n            (candidate.edit !== void 0 || candidate.command !== void 0) &&\r\n            (candidate.command === void 0 || Command.is(candidate.command)) &&\r\n            (candidate.edit === void 0 || WorkspaceEdit.is(candidate.edit));\r\n    }\r\n    CodeAction.is = is;\r\n})(CodeAction || (CodeAction = {}));\r\n/**\r\n * The CodeLens namespace provides helper functions to work with\r\n * [CodeLens](#CodeLens) literals.\r\n */\r\nexport var CodeLens;\r\n(function (CodeLens) {\r\n    /**\r\n     * Creates a new CodeLens literal.\r\n     */\r\n    function create(range, data) {\r\n        var result = { range: range };\r\n        if (Is.defined(data))\r\n            result.data = data;\r\n        return result;\r\n    }\r\n    CodeLens.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [CodeLens](#CodeLens) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Range.is(candidate.range) && (Is.undefined(candidate.command) || Command.is(candidate.command));\r\n    }\r\n    CodeLens.is = is;\r\n})(CodeLens || (CodeLens = {}));\r\n/**\r\n * The FormattingOptions namespace provides helper functions to work with\r\n * [FormattingOptions](#FormattingOptions) literals.\r\n */\r\nexport var FormattingOptions;\r\n(function (FormattingOptions) {\r\n    /**\r\n     * Creates a new FormattingOptions literal.\r\n     */\r\n    function create(tabSize, insertSpaces) {\r\n        return { tabSize: tabSize, insertSpaces: insertSpaces };\r\n    }\r\n    FormattingOptions.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [FormattingOptions](#FormattingOptions) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.number(candidate.tabSize) && Is.boolean(candidate.insertSpaces);\r\n    }\r\n    FormattingOptions.is = is;\r\n})(FormattingOptions || (FormattingOptions = {}));\r\n/**\r\n * A document link is a range in a text document that links to an internal or external resource, like another\r\n * text document or a web site.\r\n */\r\nvar DocumentLink = /** @class */ (function () {\r\n    function DocumentLink() {\r\n    }\r\n    return DocumentLink;\r\n}());\r\nexport { DocumentLink };\r\n/**\r\n * The DocumentLink namespace provides helper functions to work with\r\n * [DocumentLink](#DocumentLink) literals.\r\n */\r\n(function (DocumentLink) {\r\n    /**\r\n     * Creates a new DocumentLink literal.\r\n     */\r\n    function create(range, target, data) {\r\n        return { range: range, target: target, data: data };\r\n    }\r\n    DocumentLink.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [DocumentLink](#DocumentLink) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Range.is(candidate.range) && (Is.undefined(candidate.target) || Is.string(candidate.target));\r\n    }\r\n    DocumentLink.is = is;\r\n})(DocumentLink || (DocumentLink = {}));\r\n/**\r\n * The SelectionRange namespace provides helper function to work with\r\n * SelectionRange literals.\r\n */\r\nexport var SelectionRange;\r\n(function (SelectionRange) {\r\n    /**\r\n     * Creates a new SelectionRange\r\n     * @param range the range.\r\n     * @param parent an optional parent.\r\n     */\r\n    function create(range, parent) {\r\n        return { range: range, parent: parent };\r\n    }\r\n    SelectionRange.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate !== undefined && Range.is(candidate.range) && (candidate.parent === undefined || SelectionRange.is(candidate.parent));\r\n    }\r\n    SelectionRange.is = is;\r\n})(SelectionRange || (SelectionRange = {}));\r\nexport var EOL = ['\\n', '\\r\\n', '\\r'];\r\nexport var TextDocument;\r\n(function (TextDocument) {\r\n    /**\r\n     * Creates a new ITextDocument literal from the given uri and content.\r\n     * @param uri The document's uri.\r\n     * @param languageId  The document's language Id.\r\n     * @param content The document's content.\r\n     */\r\n    function create(uri, languageId, version, content) {\r\n        return new FullTextDocument(uri, languageId, version, content);\r\n    }\r\n    TextDocument.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [ITextDocument](#ITextDocument) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.uri) && (Is.undefined(candidate.languageId) || Is.string(candidate.languageId)) && Is.number(candidate.lineCount)\r\n            && Is.func(candidate.getText) && Is.func(candidate.positionAt) && Is.func(candidate.offsetAt) ? true : false;\r\n    }\r\n    TextDocument.is = is;\r\n    function applyEdits(document, edits) {\r\n        var text = document.getText();\r\n        var sortedEdits = mergeSort(edits, function (a, b) {\r\n            var diff = a.range.start.line - b.range.start.line;\r\n            if (diff === 0) {\r\n                return a.range.start.character - b.range.start.character;\r\n            }\r\n            return diff;\r\n        });\r\n        var lastModifiedOffset = text.length;\r\n        for (var i = sortedEdits.length - 1; i >= 0; i--) {\r\n            var e = sortedEdits[i];\r\n            var startOffset = document.offsetAt(e.range.start);\r\n            var endOffset = document.offsetAt(e.range.end);\r\n            if (endOffset <= lastModifiedOffset) {\r\n                text = text.substring(0, startOffset) + e.newText + text.substring(endOffset, text.length);\r\n            }\r\n            else {\r\n                throw new Error('Overlapping edit');\r\n            }\r\n            lastModifiedOffset = startOffset;\r\n        }\r\n        return text;\r\n    }\r\n    TextDocument.applyEdits = applyEdits;\r\n    function mergeSort(data, compare) {\r\n        if (data.length <= 1) {\r\n            // sorted\r\n            return data;\r\n        }\r\n        var p = (data.length / 2) | 0;\r\n        var left = data.slice(0, p);\r\n        var right = data.slice(p);\r\n        mergeSort(left, compare);\r\n        mergeSort(right, compare);\r\n        var leftIdx = 0;\r\n        var rightIdx = 0;\r\n        var i = 0;\r\n        while (leftIdx < left.length && rightIdx < right.length) {\r\n            var ret = compare(left[leftIdx], right[rightIdx]);\r\n            if (ret <= 0) {\r\n                // smaller_equal -> take left to preserve order\r\n                data[i++] = left[leftIdx++];\r\n            }\r\n            else {\r\n                // greater -> take right\r\n                data[i++] = right[rightIdx++];\r\n            }\r\n        }\r\n        while (leftIdx < left.length) {\r\n            data[i++] = left[leftIdx++];\r\n        }\r\n        while (rightIdx < right.length) {\r\n            data[i++] = right[rightIdx++];\r\n        }\r\n        return data;\r\n    }\r\n})(TextDocument || (TextDocument = {}));\r\n/**\r\n * Represents reasons why a text document is saved.\r\n */\r\nexport var TextDocumentSaveReason;\r\n(function (TextDocumentSaveReason) {\r\n    /**\r\n     * Manually triggered, e.g. by the user pressing save, by starting debugging,\r\n     * or by an API call.\r\n     */\r\n    TextDocumentSaveReason.Manual = 1;\r\n    /**\r\n     * Automatic after a delay.\r\n     */\r\n    TextDocumentSaveReason.AfterDelay = 2;\r\n    /**\r\n     * When the editor lost focus.\r\n     */\r\n    TextDocumentSaveReason.FocusOut = 3;\r\n})(TextDocumentSaveReason || (TextDocumentSaveReason = {}));\r\nvar FullTextDocument = /** @class */ (function () {\r\n    function FullTextDocument(uri, languageId, version, content) {\r\n        this._uri = uri;\r\n        this._languageId = languageId;\r\n        this._version = version;\r\n        this._content = content;\r\n        this._lineOffsets = null;\r\n    }\r\n    Object.defineProperty(FullTextDocument.prototype, \"uri\", {\r\n        get: function () {\r\n            return this._uri;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FullTextDocument.prototype, \"languageId\", {\r\n        get: function () {\r\n            return this._languageId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FullTextDocument.prototype, \"version\", {\r\n        get: function () {\r\n            return this._version;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FullTextDocument.prototype.getText = function (range) {\r\n        if (range) {\r\n            var start = this.offsetAt(range.start);\r\n            var end = this.offsetAt(range.end);\r\n            return this._content.substring(start, end);\r\n        }\r\n        return this._content;\r\n    };\r\n    FullTextDocument.prototype.update = function (event, version) {\r\n        this._content = event.text;\r\n        this._version = version;\r\n        this._lineOffsets = null;\r\n    };\r\n    FullTextDocument.prototype.getLineOffsets = function () {\r\n        if (this._lineOffsets === null) {\r\n            var lineOffsets = [];\r\n            var text = this._content;\r\n            var isLineStart = true;\r\n            for (var i = 0; i < text.length; i++) {\r\n                if (isLineStart) {\r\n                    lineOffsets.push(i);\r\n                    isLineStart = false;\r\n                }\r\n                var ch = text.charAt(i);\r\n                isLineStart = (ch === '\\r' || ch === '\\n');\r\n                if (ch === '\\r' && i + 1 < text.length && text.charAt(i + 1) === '\\n') {\r\n                    i++;\r\n                }\r\n            }\r\n            if (isLineStart && text.length > 0) {\r\n                lineOffsets.push(text.length);\r\n            }\r\n            this._lineOffsets = lineOffsets;\r\n        }\r\n        return this._lineOffsets;\r\n    };\r\n    FullTextDocument.prototype.positionAt = function (offset) {\r\n        offset = Math.max(Math.min(offset, this._content.length), 0);\r\n        var lineOffsets = this.getLineOffsets();\r\n        var low = 0, high = lineOffsets.length;\r\n        if (high === 0) {\r\n            return Position.create(0, offset);\r\n        }\r\n        while (low < high) {\r\n            var mid = Math.floor((low + high) / 2);\r\n            if (lineOffsets[mid] > offset) {\r\n                high = mid;\r\n            }\r\n            else {\r\n                low = mid + 1;\r\n            }\r\n        }\r\n        // low is the least x for which the line offset is larger than the current offset\r\n        // or array.length if no line offset is larger than the current offset\r\n        var line = low - 1;\r\n        return Position.create(line, offset - lineOffsets[line]);\r\n    };\r\n    FullTextDocument.prototype.offsetAt = function (position) {\r\n        var lineOffsets = this.getLineOffsets();\r\n        if (position.line >= lineOffsets.length) {\r\n            return this._content.length;\r\n        }\r\n        else if (position.line < 0) {\r\n            return 0;\r\n        }\r\n        var lineOffset = lineOffsets[position.line];\r\n        var nextLineOffset = (position.line + 1 < lineOffsets.length) ? lineOffsets[position.line + 1] : this._content.length;\r\n        return Math.max(Math.min(lineOffset + position.character, nextLineOffset), lineOffset);\r\n    };\r\n    Object.defineProperty(FullTextDocument.prototype, \"lineCount\", {\r\n        get: function () {\r\n            return this.getLineOffsets().length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return FullTextDocument;\r\n}());\r\nvar Is;\r\n(function (Is) {\r\n    var toString = Object.prototype.toString;\r\n    function defined(value) {\r\n        return typeof value !== 'undefined';\r\n    }\r\n    Is.defined = defined;\r\n    function undefined(value) {\r\n        return typeof value === 'undefined';\r\n    }\r\n    Is.undefined = undefined;\r\n    function boolean(value) {\r\n        return value === true || value === false;\r\n    }\r\n    Is.boolean = boolean;\r\n    function string(value) {\r\n        return toString.call(value) === '[object String]';\r\n    }\r\n    Is.string = string;\r\n    function number(value) {\r\n        return toString.call(value) === '[object Number]';\r\n    }\r\n    Is.number = number;\r\n    function func(value) {\r\n        return toString.call(value) === '[object Function]';\r\n    }\r\n    Is.func = func;\r\n    function objectLiteral(value) {\r\n        // Strictly speaking class instances pass this check as well. Since the LSP\r\n        // doesn't use classes we ignore this for now. If we do we need to add something\r\n        // like this: `Object.getPrototypeOf(Object.getPrototypeOf(x)) === null`\r\n        return value !== null && typeof value === 'object';\r\n    }\r\n    Is.objectLiteral = objectLiteral;\r\n    function typedArray(value, check) {\r\n        return Array.isArray(value) && value.every(check);\r\n    }\r\n    Is.typedArray = typedArray;\r\n})(Is || (Is = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Is = require(\"./utils/is\");\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nconst protocol_implementation_1 = require(\"./protocol.implementation\");\r\nexports.ImplementationRequest = protocol_implementation_1.ImplementationRequest;\r\nconst protocol_typeDefinition_1 = require(\"./protocol.typeDefinition\");\r\nexports.TypeDefinitionRequest = protocol_typeDefinition_1.TypeDefinitionRequest;\r\nconst protocol_workspaceFolders_1 = require(\"./protocol.workspaceFolders\");\r\nexports.WorkspaceFoldersRequest = protocol_workspaceFolders_1.WorkspaceFoldersRequest;\r\nexports.DidChangeWorkspaceFoldersNotification = protocol_workspaceFolders_1.DidChangeWorkspaceFoldersNotification;\r\nconst protocol_configuration_1 = require(\"./protocol.configuration\");\r\nexports.ConfigurationRequest = protocol_configuration_1.ConfigurationRequest;\r\nconst protocol_colorProvider_1 = require(\"./protocol.colorProvider\");\r\nexports.DocumentColorRequest = protocol_colorProvider_1.DocumentColorRequest;\r\nexports.ColorPresentationRequest = protocol_colorProvider_1.ColorPresentationRequest;\r\nconst protocol_foldingRange_1 = require(\"./protocol.foldingRange\");\r\nexports.FoldingRangeRequest = protocol_foldingRange_1.FoldingRangeRequest;\r\nconst protocol_declaration_1 = require(\"./protocol.declaration\");\r\nexports.DeclarationRequest = protocol_declaration_1.DeclarationRequest;\r\nconst protocol_selectionRange_1 = require(\"./protocol.selectionRange\");\r\nexports.SelectionRangeRequest = protocol_selectionRange_1.SelectionRangeRequest;\r\n// @ts-ignore: to avoid inlining LocatioLink as dynamic import\r\nlet __noDynamicImport;\r\n/**\r\n * The DocumentFilter namespace provides helper functions to work with\r\n * [DocumentFilter](#DocumentFilter) literals.\r\n */\r\nvar DocumentFilter;\r\n(function (DocumentFilter) {\r\n    function is(value) {\r\n        const candidate = value;\r\n        return Is.string(candidate.language) || Is.string(candidate.scheme) || Is.string(candidate.pattern);\r\n    }\r\n    DocumentFilter.is = is;\r\n})(DocumentFilter = exports.DocumentFilter || (exports.DocumentFilter = {}));\r\n/**\r\n * The DocumentSelector namespace provides helper functions to work with\r\n * [DocumentSelector](#DocumentSelector)s.\r\n */\r\nvar DocumentSelector;\r\n(function (DocumentSelector) {\r\n    function is(value) {\r\n        if (!Array.isArray(value)) {\r\n            return false;\r\n        }\r\n        for (let elem of value) {\r\n            if (!Is.string(elem) && !DocumentFilter.is(elem)) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    DocumentSelector.is = is;\r\n})(DocumentSelector = exports.DocumentSelector || (exports.DocumentSelector = {}));\r\n/**\r\n * The `client/registerCapability` request is sent from the server to the client to register a new capability\r\n * handler on the client side.\r\n */\r\nvar RegistrationRequest;\r\n(function (RegistrationRequest) {\r\n    RegistrationRequest.type = new vscode_jsonrpc_1.RequestType('client/registerCapability');\r\n})(RegistrationRequest = exports.RegistrationRequest || (exports.RegistrationRequest = {}));\r\n/**\r\n * The `client/unregisterCapability` request is sent from the server to the client to unregister a previously registered capability\r\n * handler on the client side.\r\n */\r\nvar UnregistrationRequest;\r\n(function (UnregistrationRequest) {\r\n    UnregistrationRequest.type = new vscode_jsonrpc_1.RequestType('client/unregisterCapability');\r\n})(UnregistrationRequest = exports.UnregistrationRequest || (exports.UnregistrationRequest = {}));\r\nvar ResourceOperationKind;\r\n(function (ResourceOperationKind) {\r\n    /**\r\n     * Supports creating new files and folders.\r\n     */\r\n    ResourceOperationKind.Create = 'create';\r\n    /**\r\n     * Supports renaming existing files and folders.\r\n     */\r\n    ResourceOperationKind.Rename = 'rename';\r\n    /**\r\n     * Supports deleting existing files and folders.\r\n     */\r\n    ResourceOperationKind.Delete = 'delete';\r\n})(ResourceOperationKind = exports.ResourceOperationKind || (exports.ResourceOperationKind = {}));\r\nvar FailureHandlingKind;\r\n(function (FailureHandlingKind) {\r\n    /**\r\n     * Applying the workspace change is simply aborted if one of the changes provided\r\n     * fails. All operations executed before the failing operation stay executed.\r\n     */\r\n    FailureHandlingKind.Abort = 'abort';\r\n    /**\r\n     * All operations are executed transactional. That means they either all\r\n     * succeed or no changes at all are applied to the workspace.\r\n     */\r\n    FailureHandlingKind.Transactional = 'transactional';\r\n    /**\r\n     * If the workspace edit contains only textual file changes they are executed transactional.\r\n     * If resource changes (create, rename or delete file) are part of the change the failure\r\n     * handling startegy is abort.\r\n     */\r\n    FailureHandlingKind.TextOnlyTransactional = 'textOnlyTransactional';\r\n    /**\r\n     * The client tries to undo the operations already executed. But there is no\r\n     * guaruntee that this is succeeding.\r\n     */\r\n    FailureHandlingKind.Undo = 'undo';\r\n})(FailureHandlingKind = exports.FailureHandlingKind || (exports.FailureHandlingKind = {}));\r\n/**\r\n * Defines how the host (editor) should sync\r\n * document changes to the language server.\r\n */\r\nvar TextDocumentSyncKind;\r\n(function (TextDocumentSyncKind) {\r\n    /**\r\n     * Documents should not be synced at all.\r\n     */\r\n    TextDocumentSyncKind.None = 0;\r\n    /**\r\n     * Documents are synced by always sending the full content\r\n     * of the document.\r\n     */\r\n    TextDocumentSyncKind.Full = 1;\r\n    /**\r\n     * Documents are synced by sending the full content on open.\r\n     * After that only incremental updates to the document are\r\n     * send.\r\n     */\r\n    TextDocumentSyncKind.Incremental = 2;\r\n})(TextDocumentSyncKind = exports.TextDocumentSyncKind || (exports.TextDocumentSyncKind = {}));\r\n/**\r\n * The StaticRegistrationOptions namespace provides helper functions to work with\r\n * [StaticRegistrationOptions](#StaticRegistrationOptions) literals.\r\n */\r\nvar StaticRegistrationOptions;\r\n(function (StaticRegistrationOptions) {\r\n    function hasId(value) {\r\n        const candidate = value;\r\n        return candidate && Is.string(candidate.id) && candidate.id.length > 0;\r\n    }\r\n    StaticRegistrationOptions.hasId = hasId;\r\n})(StaticRegistrationOptions = exports.StaticRegistrationOptions || (exports.StaticRegistrationOptions = {}));\r\n/**\r\n * The TextDocumentRegistrationOptions namespace provides helper functions to work with\r\n * [TextDocumentRegistrationOptions](#TextDocumentRegistrationOptions) literals.\r\n */\r\nvar TextDocumentRegistrationOptions;\r\n(function (TextDocumentRegistrationOptions) {\r\n    function is(value) {\r\n        const candidate = value;\r\n        return candidate && (candidate.documentSelector === null || DocumentSelector.is(candidate.documentSelector));\r\n    }\r\n    TextDocumentRegistrationOptions.is = is;\r\n})(TextDocumentRegistrationOptions = exports.TextDocumentRegistrationOptions || (exports.TextDocumentRegistrationOptions = {}));\r\n/**\r\n * The WorkDoneProgressOptions namespace provides helper functions to work with\r\n * [WorkDoneProgressOptions](#WorkDoneProgressOptions) literals.\r\n */\r\nvar WorkDoneProgressOptions;\r\n(function (WorkDoneProgressOptions) {\r\n    function is(value) {\r\n        const candidate = value;\r\n        return Is.objectLiteral(candidate) && (candidate.workDoneProgress === undefined || Is.boolean(candidate.workDoneProgress));\r\n    }\r\n    WorkDoneProgressOptions.is = is;\r\n    function hasWorkDoneProgress(value) {\r\n        const candidate = value;\r\n        return candidate && Is.boolean(candidate.workDoneProgress);\r\n    }\r\n    WorkDoneProgressOptions.hasWorkDoneProgress = hasWorkDoneProgress;\r\n})(WorkDoneProgressOptions = exports.WorkDoneProgressOptions || (exports.WorkDoneProgressOptions = {}));\r\n/**\r\n * The initialize request is sent from the client to the server.\r\n * It is sent once as the request after starting up the server.\r\n * The requests parameter is of type [InitializeParams](#InitializeParams)\r\n * the response if of type [InitializeResult](#InitializeResult) of a Thenable that\r\n * resolves to such.\r\n */\r\nvar InitializeRequest;\r\n(function (InitializeRequest) {\r\n    InitializeRequest.type = new vscode_jsonrpc_1.RequestType('initialize');\r\n})(InitializeRequest = exports.InitializeRequest || (exports.InitializeRequest = {}));\r\n/**\r\n * Known error codes for an `InitializeError`;\r\n */\r\nvar InitializeError;\r\n(function (InitializeError) {\r\n    /**\r\n     * If the protocol version provided by the client can't be handled by the server.\r\n     * @deprecated This initialize error got replaced by client capabilities. There is\r\n     * no version handshake in version 3.0x\r\n     */\r\n    InitializeError.unknownProtocolVersion = 1;\r\n})(InitializeError = exports.InitializeError || (exports.InitializeError = {}));\r\n/**\r\n * The intialized notification is sent from the client to the\r\n * server after the client is fully initialized and the server\r\n * is allowed to send requests from the server to the client.\r\n */\r\nvar InitializedNotification;\r\n(function (InitializedNotification) {\r\n    InitializedNotification.type = new vscode_jsonrpc_1.NotificationType('initialized');\r\n})(InitializedNotification = exports.InitializedNotification || (exports.InitializedNotification = {}));\r\n//---- Shutdown Method ----\r\n/**\r\n * A shutdown request is sent from the client to the server.\r\n * It is sent once when the client decides to shutdown the\r\n * server. The only notification that is sent after a shutdown request\r\n * is the exit event.\r\n */\r\nvar ShutdownRequest;\r\n(function (ShutdownRequest) {\r\n    ShutdownRequest.type = new vscode_jsonrpc_1.RequestType0('shutdown');\r\n})(ShutdownRequest = exports.ShutdownRequest || (exports.ShutdownRequest = {}));\r\n//---- Exit Notification ----\r\n/**\r\n * The exit event is sent from the client to the server to\r\n * ask the server to exit its process.\r\n */\r\nvar ExitNotification;\r\n(function (ExitNotification) {\r\n    ExitNotification.type = new vscode_jsonrpc_1.NotificationType0('exit');\r\n})(ExitNotification = exports.ExitNotification || (exports.ExitNotification = {}));\r\n//---- Configuration notification ----\r\n/**\r\n * The configuration change notification is sent from the client to the server\r\n * when the client's configuration has changed. The notification contains\r\n * the changed configuration as defined by the language client.\r\n */\r\nvar DidChangeConfigurationNotification;\r\n(function (DidChangeConfigurationNotification) {\r\n    DidChangeConfigurationNotification.type = new vscode_jsonrpc_1.NotificationType('workspace/didChangeConfiguration');\r\n})(DidChangeConfigurationNotification = exports.DidChangeConfigurationNotification || (exports.DidChangeConfigurationNotification = {}));\r\n//---- Message show and log notifications ----\r\n/**\r\n * The message type\r\n */\r\nvar MessageType;\r\n(function (MessageType) {\r\n    /**\r\n     * An error message.\r\n     */\r\n    MessageType.Error = 1;\r\n    /**\r\n     * A warning message.\r\n     */\r\n    MessageType.Warning = 2;\r\n    /**\r\n     * An information message.\r\n     */\r\n    MessageType.Info = 3;\r\n    /**\r\n     * A log message.\r\n     */\r\n    MessageType.Log = 4;\r\n})(MessageType = exports.MessageType || (exports.MessageType = {}));\r\n/**\r\n * The show message notification is sent from a server to a client to ask\r\n * the client to display a particular message in the user interface.\r\n */\r\nvar ShowMessageNotification;\r\n(function (ShowMessageNotification) {\r\n    ShowMessageNotification.type = new vscode_jsonrpc_1.NotificationType('window/showMessage');\r\n})(ShowMessageNotification = exports.ShowMessageNotification || (exports.ShowMessageNotification = {}));\r\n/**\r\n * The show message request is sent from the server to the client to show a message\r\n * and a set of options actions to the user.\r\n */\r\nvar ShowMessageRequest;\r\n(function (ShowMessageRequest) {\r\n    ShowMessageRequest.type = new vscode_jsonrpc_1.RequestType('window/showMessageRequest');\r\n})(ShowMessageRequest = exports.ShowMessageRequest || (exports.ShowMessageRequest = {}));\r\n/**\r\n * The log message notification is sent from the server to the client to ask\r\n * the client to log a particular message.\r\n */\r\nvar LogMessageNotification;\r\n(function (LogMessageNotification) {\r\n    LogMessageNotification.type = new vscode_jsonrpc_1.NotificationType('window/logMessage');\r\n})(LogMessageNotification = exports.LogMessageNotification || (exports.LogMessageNotification = {}));\r\n//---- Telemetry notification\r\n/**\r\n * The telemetry event notification is sent from the server to the client to ask\r\n * the client to log telemetry data.\r\n */\r\nvar TelemetryEventNotification;\r\n(function (TelemetryEventNotification) {\r\n    TelemetryEventNotification.type = new vscode_jsonrpc_1.NotificationType('telemetry/event');\r\n})(TelemetryEventNotification = exports.TelemetryEventNotification || (exports.TelemetryEventNotification = {}));\r\n/**\r\n * The document open notification is sent from the client to the server to signal\r\n * newly opened text documents. The document's truth is now managed by the client\r\n * and the server must not try to read the document's truth using the document's\r\n * uri. Open in this sense means it is managed by the client. It doesn't necessarily\r\n * mean that its content is presented in an editor. An open notification must not\r\n * be sent more than once without a corresponding close notification send before.\r\n * This means open and close notification must be balanced and the max open count\r\n * is one.\r\n */\r\nvar DidOpenTextDocumentNotification;\r\n(function (DidOpenTextDocumentNotification) {\r\n    DidOpenTextDocumentNotification.type = new vscode_jsonrpc_1.NotificationType('textDocument/didOpen');\r\n})(DidOpenTextDocumentNotification = exports.DidOpenTextDocumentNotification || (exports.DidOpenTextDocumentNotification = {}));\r\n/**\r\n * The document change notification is sent from the client to the server to signal\r\n * changes to a text document.\r\n */\r\nvar DidChangeTextDocumentNotification;\r\n(function (DidChangeTextDocumentNotification) {\r\n    DidChangeTextDocumentNotification.type = new vscode_jsonrpc_1.NotificationType('textDocument/didChange');\r\n})(DidChangeTextDocumentNotification = exports.DidChangeTextDocumentNotification || (exports.DidChangeTextDocumentNotification = {}));\r\n/**\r\n * The document close notification is sent from the client to the server when\r\n * the document got closed in the client. The document's truth now exists where\r\n * the document's uri points to (e.g. if the document's uri is a file uri the\r\n * truth now exists on disk). As with the open notification the close notification\r\n * is about managing the document's content. Receiving a close notification\r\n * doesn't mean that the document was open in an editor before. A close\r\n * notification requires a previous open notification to be sent.\r\n */\r\nvar DidCloseTextDocumentNotification;\r\n(function (DidCloseTextDocumentNotification) {\r\n    DidCloseTextDocumentNotification.type = new vscode_jsonrpc_1.NotificationType('textDocument/didClose');\r\n})(DidCloseTextDocumentNotification = exports.DidCloseTextDocumentNotification || (exports.DidCloseTextDocumentNotification = {}));\r\n/**\r\n * The document save notification is sent from the client to the server when\r\n * the document got saved in the client.\r\n */\r\nvar DidSaveTextDocumentNotification;\r\n(function (DidSaveTextDocumentNotification) {\r\n    DidSaveTextDocumentNotification.type = new vscode_jsonrpc_1.NotificationType('textDocument/didSave');\r\n})(DidSaveTextDocumentNotification = exports.DidSaveTextDocumentNotification || (exports.DidSaveTextDocumentNotification = {}));\r\n/**\r\n * A document will save notification is sent from the client to the server before\r\n * the document is actually saved.\r\n */\r\nvar WillSaveTextDocumentNotification;\r\n(function (WillSaveTextDocumentNotification) {\r\n    WillSaveTextDocumentNotification.type = new vscode_jsonrpc_1.NotificationType('textDocument/willSave');\r\n})(WillSaveTextDocumentNotification = exports.WillSaveTextDocumentNotification || (exports.WillSaveTextDocumentNotification = {}));\r\n/**\r\n * A document will save request is sent from the client to the server before\r\n * the document is actually saved. The request can return an array of TextEdits\r\n * which will be applied to the text document before it is saved. Please note that\r\n * clients might drop results if computing the text edits took too long or if a\r\n * server constantly fails on this request. This is done to keep the save fast and\r\n * reliable.\r\n */\r\nvar WillSaveTextDocumentWaitUntilRequest;\r\n(function (WillSaveTextDocumentWaitUntilRequest) {\r\n    WillSaveTextDocumentWaitUntilRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/willSaveWaitUntil');\r\n})(WillSaveTextDocumentWaitUntilRequest = exports.WillSaveTextDocumentWaitUntilRequest || (exports.WillSaveTextDocumentWaitUntilRequest = {}));\r\n//---- File eventing ----\r\n/**\r\n * The watched files notification is sent from the client to the server when\r\n * the client detects changes to file watched by the language client.\r\n */\r\nvar DidChangeWatchedFilesNotification;\r\n(function (DidChangeWatchedFilesNotification) {\r\n    DidChangeWatchedFilesNotification.type = new vscode_jsonrpc_1.NotificationType('workspace/didChangeWatchedFiles');\r\n})(DidChangeWatchedFilesNotification = exports.DidChangeWatchedFilesNotification || (exports.DidChangeWatchedFilesNotification = {}));\r\n/**\r\n * The file event type\r\n */\r\nvar FileChangeType;\r\n(function (FileChangeType) {\r\n    /**\r\n     * The file got created.\r\n     */\r\n    FileChangeType.Created = 1;\r\n    /**\r\n     * The file got changed.\r\n     */\r\n    FileChangeType.Changed = 2;\r\n    /**\r\n     * The file got deleted.\r\n     */\r\n    FileChangeType.Deleted = 3;\r\n})(FileChangeType = exports.FileChangeType || (exports.FileChangeType = {}));\r\nvar WatchKind;\r\n(function (WatchKind) {\r\n    /**\r\n     * Interested in create events.\r\n     */\r\n    WatchKind.Create = 1;\r\n    /**\r\n     * Interested in change events\r\n     */\r\n    WatchKind.Change = 2;\r\n    /**\r\n     * Interested in delete events\r\n     */\r\n    WatchKind.Delete = 4;\r\n})(WatchKind = exports.WatchKind || (exports.WatchKind = {}));\r\n//---- Diagnostic notification ----\r\n/**\r\n * Diagnostics notification are sent from the server to the client to signal\r\n * results of validation runs.\r\n */\r\nvar PublishDiagnosticsNotification;\r\n(function (PublishDiagnosticsNotification) {\r\n    PublishDiagnosticsNotification.type = new vscode_jsonrpc_1.NotificationType('textDocument/publishDiagnostics');\r\n})(PublishDiagnosticsNotification = exports.PublishDiagnosticsNotification || (exports.PublishDiagnosticsNotification = {}));\r\n//---- Completion Support --------------------------\r\n/**\r\n * How a completion was triggered\r\n */\r\nvar CompletionTriggerKind;\r\n(function (CompletionTriggerKind) {\r\n    /**\r\n     * Completion was triggered by typing an identifier (24x7 code\r\n     * complete), manual invocation (e.g Ctrl+Space) or via API.\r\n     */\r\n    CompletionTriggerKind.Invoked = 1;\r\n    /**\r\n     * Completion was triggered by a trigger character specified by\r\n     * the `triggerCharacters` properties of the `CompletionRegistrationOptions`.\r\n     */\r\n    CompletionTriggerKind.TriggerCharacter = 2;\r\n    /**\r\n     * Completion was re-triggered as current completion list is incomplete\r\n     */\r\n    CompletionTriggerKind.TriggerForIncompleteCompletions = 3;\r\n})(CompletionTriggerKind = exports.CompletionTriggerKind || (exports.CompletionTriggerKind = {}));\r\n/**\r\n * Request to request completion at a given text document position. The request's\r\n * parameter is of type [TextDocumentPosition](#TextDocumentPosition) the response\r\n * is of type [CompletionItem[]](#CompletionItem) or [CompletionList](#CompletionList)\r\n * or a Thenable that resolves to such.\r\n *\r\n * The request can delay the computation of the [`detail`](#CompletionItem.detail)\r\n * and [`documentation`](#CompletionItem.documentation) properties to the `completionItem/resolve`\r\n * request. However, properties that are needed for the initial sorting and filtering, like `sortText`,\r\n * `filterText`, `insertText`, and `textEdit`, must not be changed during resolve.\r\n */\r\nvar CompletionRequest;\r\n(function (CompletionRequest) {\r\n    CompletionRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/completion');\r\n    CompletionRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(CompletionRequest = exports.CompletionRequest || (exports.CompletionRequest = {}));\r\n/**\r\n * Request to resolve additional information for a given completion item.The request's\r\n * parameter is of type [CompletionItem](#CompletionItem) the response\r\n * is of type [CompletionItem](#CompletionItem) or a Thenable that resolves to such.\r\n */\r\nvar CompletionResolveRequest;\r\n(function (CompletionResolveRequest) {\r\n    CompletionResolveRequest.type = new vscode_jsonrpc_1.RequestType('completionItem/resolve');\r\n})(CompletionResolveRequest = exports.CompletionResolveRequest || (exports.CompletionResolveRequest = {}));\r\n/**\r\n * Request to request hover information at a given text document position. The request's\r\n * parameter is of type [TextDocumentPosition](#TextDocumentPosition) the response is of\r\n * type [Hover](#Hover) or a Thenable that resolves to such.\r\n */\r\nvar HoverRequest;\r\n(function (HoverRequest) {\r\n    HoverRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/hover');\r\n})(HoverRequest = exports.HoverRequest || (exports.HoverRequest = {}));\r\nvar SignatureHelpRequest;\r\n(function (SignatureHelpRequest) {\r\n    SignatureHelpRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/signatureHelp');\r\n})(SignatureHelpRequest = exports.SignatureHelpRequest || (exports.SignatureHelpRequest = {}));\r\n/**\r\n * A request to resolve the definition location of a symbol at a given text\r\n * document position. The request's parameter is of type [TextDocumentPosition]\r\n * (#TextDocumentPosition) the response is of either type [Definition](#Definition)\r\n * or a typed array of [DefinitionLink](#DefinitionLink) or a Thenable that resolves\r\n * to such.\r\n */\r\nvar DefinitionRequest;\r\n(function (DefinitionRequest) {\r\n    DefinitionRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/definition');\r\n    DefinitionRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(DefinitionRequest = exports.DefinitionRequest || (exports.DefinitionRequest = {}));\r\n/**\r\n * A request to resolve project-wide references for the symbol denoted\r\n * by the given text document position. The request's parameter is of\r\n * type [ReferenceParams](#ReferenceParams) the response is of type\r\n * [Location[]](#Location) or a Thenable that resolves to such.\r\n */\r\nvar ReferencesRequest;\r\n(function (ReferencesRequest) {\r\n    ReferencesRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/references');\r\n    ReferencesRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(ReferencesRequest = exports.ReferencesRequest || (exports.ReferencesRequest = {}));\r\n/**\r\n * Request to resolve a [DocumentHighlight](#DocumentHighlight) for a given\r\n * text document position. The request's parameter is of type [TextDocumentPosition]\r\n * (#TextDocumentPosition) the request response is of type [DocumentHighlight[]]\r\n * (#DocumentHighlight) or a Thenable that resolves to such.\r\n */\r\nvar DocumentHighlightRequest;\r\n(function (DocumentHighlightRequest) {\r\n    DocumentHighlightRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/documentHighlight');\r\n    DocumentHighlightRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(DocumentHighlightRequest = exports.DocumentHighlightRequest || (exports.DocumentHighlightRequest = {}));\r\n/**\r\n * A request to list all symbols found in a given text document. The request's\r\n * parameter is of type [TextDocumentIdentifier](#TextDocumentIdentifier) the\r\n * response is of type [SymbolInformation[]](#SymbolInformation) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar DocumentSymbolRequest;\r\n(function (DocumentSymbolRequest) {\r\n    DocumentSymbolRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/documentSymbol');\r\n    DocumentSymbolRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(DocumentSymbolRequest = exports.DocumentSymbolRequest || (exports.DocumentSymbolRequest = {}));\r\n/**\r\n * A request to list project-wide symbols matching the query string given\r\n * by the [WorkspaceSymbolParams](#WorkspaceSymbolParams). The response is\r\n * of type [SymbolInformation[]](#SymbolInformation) or a Thenable that\r\n * resolves to such.\r\n */\r\nvar WorkspaceSymbolRequest;\r\n(function (WorkspaceSymbolRequest) {\r\n    WorkspaceSymbolRequest.type = new vscode_jsonrpc_1.RequestType('workspace/symbol');\r\n    WorkspaceSymbolRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(WorkspaceSymbolRequest = exports.WorkspaceSymbolRequest || (exports.WorkspaceSymbolRequest = {}));\r\n/**\r\n * A request to provide commands for the given text document and range.\r\n */\r\nvar CodeActionRequest;\r\n(function (CodeActionRequest) {\r\n    CodeActionRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/codeAction');\r\n    CodeActionRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(CodeActionRequest = exports.CodeActionRequest || (exports.CodeActionRequest = {}));\r\n/**\r\n * A request to provide code lens for the given text document.\r\n */\r\nvar CodeLensRequest;\r\n(function (CodeLensRequest) {\r\n    CodeLensRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/codeLens');\r\n    CodeLensRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(CodeLensRequest = exports.CodeLensRequest || (exports.CodeLensRequest = {}));\r\n/**\r\n * A request to resolve a command for a given code lens.\r\n */\r\nvar CodeLensResolveRequest;\r\n(function (CodeLensResolveRequest) {\r\n    CodeLensResolveRequest.type = new vscode_jsonrpc_1.RequestType('codeLens/resolve');\r\n})(CodeLensResolveRequest = exports.CodeLensResolveRequest || (exports.CodeLensResolveRequest = {}));\r\n/**\r\n * A request to to format a whole document.\r\n */\r\nvar DocumentFormattingRequest;\r\n(function (DocumentFormattingRequest) {\r\n    DocumentFormattingRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/formatting');\r\n})(DocumentFormattingRequest = exports.DocumentFormattingRequest || (exports.DocumentFormattingRequest = {}));\r\n/**\r\n * A request to to format a range in a document.\r\n */\r\nvar DocumentRangeFormattingRequest;\r\n(function (DocumentRangeFormattingRequest) {\r\n    DocumentRangeFormattingRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/rangeFormatting');\r\n})(DocumentRangeFormattingRequest = exports.DocumentRangeFormattingRequest || (exports.DocumentRangeFormattingRequest = {}));\r\n/**\r\n * A request to format a document on type.\r\n */\r\nvar DocumentOnTypeFormattingRequest;\r\n(function (DocumentOnTypeFormattingRequest) {\r\n    DocumentOnTypeFormattingRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/onTypeFormatting');\r\n})(DocumentOnTypeFormattingRequest = exports.DocumentOnTypeFormattingRequest || (exports.DocumentOnTypeFormattingRequest = {}));\r\n/**\r\n * A request to rename a symbol.\r\n */\r\nvar RenameRequest;\r\n(function (RenameRequest) {\r\n    RenameRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/rename');\r\n})(RenameRequest = exports.RenameRequest || (exports.RenameRequest = {}));\r\n/**\r\n * A request to test and perform the setup necessary for a rename.\r\n */\r\nvar PrepareRenameRequest;\r\n(function (PrepareRenameRequest) {\r\n    PrepareRenameRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/prepareRename');\r\n})(PrepareRenameRequest = exports.PrepareRenameRequest || (exports.PrepareRenameRequest = {}));\r\n/**\r\n * A request to provide document links\r\n */\r\nvar DocumentLinkRequest;\r\n(function (DocumentLinkRequest) {\r\n    DocumentLinkRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/documentLink');\r\n    DocumentLinkRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(DocumentLinkRequest = exports.DocumentLinkRequest || (exports.DocumentLinkRequest = {}));\r\n/**\r\n * Request to resolve additional information for a given document link. The request's\r\n * parameter is of type [DocumentLink](#DocumentLink) the response\r\n * is of type [DocumentLink](#DocumentLink) or a Thenable that resolves to such.\r\n */\r\nvar DocumentLinkResolveRequest;\r\n(function (DocumentLinkResolveRequest) {\r\n    DocumentLinkResolveRequest.type = new vscode_jsonrpc_1.RequestType('documentLink/resolve');\r\n})(DocumentLinkResolveRequest = exports.DocumentLinkResolveRequest || (exports.DocumentLinkResolveRequest = {}));\r\n/**\r\n * A request send from the client to the server to execute a command. The request might return\r\n * a workspace edit which the client will apply to the workspace.\r\n */\r\nvar ExecuteCommandRequest;\r\n(function (ExecuteCommandRequest) {\r\n    ExecuteCommandRequest.type = new vscode_jsonrpc_1.RequestType('workspace/executeCommand');\r\n})(ExecuteCommandRequest = exports.ExecuteCommandRequest || (exports.ExecuteCommandRequest = {}));\r\n/**\r\n * A request sent from the server to the client to modified certain resources.\r\n */\r\nvar ApplyWorkspaceEditRequest;\r\n(function (ApplyWorkspaceEditRequest) {\r\n    ApplyWorkspaceEditRequest.type = new vscode_jsonrpc_1.RequestType('workspace/applyEdit');\r\n})(ApplyWorkspaceEditRequest = exports.ApplyWorkspaceEditRequest || (exports.ApplyWorkspaceEditRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction boolean(value) {\r\n    return value === true || value === false;\r\n}\r\nexports.boolean = boolean;\r\nfunction string(value) {\r\n    return typeof value === 'string' || value instanceof String;\r\n}\r\nexports.string = string;\r\nfunction number(value) {\r\n    return typeof value === 'number' || value instanceof Number;\r\n}\r\nexports.number = number;\r\nfunction error(value) {\r\n    return value instanceof Error;\r\n}\r\nexports.error = error;\r\nfunction func(value) {\r\n    return typeof value === 'function';\r\n}\r\nexports.func = func;\r\nfunction array(value) {\r\n    return Array.isArray(value);\r\n}\r\nexports.array = array;\r\nfunction stringArray(value) {\r\n    return array(value) && value.every(elem => string(elem));\r\n}\r\nexports.stringArray = stringArray;\r\nfunction typedArray(value, check) {\r\n    return Array.isArray(value) && value.every(check);\r\n}\r\nexports.typedArray = typedArray;\r\nfunction thenable(value) {\r\n    return value && func(value.then);\r\n}\r\nexports.thenable = thenable;\r\nfunction objectLiteral(value) {\r\n    // Strictly speaking class instances pass this check as well. Since the LSP\r\n    // doesn't use classes we ignore this for now. If we do we need to add something\r\n    // like this: `Object.getPrototypeOf(Object.getPrototypeOf(x)) === null`\r\n    return value !== null && typeof value === 'object';\r\n}\r\nexports.objectLiteral = objectLiteral;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n// @ts-ignore: to avoid inlining LocatioLink as dynamic import\r\nlet __noDynamicImport;\r\n/**\r\n * A request to resolve the implementation locations of a symbol at a given text\r\n * document position. The request's parameter is of type [TextDocumentPositioParams]\r\n * (#TextDocumentPositionParams) the response is of type [Definition](#Definition) or a\r\n * Thenable that resolves to such.\r\n */\r\nvar ImplementationRequest;\r\n(function (ImplementationRequest) {\r\n    ImplementationRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/implementation');\r\n    ImplementationRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(ImplementationRequest = exports.ImplementationRequest || (exports.ImplementationRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n// @ts-ignore: to avoid inlining LocatioLink as dynamic import\r\nlet __noDynamicImport;\r\n/**\r\n * A request to resolve the type definition locations of a symbol at a given text\r\n * document position. The request's parameter is of type [TextDocumentPositioParams]\r\n * (#TextDocumentPositionParams) the response is of type [Definition](#Definition) or a\r\n * Thenable that resolves to such.\r\n */\r\nvar TypeDefinitionRequest;\r\n(function (TypeDefinitionRequest) {\r\n    TypeDefinitionRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/typeDefinition');\r\n    TypeDefinitionRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(TypeDefinitionRequest = exports.TypeDefinitionRequest || (exports.TypeDefinitionRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n/**\r\n * The `workspace/workspaceFolders` is sent from the server to the client to fetch the open workspace folders.\r\n */\r\nvar WorkspaceFoldersRequest;\r\n(function (WorkspaceFoldersRequest) {\r\n    WorkspaceFoldersRequest.type = new vscode_jsonrpc_1.RequestType0('workspace/workspaceFolders');\r\n})(WorkspaceFoldersRequest = exports.WorkspaceFoldersRequest || (exports.WorkspaceFoldersRequest = {}));\r\n/**\r\n * The `workspace/didChangeWorkspaceFolders` notification is sent from the client to the server when the workspace\r\n * folder configuration changes.\r\n */\r\nvar DidChangeWorkspaceFoldersNotification;\r\n(function (DidChangeWorkspaceFoldersNotification) {\r\n    DidChangeWorkspaceFoldersNotification.type = new vscode_jsonrpc_1.NotificationType('workspace/didChangeWorkspaceFolders');\r\n})(DidChangeWorkspaceFoldersNotification = exports.DidChangeWorkspaceFoldersNotification || (exports.DidChangeWorkspaceFoldersNotification = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n/**\r\n * The 'workspace/configuration' request is sent from the server to the client to fetch a certain\r\n * configuration setting.\r\n *\r\n * This pull model replaces the old push model were the client signaled configuration change via an\r\n * event. If the server still needs to react to configuration changes (since the server caches the\r\n * result of `workspace/configuration` requests) the server should register for an empty configuration\r\n * change event and empty the cache if such an event is received.\r\n */\r\nvar ConfigurationRequest;\r\n(function (ConfigurationRequest) {\r\n    ConfigurationRequest.type = new vscode_jsonrpc_1.RequestType('workspace/configuration');\r\n})(ConfigurationRequest = exports.ConfigurationRequest || (exports.ConfigurationRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n/**\r\n * A request to list all color symbols found in a given text document. The request's\r\n * parameter is of type [DocumentColorParams](#DocumentColorParams) the\r\n * response is of type [ColorInformation[]](#ColorInformation) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar DocumentColorRequest;\r\n(function (DocumentColorRequest) {\r\n    DocumentColorRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/documentColor');\r\n    DocumentColorRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(DocumentColorRequest = exports.DocumentColorRequest || (exports.DocumentColorRequest = {}));\r\n/**\r\n * A request to list all presentation for a color. The request's\r\n * parameter is of type [ColorPresentationParams](#ColorPresentationParams) the\r\n * response is of type [ColorInformation[]](#ColorInformation) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar ColorPresentationRequest;\r\n(function (ColorPresentationRequest) {\r\n    ColorPresentationRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/colorPresentation');\r\n})(ColorPresentationRequest = exports.ColorPresentationRequest || (exports.ColorPresentationRequest = {}));\r\n","\"use strict\";\r\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n/**\r\n * Enum of known range kinds\r\n */\r\nvar FoldingRangeKind;\r\n(function (FoldingRangeKind) {\r\n    /**\r\n     * Folding range for a comment\r\n     */\r\n    FoldingRangeKind[\"Comment\"] = \"comment\";\r\n    /**\r\n     * Folding range for a imports or includes\r\n     */\r\n    FoldingRangeKind[\"Imports\"] = \"imports\";\r\n    /**\r\n     * Folding range for a region (e.g. `#region`)\r\n     */\r\n    FoldingRangeKind[\"Region\"] = \"region\";\r\n})(FoldingRangeKind = exports.FoldingRangeKind || (exports.FoldingRangeKind = {}));\r\n/**\r\n * A request to provide folding ranges in a document. The request's\r\n * parameter is of type [FoldingRangeParams](#FoldingRangeParams), the\r\n * response is of type [FoldingRangeList](#FoldingRangeList) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar FoldingRangeRequest;\r\n(function (FoldingRangeRequest) {\r\n    FoldingRangeRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/foldingRange');\r\n    FoldingRangeRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(FoldingRangeRequest = exports.FoldingRangeRequest || (exports.FoldingRangeRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n// @ts-ignore: to avoid inlining LocatioLink as dynamic import\r\nlet __noDynamicImport;\r\n/**\r\n * A request to resolve the type definition locations of a symbol at a given text\r\n * document position. The request's parameter is of type [TextDocumentPositioParams]\r\n * (#TextDocumentPositionParams) the response is of type [Declaration](#Declaration)\r\n * or a typed array of [DeclarationLink](#DeclarationLink) or a Thenable that resolves\r\n * to such.\r\n */\r\nvar DeclarationRequest;\r\n(function (DeclarationRequest) {\r\n    DeclarationRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/declaration');\r\n    DeclarationRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(DeclarationRequest = exports.DeclarationRequest || (exports.DeclarationRequest = {}));\r\n","\"use strict\";\r\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n/**\r\n * A request to provide selection ranges in a document. The request's\r\n * parameter is of type [SelectionRangeParams](#SelectionRangeParams), the\r\n * response is of type [SelectionRange[]](#SelectionRange[]) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar SelectionRangeRequest;\r\n(function (SelectionRangeRequest) {\r\n    SelectionRangeRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/selectionRange');\r\n    SelectionRangeRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(SelectionRangeRequest = exports.SelectionRangeRequest || (exports.SelectionRangeRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) TypeFox and others. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n/**\r\n * The direction of a call hierarchy request.\r\n */\r\nvar CallHierarchyDirection;\r\n(function (CallHierarchyDirection) {\r\n    /**\r\n     * The callers\r\n     */\r\n    CallHierarchyDirection.CallsFrom = 1;\r\n    /**\r\n     * The callees\r\n     */\r\n    CallHierarchyDirection.CallsTo = 2;\r\n})(CallHierarchyDirection = exports.CallHierarchyDirection || (exports.CallHierarchyDirection = {}));\r\n/**\r\n * Request to provide the call hierarchy at a given text document position.\r\n *\r\n * The request's parameter is of type [CallHierarchyParams](#CallHierarchyParams). The response\r\n * is of type [CallHierarchyCall[]](#CallHierarchyCall) or a Thenable that resolves to such.\r\n *\r\n * Evaluates the symbol defined (or referenced) at the given position, and returns all incoming or outgoing calls to the symbol(s).\r\n */\r\nvar CallHierarchyRequest;\r\n(function (CallHierarchyRequest) {\r\n    CallHierarchyRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/callHierarchy');\r\n    CallHierarchyRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(CallHierarchyRequest = exports.CallHierarchyRequest || (exports.CallHierarchyRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nvar WorkDoneProgress;\r\n(function (WorkDoneProgress) {\r\n    WorkDoneProgress.type = new vscode_jsonrpc_1.ProgressType();\r\n})(WorkDoneProgress = exports.WorkDoneProgress || (exports.WorkDoneProgress = {}));\r\n/**\r\n * The `window/workDoneProgress/create` request is sent from the server to the client to initiate progress\r\n * reporting from the server.\r\n */\r\nvar WorkDoneProgressCreateRequest;\r\n(function (WorkDoneProgressCreateRequest) {\r\n    WorkDoneProgressCreateRequest.type = new vscode_jsonrpc_1.RequestType('window/workDoneProgress/create');\r\n})(WorkDoneProgressCreateRequest = exports.WorkDoneProgressCreateRequest || (exports.WorkDoneProgressCreateRequest = {}));\r\n/**\r\n * The `window/workDoneProgress/cancel` notification is sent from  the client to the server to cancel a progress\r\n * initiated on the server side.\r\n */\r\nvar WorkDoneProgressCancelNotification;\r\n(function (WorkDoneProgressCancelNotification) {\r\n    WorkDoneProgressCancelNotification.type = new vscode_jsonrpc_1.NotificationType('window/workDoneProgress/cancel');\r\n})(WorkDoneProgressCancelNotification = exports.WorkDoneProgressCancelNotification || (exports.WorkDoneProgressCancelNotification = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst Is = require(\"./utils/is\");\r\nexports.ConfigurationFeature = (Base) => {\r\n    return class extends Base {\r\n        getConfiguration(arg) {\r\n            if (!arg) {\r\n                return this._getConfiguration({});\r\n            }\r\n            else if (Is.string(arg)) {\r\n                return this._getConfiguration({ section: arg });\r\n            }\r\n            else {\r\n                return this._getConfiguration(arg);\r\n            }\r\n        }\r\n        _getConfiguration(arg) {\r\n            let params = {\r\n                items: Array.isArray(arg) ? arg : [arg]\r\n            };\r\n            return this.connection.sendRequest(vscode_languageserver_protocol_1.ConfigurationRequest.type, params).then((result) => {\r\n                return Array.isArray(arg) ? result : result[0];\r\n            });\r\n        }\r\n    };\r\n};\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nexports.WorkspaceFoldersFeature = (Base) => {\r\n    return class extends Base {\r\n        initialize(capabilities) {\r\n            let workspaceCapabilities = capabilities.workspace;\r\n            if (workspaceCapabilities && workspaceCapabilities.workspaceFolders) {\r\n                this._onDidChangeWorkspaceFolders = new vscode_languageserver_protocol_1.Emitter();\r\n                this.connection.onNotification(vscode_languageserver_protocol_1.DidChangeWorkspaceFoldersNotification.type, (params) => {\r\n                    this._onDidChangeWorkspaceFolders.fire(params.event);\r\n                });\r\n            }\r\n        }\r\n        getWorkspaceFolders() {\r\n            return this.connection.sendRequest(vscode_languageserver_protocol_1.WorkspaceFoldersRequest.type);\r\n        }\r\n        get onDidChangeWorkspaceFolders() {\r\n            if (!this._onDidChangeWorkspaceFolders) {\r\n                throw new Error('Client doesn\\'t support sending workspace folder change events.');\r\n            }\r\n            if (!this._unregistration) {\r\n                this._unregistration = this.connection.client.register(vscode_languageserver_protocol_1.DidChangeWorkspaceFoldersNotification.type);\r\n            }\r\n            return this._onDidChangeWorkspaceFolders.event;\r\n        }\r\n    };\r\n};\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst url = require(\"url\");\r\nconst path = require(\"path\");\r\nconst fs = require(\"fs\");\r\nconst child_process_1 = require(\"child_process\");\r\n/**\r\n * @deprecated Use the `vscode-uri` npm module which provides a more\r\n * complete implementation of handling VS Code URIs.\r\n */\r\nfunction uriToFilePath(uri) {\r\n    let parsed = url.parse(uri);\r\n    if (parsed.protocol !== 'file:' || !parsed.path) {\r\n        return undefined;\r\n    }\r\n    let segments = parsed.path.split('/');\r\n    for (var i = 0, len = segments.length; i < len; i++) {\r\n        segments[i] = decodeURIComponent(segments[i]);\r\n    }\r\n    if (process.platform === 'win32' && segments.length > 1) {\r\n        let first = segments[0];\r\n        let second = segments[1];\r\n        // Do we have a drive letter and we started with a / which is the\r\n        // case if the first segement is empty (see split above)\r\n        if (first.length === 0 && second.length > 1 && second[1] === ':') {\r\n            // Remove first slash\r\n            segments.shift();\r\n        }\r\n    }\r\n    return path.normalize(segments.join('/'));\r\n}\r\nexports.uriToFilePath = uriToFilePath;\r\nfunction isWindows() {\r\n    return process.platform === 'win32';\r\n}\r\nfunction resolve(moduleName, nodePath, cwd, tracer) {\r\n    const nodePathKey = 'NODE_PATH';\r\n    const app = [\r\n        \"var p = process;\",\r\n        \"p.on('message',function(m){\",\r\n        \"if(m.c==='e'){\",\r\n        \"p.exit(0);\",\r\n        \"}\",\r\n        \"else if(m.c==='rs'){\",\r\n        \"try{\",\r\n        \"var r=require.resolve(m.a);\",\r\n        \"p.send({c:'r',s:true,r:r});\",\r\n        \"}\",\r\n        \"catch(err){\",\r\n        \"p.send({c:'r',s:false});\",\r\n        \"}\",\r\n        \"}\",\r\n        \"});\"\r\n    ].join('');\r\n    return new Promise((resolve, reject) => {\r\n        let env = process.env;\r\n        let newEnv = Object.create(null);\r\n        Object.keys(env).forEach(key => newEnv[key] = env[key]);\r\n        if (nodePath) {\r\n            if (newEnv[nodePathKey]) {\r\n                newEnv[nodePathKey] = nodePath + path.delimiter + newEnv[nodePathKey];\r\n            }\r\n            else {\r\n                newEnv[nodePathKey] = nodePath;\r\n            }\r\n            if (tracer) {\r\n                tracer(`NODE_PATH value is: ${newEnv[nodePathKey]}`);\r\n            }\r\n        }\r\n        newEnv['ELECTRON_RUN_AS_NODE'] = '1';\r\n        try {\r\n            let cp = child_process_1.fork('', [], {\r\n                cwd: cwd,\r\n                env: newEnv,\r\n                execArgv: ['-e', app]\r\n            });\r\n            if (cp.pid === void 0) {\r\n                reject(new Error(`Starting process to resolve node module  ${moduleName} failed`));\r\n                return;\r\n            }\r\n            cp.on('error', (error) => {\r\n                reject(error);\r\n            });\r\n            cp.on('message', (message) => {\r\n                if (message.c === 'r') {\r\n                    cp.send({ c: 'e' });\r\n                    if (message.s) {\r\n                        resolve(message.r);\r\n                    }\r\n                    else {\r\n                        reject(new Error(`Failed to resolve module: ${moduleName}`));\r\n                    }\r\n                }\r\n            });\r\n            let message = {\r\n                c: 'rs',\r\n                a: moduleName\r\n            };\r\n            cp.send(message);\r\n        }\r\n        catch (error) {\r\n            reject(error);\r\n        }\r\n    });\r\n}\r\nexports.resolve = resolve;\r\nfunction resolveGlobalNodePath(tracer) {\r\n    let npmCommand = 'npm';\r\n    let options = {\r\n        encoding: 'utf8'\r\n    };\r\n    if (isWindows()) {\r\n        npmCommand = 'npm.cmd';\r\n        options.shell = true;\r\n    }\r\n    let handler = () => { };\r\n    try {\r\n        process.on('SIGPIPE', handler);\r\n        let stdout = child_process_1.spawnSync(npmCommand, ['config', 'get', 'prefix'], options).stdout;\r\n        if (!stdout) {\r\n            if (tracer) {\r\n                tracer(`'npm config get prefix' didn't return a value.`);\r\n            }\r\n            return undefined;\r\n        }\r\n        let prefix = stdout.trim();\r\n        if (tracer) {\r\n            tracer(`'npm config get prefix' value is: ${prefix}`);\r\n        }\r\n        if (prefix.length > 0) {\r\n            if (isWindows()) {\r\n                return path.join(prefix, 'node_modules');\r\n            }\r\n            else {\r\n                return path.join(prefix, 'lib', 'node_modules');\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    catch (err) {\r\n        return undefined;\r\n    }\r\n    finally {\r\n        process.removeListener('SIGPIPE', handler);\r\n    }\r\n}\r\nexports.resolveGlobalNodePath = resolveGlobalNodePath;\r\nfunction resolveGlobalYarnPath(tracer) {\r\n    let yarnCommand = 'yarn';\r\n    let options = {\r\n        encoding: 'utf8'\r\n    };\r\n    if (isWindows()) {\r\n        yarnCommand = 'yarn.cmd';\r\n        options.shell = true;\r\n    }\r\n    let handler = () => { };\r\n    try {\r\n        process.on('SIGPIPE', handler);\r\n        let results = child_process_1.spawnSync(yarnCommand, ['global', 'dir', '--json'], options);\r\n        let stdout = results.stdout;\r\n        if (!stdout) {\r\n            if (tracer) {\r\n                tracer(`'yarn global dir' didn't return a value.`);\r\n                if (results.stderr) {\r\n                    tracer(results.stderr);\r\n                }\r\n            }\r\n            return undefined;\r\n        }\r\n        let lines = stdout.trim().split(/\\r?\\n/);\r\n        for (let line of lines) {\r\n            try {\r\n                let yarn = JSON.parse(line);\r\n                if (yarn.type === 'log') {\r\n                    return path.join(yarn.data, 'node_modules');\r\n                }\r\n            }\r\n            catch (e) {\r\n                // Do nothing. Ignore the line\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    catch (err) {\r\n        return undefined;\r\n    }\r\n    finally {\r\n        process.removeListener('SIGPIPE', handler);\r\n    }\r\n}\r\nexports.resolveGlobalYarnPath = resolveGlobalYarnPath;\r\nvar FileSystem;\r\n(function (FileSystem) {\r\n    let _isCaseSensitive = undefined;\r\n    function isCaseSensitive() {\r\n        if (_isCaseSensitive !== void 0) {\r\n            return _isCaseSensitive;\r\n        }\r\n        if (process.platform === 'win32') {\r\n            _isCaseSensitive = false;\r\n        }\r\n        else {\r\n            // convert current file name to upper case / lower case and check if file exists\r\n            // (guards against cases when name is already all uppercase or lowercase)\r\n            _isCaseSensitive = !fs.existsSync(__filename.toUpperCase()) || !fs.existsSync(__filename.toLowerCase());\r\n        }\r\n        return _isCaseSensitive;\r\n    }\r\n    FileSystem.isCaseSensitive = isCaseSensitive;\r\n    function isParent(parent, child) {\r\n        if (isCaseSensitive()) {\r\n            return path.normalize(child).indexOf(path.normalize(parent)) === 0;\r\n        }\r\n        else {\r\n            return path.normalize(child).toLowerCase().indexOf(path.normalize(parent).toLowerCase()) == 0;\r\n        }\r\n    }\r\n    FileSystem.isParent = isParent;\r\n})(FileSystem = exports.FileSystem || (exports.FileSystem = {}));\r\nfunction resolveModulePath(workspaceRoot, moduleName, nodePath, tracer) {\r\n    if (nodePath) {\r\n        if (!path.isAbsolute(nodePath)) {\r\n            nodePath = path.join(workspaceRoot, nodePath);\r\n        }\r\n        return resolve(moduleName, nodePath, nodePath, tracer).then((value) => {\r\n            if (FileSystem.isParent(nodePath, value)) {\r\n                return value;\r\n            }\r\n            else {\r\n                return Promise.reject(new Error(`Failed to load ${moduleName} from node path location.`));\r\n            }\r\n        }).then(undefined, (_error) => {\r\n            return resolve(moduleName, resolveGlobalNodePath(tracer), workspaceRoot, tracer);\r\n        });\r\n    }\r\n    else {\r\n        return resolve(moduleName, resolveGlobalNodePath(tracer), workspaceRoot, tracer);\r\n    }\r\n}\r\nexports.resolveModulePath = resolveModulePath;\r\n","module.exports = require(\"url\");","module.exports = require(\"fs\");","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./pieceTreeBase\"));\n__export(require(\"./pieceTreeBuilder\"));\n","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass TreeNode {\n    constructor(piece, color) {\n        this.piece = piece;\n        this.color = color;\n        this.size_left = 0;\n        this.lf_left = 0;\n        this.parent = this;\n        this.left = this;\n        this.right = this;\n    }\n    next() {\n        if (this.right !== exports.SENTINEL) {\n            return leftest(this.right);\n        }\n        let node = this;\n        while (node.parent !== exports.SENTINEL) {\n            if (node.parent.left === node) {\n                break;\n            }\n            node = node.parent;\n        }\n        if (node.parent === exports.SENTINEL) {\n            return exports.SENTINEL;\n        }\n        else {\n            return node.parent;\n        }\n    }\n    prev() {\n        if (this.left !== exports.SENTINEL) {\n            return righttest(this.left);\n        }\n        let node = this;\n        while (node.parent !== exports.SENTINEL) {\n            if (node.parent.right === node) {\n                break;\n            }\n            node = node.parent;\n        }\n        if (node.parent === exports.SENTINEL) {\n            return exports.SENTINEL;\n        }\n        else {\n            return node.parent;\n        }\n    }\n    detach() {\n        this.parent = null;\n        this.left = null;\n        this.right = null;\n    }\n}\nexports.TreeNode = TreeNode;\nexports.SENTINEL = new TreeNode(null, 0 /* Black */);\nexports.SENTINEL.parent = exports.SENTINEL;\nexports.SENTINEL.left = exports.SENTINEL;\nexports.SENTINEL.right = exports.SENTINEL;\nexports.SENTINEL.color = 0 /* Black */;\nfunction leftest(node) {\n    while (node.left !== exports.SENTINEL) {\n        node = node.left;\n    }\n    return node;\n}\nexports.leftest = leftest;\nfunction righttest(node) {\n    while (node.right !== exports.SENTINEL) {\n        node = node.right;\n    }\n    return node;\n}\nexports.righttest = righttest;\nfunction calculateSize(node) {\n    if (node === exports.SENTINEL) {\n        return 0;\n    }\n    return node.size_left + node.piece.length + calculateSize(node.right);\n}\nexports.calculateSize = calculateSize;\nfunction calculateLF(node) {\n    if (node === exports.SENTINEL) {\n        return 0;\n    }\n    return node.lf_left + node.piece.lineFeedCnt + calculateLF(node.right);\n}\nexports.calculateLF = calculateLF;\nfunction resetSentinel() {\n    exports.SENTINEL.parent = exports.SENTINEL;\n}\nexports.resetSentinel = resetSentinel;\nfunction leftRotate(tree, x) {\n    let y = x.right;\n    // fix size_left\n    y.size_left += x.size_left + (x.piece ? x.piece.length : 0);\n    y.lf_left += x.lf_left + (x.piece ? x.piece.lineFeedCnt : 0);\n    x.right = y.left;\n    if (y.left !== exports.SENTINEL) {\n        y.left.parent = x;\n    }\n    y.parent = x.parent;\n    if (x.parent === exports.SENTINEL) {\n        tree.root = y;\n    }\n    else if (x.parent.left === x) {\n        x.parent.left = y;\n    }\n    else {\n        x.parent.right = y;\n    }\n    y.left = x;\n    x.parent = y;\n}\nexports.leftRotate = leftRotate;\nfunction rightRotate(tree, y) {\n    let x = y.left;\n    y.left = x.right;\n    if (x.right !== exports.SENTINEL) {\n        x.right.parent = y;\n    }\n    x.parent = y.parent;\n    // fix size_left\n    y.size_left -= x.size_left + (x.piece ? x.piece.length : 0);\n    y.lf_left -= x.lf_left + (x.piece ? x.piece.lineFeedCnt : 0);\n    if (y.parent === exports.SENTINEL) {\n        tree.root = x;\n    }\n    else if (y === y.parent.right) {\n        y.parent.right = x;\n    }\n    else {\n        y.parent.left = x;\n    }\n    x.right = y;\n    y.parent = x;\n}\nexports.rightRotate = rightRotate;\nfunction rbDelete(tree, z) {\n    let x;\n    let y;\n    if (z.left === exports.SENTINEL) {\n        y = z;\n        x = y.right;\n    }\n    else if (z.right === exports.SENTINEL) {\n        y = z;\n        x = y.left;\n    }\n    else {\n        y = leftest(z.right);\n        x = y.right;\n    }\n    if (y === tree.root) {\n        tree.root = x;\n        // if x is null, we are removing the only node\n        x.color = 0 /* Black */;\n        z.detach();\n        resetSentinel();\n        tree.root.parent = exports.SENTINEL;\n        return;\n    }\n    let yWasRed = (y.color === 1 /* Red */);\n    if (y === y.parent.left) {\n        y.parent.left = x;\n    }\n    else {\n        y.parent.right = x;\n    }\n    if (y === z) {\n        x.parent = y.parent;\n        recomputeTreeMetadata(tree, x);\n    }\n    else {\n        if (y.parent === z) {\n            x.parent = y;\n        }\n        else {\n            x.parent = y.parent;\n        }\n        // as we make changes to x's hierarchy, update size_left of subtree first\n        recomputeTreeMetadata(tree, x);\n        y.left = z.left;\n        y.right = z.right;\n        y.parent = z.parent;\n        y.color = z.color;\n        if (z === tree.root) {\n            tree.root = y;\n        }\n        else {\n            if (z === z.parent.left) {\n                z.parent.left = y;\n            }\n            else {\n                z.parent.right = y;\n            }\n        }\n        if (y.left !== exports.SENTINEL) {\n            y.left.parent = y;\n        }\n        if (y.right !== exports.SENTINEL) {\n            y.right.parent = y;\n        }\n        // update metadata\n        // we replace z with y, so in this sub tree, the length change is z.item.length\n        y.size_left = z.size_left;\n        y.lf_left = z.lf_left;\n        recomputeTreeMetadata(tree, y);\n    }\n    z.detach();\n    if (x.parent.left === x) {\n        let newSizeLeft = calculateSize(x);\n        let newLFLeft = calculateLF(x);\n        if (newSizeLeft !== x.parent.size_left || newLFLeft !== x.parent.lf_left) {\n            let delta = newSizeLeft - x.parent.size_left;\n            let lf_delta = newLFLeft - x.parent.lf_left;\n            x.parent.size_left = newSizeLeft;\n            x.parent.lf_left = newLFLeft;\n            updateTreeMetadata(tree, x.parent, delta, lf_delta);\n        }\n    }\n    recomputeTreeMetadata(tree, x.parent);\n    if (yWasRed) {\n        resetSentinel();\n        return;\n    }\n    // RB-DELETE-FIXUP\n    let w;\n    while (x !== tree.root && x.color === 0 /* Black */) {\n        if (x === x.parent.left) {\n            w = x.parent.right;\n            if (w.color === 1 /* Red */) {\n                w.color = 0 /* Black */;\n                x.parent.color = 1 /* Red */;\n                leftRotate(tree, x.parent);\n                w = x.parent.right;\n            }\n            if (w.left.color === 0 /* Black */ && w.right.color === 0 /* Black */) {\n                w.color = 1 /* Red */;\n                x = x.parent;\n            }\n            else {\n                if (w.right.color === 0 /* Black */) {\n                    w.left.color = 0 /* Black */;\n                    w.color = 1 /* Red */;\n                    rightRotate(tree, w);\n                    w = x.parent.right;\n                }\n                w.color = x.parent.color;\n                x.parent.color = 0 /* Black */;\n                w.right.color = 0 /* Black */;\n                leftRotate(tree, x.parent);\n                x = tree.root;\n            }\n        }\n        else {\n            w = x.parent.left;\n            if (w.color === 1 /* Red */) {\n                w.color = 0 /* Black */;\n                x.parent.color = 1 /* Red */;\n                rightRotate(tree, x.parent);\n                w = x.parent.left;\n            }\n            if (w.left.color === 0 /* Black */ && w.right.color === 0 /* Black */) {\n                w.color = 1 /* Red */;\n                x = x.parent;\n            }\n            else {\n                if (w.left.color === 0 /* Black */) {\n                    w.right.color = 0 /* Black */;\n                    w.color = 1 /* Red */;\n                    leftRotate(tree, w);\n                    w = x.parent.left;\n                }\n                w.color = x.parent.color;\n                x.parent.color = 0 /* Black */;\n                w.left.color = 0 /* Black */;\n                rightRotate(tree, x.parent);\n                x = tree.root;\n            }\n        }\n    }\n    x.color = 0 /* Black */;\n    resetSentinel();\n}\nexports.rbDelete = rbDelete;\nfunction fixInsert(tree, x) {\n    recomputeTreeMetadata(tree, x);\n    while (x !== tree.root && x.parent.color === 1 /* Red */) {\n        if (x.parent === x.parent.parent.left) {\n            const y = x.parent.parent.right;\n            if (y.color === 1 /* Red */) {\n                x.parent.color = 0 /* Black */;\n                y.color = 0 /* Black */;\n                x.parent.parent.color = 1 /* Red */;\n                x = x.parent.parent;\n            }\n            else {\n                if (x === x.parent.right) {\n                    x = x.parent;\n                    leftRotate(tree, x);\n                }\n                x.parent.color = 0 /* Black */;\n                x.parent.parent.color = 1 /* Red */;\n                rightRotate(tree, x.parent.parent);\n            }\n        }\n        else {\n            const y = x.parent.parent.left;\n            if (y.color === 1 /* Red */) {\n                x.parent.color = 0 /* Black */;\n                y.color = 0 /* Black */;\n                x.parent.parent.color = 1 /* Red */;\n                x = x.parent.parent;\n            }\n            else {\n                if (x === x.parent.left) {\n                    x = x.parent;\n                    rightRotate(tree, x);\n                }\n                x.parent.color = 0 /* Black */;\n                x.parent.parent.color = 1 /* Red */;\n                leftRotate(tree, x.parent.parent);\n            }\n        }\n    }\n    tree.root.color = 0 /* Black */;\n}\nexports.fixInsert = fixInsert;\nfunction updateTreeMetadata(tree, x, delta, lineFeedCntDelta) {\n    // node length change or line feed count change\n    while (x !== tree.root && x !== exports.SENTINEL) {\n        if (x.parent.left === x) {\n            x.parent.size_left += delta;\n            x.parent.lf_left += lineFeedCntDelta;\n        }\n        x = x.parent;\n    }\n}\nexports.updateTreeMetadata = updateTreeMetadata;\nfunction recomputeTreeMetadata(tree, x) {\n    let delta = 0;\n    let lf_delta = 0;\n    if (x === tree.root) {\n        return;\n    }\n    if (delta === 0) {\n        // go upwards till the node whose left subtree is changed.\n        while (x !== tree.root && x === x.parent.right) {\n            x = x.parent;\n        }\n        if (x === tree.root) {\n            // well, it means we add a node to the end (inorder)\n            return;\n        }\n        // x is the node whose right subtree is changed.\n        x = x.parent;\n        delta = calculateSize(x.left) - x.size_left;\n        lf_delta = calculateLF(x.left) - x.lf_left;\n        x.size_left += delta;\n        x.lf_left += lf_delta;\n    }\n    // go upwards till root. O(logN)\n    while (x !== tree.root && (delta !== 0 || lf_delta !== 0)) {\n        if (x.parent.left === x) {\n            x.parent.size_left += delta;\n            x.parent.lf_left += lf_delta;\n        }\n        x = x.parent;\n    }\n}\nexports.recomputeTreeMetadata = recomputeTreeMetadata;\n","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst pieceTreeBase_1 = require(\"./pieceTreeBase\");\nexports.UTF8_BOM_CHARACTER = String.fromCharCode(65279 /* UTF8_BOM */);\nfunction startsWithUTF8BOM(str) {\n    return !!(str && str.length > 0 && str.charCodeAt(0) === 65279 /* UTF8_BOM */);\n}\nexports.startsWithUTF8BOM = startsWithUTF8BOM;\nclass PieceTreeTextBufferFactory {\n    constructor(_chunks, _bom, _cr, _lf, _crlf, _normalizeEOL) {\n        this._chunks = _chunks;\n        this._bom = _bom;\n        this._cr = _cr;\n        this._lf = _lf;\n        this._crlf = _crlf;\n        this._normalizeEOL = _normalizeEOL;\n    }\n    _getEOL(defaultEOL) {\n        const totalEOLCount = this._cr + this._lf + this._crlf;\n        const totalCRCount = this._cr + this._crlf;\n        if (totalEOLCount === 0) {\n            // This is an empty file or a file with precisely one line\n            return (defaultEOL === 1 /* LF */ ? '\\n' : '\\r\\n');\n        }\n        if (totalCRCount > totalEOLCount / 2) {\n            // More than half of the file contains \\r\\n ending lines\n            return '\\r\\n';\n        }\n        // At least one line more ends in \\n\n        return '\\n';\n    }\n    create(defaultEOL) {\n        const eol = this._getEOL(defaultEOL);\n        let chunks = this._chunks;\n        if (this._normalizeEOL &&\n            ((eol === '\\r\\n' && (this._cr > 0 || this._lf > 0))\n                || (eol === '\\n' && (this._cr > 0 || this._crlf > 0)))) {\n            // Normalize pieces\n            for (let i = 0, len = chunks.length; i < len; i++) {\n                let str = chunks[i].buffer.replace(/\\r\\n|\\r|\\n/g, eol);\n                let newLineStart = pieceTreeBase_1.createLineStartsFast(str);\n                chunks[i] = new pieceTreeBase_1.StringBuffer(str, newLineStart);\n            }\n        }\n        return new pieceTreeBase_1.PieceTreeBase(chunks, eol, this._normalizeEOL);\n    }\n    getFirstLineText(lengthLimit) {\n        return this._chunks[0].buffer.substr(0, 100).split(/\\r\\n|\\r|\\n/)[0];\n    }\n}\nexports.PieceTreeTextBufferFactory = PieceTreeTextBufferFactory;\nclass PieceTreeTextBufferBuilder {\n    constructor() {\n        this.chunks = [];\n        this.BOM = '';\n        this._hasPreviousChar = false;\n        this._previousChar = 0;\n        this._tmpLineStarts = [];\n        this.cr = 0;\n        this.lf = 0;\n        this.crlf = 0;\n    }\n    acceptChunk(chunk) {\n        if (chunk.length === 0) {\n            return;\n        }\n        if (this.chunks.length === 0) {\n            if (startsWithUTF8BOM(chunk)) {\n                this.BOM = exports.UTF8_BOM_CHARACTER;\n                chunk = chunk.substr(1);\n            }\n        }\n        const lastChar = chunk.charCodeAt(chunk.length - 1);\n        if (lastChar === 13 /* CarriageReturn */ || (lastChar >= 0xD800 && lastChar <= 0xDBFF)) {\n            // last character is \\r or a high surrogate => keep it back\n            this._acceptChunk1(chunk.substr(0, chunk.length - 1), false);\n            this._hasPreviousChar = true;\n            this._previousChar = lastChar;\n        }\n        else {\n            this._acceptChunk1(chunk, false);\n            this._hasPreviousChar = false;\n            this._previousChar = lastChar;\n        }\n    }\n    _acceptChunk1(chunk, allowEmptyStrings) {\n        if (!allowEmptyStrings && chunk.length === 0) {\n            // Nothing to do\n            return;\n        }\n        if (this._hasPreviousChar) {\n            this._acceptChunk2(String.fromCharCode(this._previousChar) + chunk);\n        }\n        else {\n            this._acceptChunk2(chunk);\n        }\n    }\n    _acceptChunk2(chunk) {\n        const lineStarts = pieceTreeBase_1.createLineStarts(this._tmpLineStarts, chunk);\n        this.chunks.push(new pieceTreeBase_1.StringBuffer(chunk, lineStarts.lineStarts));\n        this.cr += lineStarts.cr;\n        this.lf += lineStarts.lf;\n        this.crlf += lineStarts.crlf;\n    }\n    finish(normalizeEOL = true) {\n        this._finish();\n        return new PieceTreeTextBufferFactory(this.chunks, this.BOM, this.cr, this.lf, this.crlf, normalizeEOL);\n    }\n    _finish() {\n        if (this.chunks.length === 0) {\n            this._acceptChunk1('', true);\n        }\n        if (this._hasPreviousChar) {\n            this._hasPreviousChar = false;\n            // recreate last chunk\n            let lastChunk = this.chunks[this.chunks.length - 1];\n            lastChunk.buffer += String.fromCharCode(this._previousChar);\n            let newLineStarts = pieceTreeBase_1.createLineStartsFast(lastChunk.buffer);\n            lastChunk.lineStarts = newLineStarts;\n            if (this._previousChar === 13 /* CarriageReturn */) {\n                this.cr++;\n            }\n        }\n    }\n}\nexports.PieceTreeTextBufferBuilder = PieceTreeTextBufferBuilder;\n","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst position_1 = require(\"./position\");\n/**\n * A range in the editor. (startLineNumber,startColumn) is <= (endLineNumber,endColumn)\n */\nclass Range {\n    constructor(startLineNumber, startColumn, endLineNumber, endColumn) {\n        if ((startLineNumber > endLineNumber) || (startLineNumber === endLineNumber && startColumn > endColumn)) {\n            this.startLineNumber = endLineNumber;\n            this.startColumn = endColumn;\n            this.endLineNumber = startLineNumber;\n            this.endColumn = startColumn;\n        }\n        else {\n            this.startLineNumber = startLineNumber;\n            this.startColumn = startColumn;\n            this.endLineNumber = endLineNumber;\n            this.endColumn = endColumn;\n        }\n    }\n    /**\n     * Test if this range is empty.\n     */\n    isEmpty() {\n        return Range.isEmpty(this);\n    }\n    /**\n     * Test if `range` is empty.\n     */\n    static isEmpty(range) {\n        return (range.startLineNumber === range.endLineNumber && range.startColumn === range.endColumn);\n    }\n    /**\n     * Test if position is in this range. If the position is at the edges, will return true.\n     */\n    containsPosition(position) {\n        return Range.containsPosition(this, position);\n    }\n    /**\n     * Test if `position` is in `range`. If the position is at the edges, will return true.\n     */\n    static containsPosition(range, position) {\n        if (position.lineNumber < range.startLineNumber || position.lineNumber > range.endLineNumber) {\n            return false;\n        }\n        if (position.lineNumber === range.startLineNumber && position.column < range.startColumn) {\n            return false;\n        }\n        if (position.lineNumber === range.endLineNumber && position.column > range.endColumn) {\n            return false;\n        }\n        return true;\n    }\n    /**\n     * Test if range is in this range. If the range is equal to this range, will return true.\n     */\n    containsRange(range) {\n        return Range.containsRange(this, range);\n    }\n    /**\n     * Test if `otherRange` is in `range`. If the ranges are equal, will return true.\n     */\n    static containsRange(range, otherRange) {\n        if (otherRange.startLineNumber < range.startLineNumber || otherRange.endLineNumber < range.startLineNumber) {\n            return false;\n        }\n        if (otherRange.startLineNumber > range.endLineNumber || otherRange.endLineNumber > range.endLineNumber) {\n            return false;\n        }\n        if (otherRange.startLineNumber === range.startLineNumber && otherRange.startColumn < range.startColumn) {\n            return false;\n        }\n        if (otherRange.endLineNumber === range.endLineNumber && otherRange.endColumn > range.endColumn) {\n            return false;\n        }\n        return true;\n    }\n    /**\n     * A reunion of the two ranges.\n     * The smallest position will be used as the start point, and the largest one as the end point.\n     */\n    plusRange(range) {\n        return Range.plusRange(this, range);\n    }\n    /**\n     * A reunion of the two ranges.\n     * The smallest position will be used as the start point, and the largest one as the end point.\n     */\n    static plusRange(a, b) {\n        let startLineNumber;\n        let startColumn;\n        let endLineNumber;\n        let endColumn;\n        if (b.startLineNumber < a.startLineNumber) {\n            startLineNumber = b.startLineNumber;\n            startColumn = b.startColumn;\n        }\n        else if (b.startLineNumber === a.startLineNumber) {\n            startLineNumber = b.startLineNumber;\n            startColumn = Math.min(b.startColumn, a.startColumn);\n        }\n        else {\n            startLineNumber = a.startLineNumber;\n            startColumn = a.startColumn;\n        }\n        if (b.endLineNumber > a.endLineNumber) {\n            endLineNumber = b.endLineNumber;\n            endColumn = b.endColumn;\n        }\n        else if (b.endLineNumber === a.endLineNumber) {\n            endLineNumber = b.endLineNumber;\n            endColumn = Math.max(b.endColumn, a.endColumn);\n        }\n        else {\n            endLineNumber = a.endLineNumber;\n            endColumn = a.endColumn;\n        }\n        return new Range(startLineNumber, startColumn, endLineNumber, endColumn);\n    }\n    /**\n     * A intersection of the two ranges.\n     */\n    intersectRanges(range) {\n        return Range.intersectRanges(this, range);\n    }\n    /**\n     * A intersection of the two ranges.\n     */\n    static intersectRanges(a, b) {\n        let resultStartLineNumber = a.startLineNumber;\n        let resultStartColumn = a.startColumn;\n        let resultEndLineNumber = a.endLineNumber;\n        let resultEndColumn = a.endColumn;\n        let otherStartLineNumber = b.startLineNumber;\n        let otherStartColumn = b.startColumn;\n        let otherEndLineNumber = b.endLineNumber;\n        let otherEndColumn = b.endColumn;\n        if (resultStartLineNumber < otherStartLineNumber) {\n            resultStartLineNumber = otherStartLineNumber;\n            resultStartColumn = otherStartColumn;\n        }\n        else if (resultStartLineNumber === otherStartLineNumber) {\n            resultStartColumn = Math.max(resultStartColumn, otherStartColumn);\n        }\n        if (resultEndLineNumber > otherEndLineNumber) {\n            resultEndLineNumber = otherEndLineNumber;\n            resultEndColumn = otherEndColumn;\n        }\n        else if (resultEndLineNumber === otherEndLineNumber) {\n            resultEndColumn = Math.min(resultEndColumn, otherEndColumn);\n        }\n        // Check if selection is now empty\n        if (resultStartLineNumber > resultEndLineNumber) {\n            return null;\n        }\n        if (resultStartLineNumber === resultEndLineNumber && resultStartColumn > resultEndColumn) {\n            return null;\n        }\n        return new Range(resultStartLineNumber, resultStartColumn, resultEndLineNumber, resultEndColumn);\n    }\n    /**\n     * Test if this range equals other.\n     */\n    equalsRange(other) {\n        return Range.equalsRange(this, other);\n    }\n    /**\n     * Test if range `a` equals `b`.\n     */\n    static equalsRange(a, b) {\n        return (!!a &&\n            !!b &&\n            a.startLineNumber === b.startLineNumber &&\n            a.startColumn === b.startColumn &&\n            a.endLineNumber === b.endLineNumber &&\n            a.endColumn === b.endColumn);\n    }\n    /**\n     * Return the end position (which will be after or equal to the start position)\n     */\n    getEndPosition() {\n        return new position_1.Position(this.endLineNumber, this.endColumn);\n    }\n    /**\n     * Return the start position (which will be before or equal to the end position)\n     */\n    getStartPosition() {\n        return new position_1.Position(this.startLineNumber, this.startColumn);\n    }\n    /**\n     * Transform to a user presentable string representation.\n     */\n    toString() {\n        return '[' + this.startLineNumber + ',' + this.startColumn + ' -> ' + this.endLineNumber + ',' + this.endColumn + ']';\n    }\n    /**\n     * Create a new range using this range's start position, and using endLineNumber and endColumn as the end position.\n     */\n    setEndPosition(endLineNumber, endColumn) {\n        return new Range(this.startLineNumber, this.startColumn, endLineNumber, endColumn);\n    }\n    /**\n     * Create a new range using this range's end position, and using startLineNumber and startColumn as the start position.\n     */\n    setStartPosition(startLineNumber, startColumn) {\n        return new Range(startLineNumber, startColumn, this.endLineNumber, this.endColumn);\n    }\n    /**\n     * Create a new empty range using this range's start position.\n     */\n    collapseToStart() {\n        return Range.collapseToStart(this);\n    }\n    /**\n     * Create a new empty range using this range's start position.\n     */\n    static collapseToStart(range) {\n        return new Range(range.startLineNumber, range.startColumn, range.startLineNumber, range.startColumn);\n    }\n    // ---\n    static fromPositions(start, end = start) {\n        return new Range(start.lineNumber, start.column, end.lineNumber, end.column);\n    }\n    static lift(range) {\n        if (!range) {\n            return null;\n        }\n        return new Range(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n    }\n    /**\n     * Test if `obj` is an `IRange`.\n     */\n    static isIRange(obj) {\n        return (obj\n            && (typeof obj.startLineNumber === 'number')\n            && (typeof obj.startColumn === 'number')\n            && (typeof obj.endLineNumber === 'number')\n            && (typeof obj.endColumn === 'number'));\n    }\n    /**\n     * Test if the two ranges are touching in any way.\n     */\n    static areIntersectingOrTouching(a, b) {\n        // Check if `a` is before `b`\n        if (a.endLineNumber < b.startLineNumber || (a.endLineNumber === b.startLineNumber && a.endColumn < b.startColumn)) {\n            return false;\n        }\n        // Check if `b` is before `a`\n        if (b.endLineNumber < a.startLineNumber || (b.endLineNumber === a.startLineNumber && b.endColumn < a.startColumn)) {\n            return false;\n        }\n        // These ranges must intersect\n        return true;\n    }\n    /**\n     * Test if the two ranges are intersecting. If the ranges are touching it returns true.\n     */\n    static areIntersecting(a, b) {\n        // Check if `a` is before `b`\n        if (a.endLineNumber < b.startLineNumber || (a.endLineNumber === b.startLineNumber && a.endColumn <= b.startColumn)) {\n            return false;\n        }\n        // Check if `b` is before `a`\n        if (b.endLineNumber < a.startLineNumber || (b.endLineNumber === a.startLineNumber && b.endColumn <= a.startColumn)) {\n            return false;\n        }\n        // These ranges must intersect\n        return true;\n    }\n    /**\n     * A function that compares ranges, useful for sorting ranges\n     * It will first compare ranges on the startPosition and then on the endPosition\n     */\n    static compareRangesUsingStarts(a, b) {\n        if (a && b) {\n            const aStartLineNumber = a.startLineNumber | 0;\n            const bStartLineNumber = b.startLineNumber | 0;\n            if (aStartLineNumber === bStartLineNumber) {\n                const aStartColumn = a.startColumn | 0;\n                const bStartColumn = b.startColumn | 0;\n                if (aStartColumn === bStartColumn) {\n                    const aEndLineNumber = a.endLineNumber | 0;\n                    const bEndLineNumber = b.endLineNumber | 0;\n                    if (aEndLineNumber === bEndLineNumber) {\n                        const aEndColumn = a.endColumn | 0;\n                        const bEndColumn = b.endColumn | 0;\n                        return aEndColumn - bEndColumn;\n                    }\n                    return aEndLineNumber - bEndLineNumber;\n                }\n                return aStartColumn - bStartColumn;\n            }\n            return aStartLineNumber - bStartLineNumber;\n        }\n        const aExists = (a ? 1 : 0);\n        const bExists = (b ? 1 : 0);\n        return aExists - bExists;\n    }\n    /**\n     * A function that compares ranges, useful for sorting ranges\n     * It will first compare ranges on the endPosition and then on the startPosition\n     */\n    static compareRangesUsingEnds(a, b) {\n        if (a.endLineNumber === b.endLineNumber) {\n            if (a.endColumn === b.endColumn) {\n                if (a.startLineNumber === b.startLineNumber) {\n                    return a.startColumn - b.startColumn;\n                }\n                return a.startLineNumber - b.startLineNumber;\n            }\n            return a.endColumn - b.endColumn;\n        }\n        return a.endLineNumber - b.endLineNumber;\n    }\n    /**\n     * Test if the range spans multiple lines.\n     */\n    static spansMultipleLines(range) {\n        return range.endLineNumber > range.startLineNumber;\n    }\n}\nexports.Range = Range;\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst uuid_1 = require(\"./utils/uuid\");\r\nclass WorkDoneProgressImpl {\r\n    constructor(_connection, _token) {\r\n        this._connection = _connection;\r\n        this._token = _token;\r\n        WorkDoneProgressImpl.Instances.set(this._token, this);\r\n        this._source = new vscode_languageserver_protocol_1.CancellationTokenSource();\r\n    }\r\n    get token() {\r\n        return this._source.token;\r\n    }\r\n    begin(title, percentage, message, cancellable) {\r\n        let param = {\r\n            kind: 'begin',\r\n            title,\r\n            percentage,\r\n            message,\r\n            cancellable\r\n        };\r\n        this._connection.sendProgress(vscode_languageserver_protocol_1.Proposed.WorkDoneProgress.type, this._token, param);\r\n    }\r\n    report(arg0, arg1) {\r\n        let param = {\r\n            kind: 'report'\r\n        };\r\n        if (typeof arg0 === 'number') {\r\n            param.percentage = arg0;\r\n            if (arg1 !== undefined) {\r\n                param.message = arg1;\r\n            }\r\n        }\r\n        else {\r\n            param.message = arg0;\r\n        }\r\n        this._connection.sendProgress(vscode_languageserver_protocol_1.Proposed.WorkDoneProgress.type, this._token, param);\r\n    }\r\n    done() {\r\n        WorkDoneProgressImpl.Instances.delete(this._token);\r\n        this._source.dispose();\r\n        this._connection.sendProgress(vscode_languageserver_protocol_1.Proposed.WorkDoneProgress.type, this._token, { kind: 'done' });\r\n    }\r\n    cancel() {\r\n        this._source.cancel();\r\n    }\r\n}\r\nWorkDoneProgressImpl.Instances = new Map();\r\nclass NullProgress {\r\n    constructor() {\r\n        this._source = new vscode_languageserver_protocol_1.CancellationTokenSource();\r\n    }\r\n    get token() {\r\n        return this._source.token;\r\n    }\r\n    begin() {\r\n    }\r\n    report() {\r\n    }\r\n    done() {\r\n    }\r\n}\r\nfunction attachWorkDone(connection, params) {\r\n    if (params === undefined || params.workDoneToken === undefined) {\r\n        return new NullProgress();\r\n    }\r\n    const token = params.workDoneToken;\r\n    delete params.workDoneToken;\r\n    return new WorkDoneProgressImpl(connection, token);\r\n}\r\nexports.attachWorkDone = attachWorkDone;\r\nexports.ProgressFeature = (Base) => {\r\n    return class extends Base {\r\n        initialize(cap) {\r\n            const capabilities = cap;\r\n            if (capabilities.window && capabilities.window.workDoneProgress) {\r\n                this._progressSupported = true;\r\n                this.connection.onNotification(vscode_languageserver_protocol_1.Proposed.WorkDoneProgressCancelNotification.type, (params) => {\r\n                    let progress = WorkDoneProgressImpl.Instances.get(params.token);\r\n                    if (progress !== undefined) {\r\n                        progress.cancel();\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        attachWorkDoneProgress(token) {\r\n            if (token === undefined) {\r\n                return new NullProgress();\r\n            }\r\n            else {\r\n                return new WorkDoneProgressImpl(this.connection, token);\r\n            }\r\n        }\r\n        createWorkDoneProgress() {\r\n            if (this._progressSupported) {\r\n                const token = uuid_1.generateUuid();\r\n                return this.connection.sendRequest(vscode_languageserver_protocol_1.Proposed.WorkDoneProgressCreateRequest.type, { token }).then(() => {\r\n                    const result = new WorkDoneProgressImpl(this.connection, token);\r\n                    return result;\r\n                });\r\n            }\r\n            else {\r\n                return Promise.resolve(new NullProgress());\r\n            }\r\n        }\r\n    };\r\n};\r\nvar ResultProgress;\r\n(function (ResultProgress) {\r\n    ResultProgress.type = new vscode_languageserver_protocol_1.ProgressType();\r\n})(ResultProgress || (ResultProgress = {}));\r\nclass ResultProgressImpl {\r\n    constructor(_connection, _token) {\r\n        this._connection = _connection;\r\n        this._token = _token;\r\n    }\r\n    report(data) {\r\n        this._connection.sendProgress(ResultProgress.type, this._token, data);\r\n    }\r\n}\r\nfunction attachPartialResult(connection, params) {\r\n    if (params === undefined || params.partialResultToken === undefined) {\r\n        return undefined;\r\n    }\r\n    const token = params.partialResultToken;\r\n    delete params.partialResultToken;\r\n    return new ResultProgressImpl(connection, token);\r\n}\r\nexports.attachPartialResult = attachPartialResult;\r\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar isWindows;\nif (typeof process === 'object') {\n    isWindows = process.platform === 'win32';\n}\nelse if (typeof navigator === 'object') {\n    var userAgent = navigator.userAgent;\n    isWindows = userAgent.indexOf('Windows') >= 0;\n}\n//#endregion\nvar _schemePattern = /^\\w[\\w\\d+.-]*$/;\nvar _singleSlashStart = /^\\//;\nvar _doubleSlashStart = /^\\/\\//;\nvar _throwOnMissingSchema = true;\n/**\n * @internal\n */\nexport function setUriThrowOnMissingScheme(value) {\n    var old = _throwOnMissingSchema;\n    _throwOnMissingSchema = value;\n    return old;\n}\nfunction _validateUri(ret, _strict) {\n    // scheme, must be set\n    if (!ret.scheme) {\n        if (_strict || _throwOnMissingSchema) {\n            throw new Error(\"[UriError]: Scheme is missing: {scheme: \\\"\\\", authority: \\\"\" + ret.authority + \"\\\", path: \\\"\" + ret.path + \"\\\", query: \\\"\" + ret.query + \"\\\", fragment: \\\"\" + ret.fragment + \"\\\"}\");\n        }\n        else {\n            // console.warn(`[UriError]: Scheme is missing: {scheme: \"\", authority: \"${ret.authority}\", path: \"${ret.path}\", query: \"${ret.query}\", fragment: \"${ret.fragment}\"}`);\n        }\n    }\n    // scheme, https://tools.ietf.org/html/rfc3986#section-3.1\n    // ALPHA *( ALPHA / DIGIT / \"+\" / \"-\" / \".\" )\n    if (ret.scheme && !_schemePattern.test(ret.scheme)) {\n        throw new Error('[UriError]: Scheme contains illegal characters.');\n    }\n    // path, http://tools.ietf.org/html/rfc3986#section-3.3\n    // If a URI contains an authority component, then the path component\n    // must either be empty or begin with a slash (\"/\") character.  If a URI\n    // does not contain an authority component, then the path cannot begin\n    // with two slash characters (\"//\").\n    if (ret.path) {\n        if (ret.authority) {\n            if (!_singleSlashStart.test(ret.path)) {\n                throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash (\"/\") character');\n            }\n        }\n        else {\n            if (_doubleSlashStart.test(ret.path)) {\n                throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters (\"//\")');\n            }\n        }\n    }\n}\n// for a while we allowed uris *without* schemes and this is the migration\n// for them, e.g. an uri without scheme and without strict-mode warns and falls\n// back to the file-scheme. that should cause the least carnage and still be a\n// clear warning\nfunction _schemeFix(scheme, _strict) {\n    if (_strict || _throwOnMissingSchema) {\n        return scheme || _empty;\n    }\n    if (!scheme) {\n        // console.trace('BAD uri lacks scheme, falling back to file-scheme.');\n        scheme = 'file';\n    }\n    return scheme;\n}\n// implements a bit of https://tools.ietf.org/html/rfc3986#section-5\nfunction _referenceResolution(scheme, path) {\n    // the slash-character is our 'default base' as we don't\n    // support constructing URIs relative to other URIs. This\n    // also means that we alter and potentially break paths.\n    // see https://tools.ietf.org/html/rfc3986#section-5.1.4\n    switch (scheme) {\n        case 'https':\n        case 'http':\n        case 'file':\n            if (!path) {\n                path = _slash;\n            }\n            else if (path[0] !== _slash) {\n                path = _slash + path;\n            }\n            break;\n    }\n    return path;\n}\nvar _empty = '';\nvar _slash = '/';\nvar _regexp = /^(([^:/?#]+?):)?(\\/\\/([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?/;\n/**\n * Uniform Resource Identifier (URI) http://tools.ietf.org/html/rfc3986.\n * This class is a simple parser which creates the basic component parts\n * (http://tools.ietf.org/html/rfc3986#section-3) with minimal validation\n * and encoding.\n *\n *       foo://example.com:8042/over/there?name=ferret#nose\n *       \\_/   \\______________/\\_________/ \\_________/ \\__/\n *        |           |            |            |        |\n *     scheme     authority       path        query   fragment\n *        |   _____________________|__\n *       / \\ /                        \\\n *       urn:example:animal:ferret:nose\n */\nvar URI = (function () {\n    /**\n     * @internal\n     */\n    function URI(schemeOrData, authority, path, query, fragment, _strict) {\n        if (_strict === void 0) { _strict = false; }\n        if (typeof schemeOrData === 'object') {\n            this.scheme = schemeOrData.scheme || _empty;\n            this.authority = schemeOrData.authority || _empty;\n            this.path = schemeOrData.path || _empty;\n            this.query = schemeOrData.query || _empty;\n            this.fragment = schemeOrData.fragment || _empty;\n            // no validation because it's this URI\n            // that creates uri components.\n            // _validateUri(this);\n        }\n        else {\n            this.scheme = _schemeFix(schemeOrData, _strict);\n            this.authority = authority || _empty;\n            this.path = _referenceResolution(this.scheme, path || _empty);\n            this.query = query || _empty;\n            this.fragment = fragment || _empty;\n            _validateUri(this, _strict);\n        }\n    }\n    URI.isUri = function (thing) {\n        if (thing instanceof URI) {\n            return true;\n        }\n        if (!thing) {\n            return false;\n        }\n        return typeof thing.authority === 'string'\n            && typeof thing.fragment === 'string'\n            && typeof thing.path === 'string'\n            && typeof thing.query === 'string'\n            && typeof thing.scheme === 'string'\n            && typeof thing.fsPath === 'function'\n            && typeof thing.with === 'function'\n            && typeof thing.toString === 'function';\n    };\n    Object.defineProperty(URI.prototype, \"fsPath\", {\n        // ---- filesystem path -----------------------\n        /**\n         * Returns a string representing the corresponding file system path of this URI.\n         * Will handle UNC paths, normalizes windows drive letters to lower-case, and uses the\n         * platform specific path separator.\n         *\n         * * Will *not* validate the path for invalid characters and semantics.\n         * * Will *not* look at the scheme of this URI.\n         * * The result shall *not* be used for display purposes but for accessing a file on disk.\n         *\n         *\n         * The *difference* to `URI#path` is the use of the platform specific separator and the handling\n         * of UNC paths. See the below sample of a file-uri with an authority (UNC path).\n         *\n         * ```ts\n            const u = URI.parse('file://server/c$/folder/file.txt')\n            u.authority === 'server'\n            u.path === '/shares/c$/file.txt'\n            u.fsPath === '\\\\server\\c$\\folder\\file.txt'\n        ```\n         *\n         * Using `URI#path` to read a file (using fs-apis) would not be enough because parts of the path,\n         * namely the server name, would be missing. Therefore `URI#fsPath` exists - it's sugar to ease working\n         * with URIs that represent files on disk (`file` scheme).\n         */\n        get: function () {\n            // if (this.scheme !== 'file') {\n            // \tconsole.warn(`[UriError] calling fsPath with scheme ${this.scheme}`);\n            // }\n            return _makeFsPath(this);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // ---- modify to new -------------------------\n    URI.prototype.with = function (change) {\n        if (!change) {\n            return this;\n        }\n        var scheme = change.scheme, authority = change.authority, path = change.path, query = change.query, fragment = change.fragment;\n        if (scheme === undefined) {\n            scheme = this.scheme;\n        }\n        else if (scheme === null) {\n            scheme = _empty;\n        }\n        if (authority === undefined) {\n            authority = this.authority;\n        }\n        else if (authority === null) {\n            authority = _empty;\n        }\n        if (path === undefined) {\n            path = this.path;\n        }\n        else if (path === null) {\n            path = _empty;\n        }\n        if (query === undefined) {\n            query = this.query;\n        }\n        else if (query === null) {\n            query = _empty;\n        }\n        if (fragment === undefined) {\n            fragment = this.fragment;\n        }\n        else if (fragment === null) {\n            fragment = _empty;\n        }\n        if (scheme === this.scheme\n            && authority === this.authority\n            && path === this.path\n            && query === this.query\n            && fragment === this.fragment) {\n            return this;\n        }\n        return new _URI(scheme, authority, path, query, fragment);\n    };\n    // ---- parse & validate ------------------------\n    /**\n     * Creates a new URI from a string, e.g. `http://www.msft.com/some/path`,\n     * `file:///usr/home`, or `scheme:with/path`.\n     *\n     * @param value A string which represents an URI (see `URI#toString`).\n     */\n    URI.parse = function (value, _strict) {\n        if (_strict === void 0) { _strict = false; }\n        var match = _regexp.exec(value);\n        if (!match) {\n            return new _URI(_empty, _empty, _empty, _empty, _empty);\n        }\n        return new _URI(match[2] || _empty, decodeURIComponent(match[4] || _empty), decodeURIComponent(match[5] || _empty), decodeURIComponent(match[7] || _empty), decodeURIComponent(match[9] || _empty), _strict);\n    };\n    /**\n     * Creates a new URI from a file system path, e.g. `c:\\my\\files`,\n     * `/usr/home`, or `\\\\server\\share\\some\\path`.\n     *\n     * The *difference* between `URI#parse` and `URI#file` is that the latter treats the argument\n     * as path, not as stringified-uri. E.g. `URI.file(path)` is **not the same as**\n     * `URI.parse('file://' + path)` because the path might contain characters that are\n     * interpreted (# and ?). See the following sample:\n     * ```ts\n    const good = URI.file('/coding/c#/project1');\n    good.scheme === 'file';\n    good.path === '/coding/c#/project1';\n    good.fragment === '';\n    const bad = URI.parse('file://' + '/coding/c#/project1');\n    bad.scheme === 'file';\n    bad.path === '/coding/c'; // path is now broken\n    bad.fragment === '/project1';\n    ```\n     *\n     * @param path A file system path (see `URI#fsPath`)\n     */\n    URI.file = function (path) {\n        var authority = _empty;\n        // normalize to fwd-slashes on windows,\n        // on other systems bwd-slashes are valid\n        // filename character, eg /f\\oo/ba\\r.txt\n        if (isWindows) {\n            path = path.replace(/\\\\/g, _slash);\n        }\n        // check for authority as used in UNC shares\n        // or use the path as given\n        if (path[0] === _slash && path[1] === _slash) {\n            var idx = path.indexOf(_slash, 2);\n            if (idx === -1) {\n                authority = path.substring(2);\n                path = _slash;\n            }\n            else {\n                authority = path.substring(2, idx);\n                path = path.substring(idx) || _slash;\n            }\n        }\n        return new _URI('file', authority, path, _empty, _empty);\n    };\n    URI.from = function (components) {\n        return new _URI(components.scheme, components.authority, components.path, components.query, components.fragment);\n    };\n    // ---- printing/externalize ---------------------------\n    /**\n     * Creates a string representation for this URI. It's guaranteed that calling\n     * `URI.parse` with the result of this function creates an URI which is equal\n     * to this URI.\n     *\n     * * The result shall *not* be used for display purposes but for externalization or transport.\n     * * The result will be encoded using the percentage encoding and encoding happens mostly\n     * ignore the scheme-specific encoding rules.\n     *\n     * @param skipEncoding Do not encode the result, default is `false`\n     */\n    URI.prototype.toString = function (skipEncoding) {\n        if (skipEncoding === void 0) { skipEncoding = false; }\n        return _asFormatted(this, skipEncoding);\n    };\n    URI.prototype.toJSON = function () {\n        return this;\n    };\n    URI.revive = function (data) {\n        if (!data) {\n            return data;\n        }\n        else if (data instanceof URI) {\n            return data;\n        }\n        else {\n            var result = new _URI(data);\n            result._formatted = data.external;\n            result._fsPath = data._sep === _pathSepMarker ? data.fsPath : null;\n            return result;\n        }\n    };\n    return URI;\n}());\nexport { URI };\nvar _pathSepMarker = isWindows ? 1 : undefined;\n// tslint:disable-next-line:class-name\nvar _URI = (function (_super) {\n    __extends(_URI, _super);\n    function _URI() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this._formatted = null;\n        _this._fsPath = null;\n        return _this;\n    }\n    Object.defineProperty(_URI.prototype, \"fsPath\", {\n        get: function () {\n            if (!this._fsPath) {\n                this._fsPath = _makeFsPath(this);\n            }\n            return this._fsPath;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    _URI.prototype.toString = function (skipEncoding) {\n        if (skipEncoding === void 0) { skipEncoding = false; }\n        if (!skipEncoding) {\n            if (!this._formatted) {\n                this._formatted = _asFormatted(this, false);\n            }\n            return this._formatted;\n        }\n        else {\n            // we don't cache that\n            return _asFormatted(this, true);\n        }\n    };\n    _URI.prototype.toJSON = function () {\n        var res = {\n            $mid: 1\n        };\n        // cached state\n        if (this._fsPath) {\n            res.fsPath = this._fsPath;\n            res._sep = _pathSepMarker;\n        }\n        if (this._formatted) {\n            res.external = this._formatted;\n        }\n        // uri components\n        if (this.path) {\n            res.path = this.path;\n        }\n        if (this.scheme) {\n            res.scheme = this.scheme;\n        }\n        if (this.authority) {\n            res.authority = this.authority;\n        }\n        if (this.query) {\n            res.query = this.query;\n        }\n        if (this.fragment) {\n            res.fragment = this.fragment;\n        }\n        return res;\n    };\n    return _URI;\n}(URI));\n// reserved characters: https://tools.ietf.org/html/rfc3986#section-2.2\nvar encodeTable = (_a = {},\n    _a[58 /* Colon */] = '%3A',\n    _a[47 /* Slash */] = '%2F',\n    _a[63 /* QuestionMark */] = '%3F',\n    _a[35 /* Hash */] = '%23',\n    _a[91 /* OpenSquareBracket */] = '%5B',\n    _a[93 /* CloseSquareBracket */] = '%5D',\n    _a[64 /* AtSign */] = '%40',\n    _a[33 /* ExclamationMark */] = '%21',\n    _a[36 /* DollarSign */] = '%24',\n    _a[38 /* Ampersand */] = '%26',\n    _a[39 /* SingleQuote */] = '%27',\n    _a[40 /* OpenParen */] = '%28',\n    _a[41 /* CloseParen */] = '%29',\n    _a[42 /* Asterisk */] = '%2A',\n    _a[43 /* Plus */] = '%2B',\n    _a[44 /* Comma */] = '%2C',\n    _a[59 /* Semicolon */] = '%3B',\n    _a[61 /* Equals */] = '%3D',\n    _a[32 /* Space */] = '%20',\n    _a);\nfunction encodeURIComponentFast(uriComponent, allowSlash) {\n    var res = undefined;\n    var nativeEncodePos = -1;\n    for (var pos = 0; pos < uriComponent.length; pos++) {\n        var code = uriComponent.charCodeAt(pos);\n        // unreserved characters: https://tools.ietf.org/html/rfc3986#section-2.3\n        if ((code >= 97 /* a */ && code <= 122 /* z */)\n            || (code >= 65 /* A */ && code <= 90 /* Z */)\n            || (code >= 48 /* Digit0 */ && code <= 57 /* Digit9 */)\n            || code === 45 /* Dash */\n            || code === 46 /* Period */\n            || code === 95 /* Underline */\n            || code === 126 /* Tilde */\n            || (allowSlash && code === 47 /* Slash */)) {\n            // check if we are delaying native encode\n            if (nativeEncodePos !== -1) {\n                res += encodeURIComponent(uriComponent.substring(nativeEncodePos, pos));\n                nativeEncodePos = -1;\n            }\n            // check if we write into a new string (by default we try to return the param)\n            if (res !== undefined) {\n                res += uriComponent.charAt(pos);\n            }\n        }\n        else {\n            // encoding needed, we need to allocate a new string\n            if (res === undefined) {\n                res = uriComponent.substr(0, pos);\n            }\n            // check with default table first\n            var escaped = encodeTable[code];\n            if (escaped !== undefined) {\n                // check if we are delaying native encode\n                if (nativeEncodePos !== -1) {\n                    res += encodeURIComponent(uriComponent.substring(nativeEncodePos, pos));\n                    nativeEncodePos = -1;\n                }\n                // append escaped variant to result\n                res += escaped;\n            }\n            else if (nativeEncodePos === -1) {\n                // use native encode only when needed\n                nativeEncodePos = pos;\n            }\n        }\n    }\n    if (nativeEncodePos !== -1) {\n        res += encodeURIComponent(uriComponent.substring(nativeEncodePos));\n    }\n    return res !== undefined ? res : uriComponent;\n}\nfunction encodeURIComponentMinimal(path) {\n    var res = undefined;\n    for (var pos = 0; pos < path.length; pos++) {\n        var code = path.charCodeAt(pos);\n        if (code === 35 /* Hash */ || code === 63 /* QuestionMark */) {\n            if (res === undefined) {\n                res = path.substr(0, pos);\n            }\n            res += encodeTable[code];\n        }\n        else {\n            if (res !== undefined) {\n                res += path[pos];\n            }\n        }\n    }\n    return res !== undefined ? res : path;\n}\n/**\n * Compute `fsPath` for the given uri\n */\nfunction _makeFsPath(uri) {\n    var value;\n    if (uri.authority && uri.path.length > 1 && uri.scheme === 'file') {\n        // unc path: file://shares/c$/far/boo\n        value = \"//\" + uri.authority + uri.path;\n    }\n    else if (uri.path.charCodeAt(0) === 47 /* Slash */\n        && (uri.path.charCodeAt(1) >= 65 /* A */ && uri.path.charCodeAt(1) <= 90 /* Z */ || uri.path.charCodeAt(1) >= 97 /* a */ && uri.path.charCodeAt(1) <= 122 /* z */)\n        && uri.path.charCodeAt(2) === 58 /* Colon */) {\n        // windows drive letter: file:///c:/far/boo\n        value = uri.path[1].toLowerCase() + uri.path.substr(2);\n    }\n    else {\n        // other path\n        value = uri.path;\n    }\n    if (isWindows) {\n        value = value.replace(/\\//g, '\\\\');\n    }\n    return value;\n}\n/**\n * Create the external version of a uri\n */\nfunction _asFormatted(uri, skipEncoding) {\n    var encoder = !skipEncoding\n        ? encodeURIComponentFast\n        : encodeURIComponentMinimal;\n    var res = '';\n    var scheme = uri.scheme, authority = uri.authority, path = uri.path, query = uri.query, fragment = uri.fragment;\n    if (scheme) {\n        res += scheme;\n        res += ':';\n    }\n    if (authority || scheme === 'file') {\n        res += _slash;\n        res += _slash;\n    }\n    if (authority) {\n        var idx = authority.indexOf('@');\n        if (idx !== -1) {\n            // <user>@<auth>\n            var userinfo = authority.substr(0, idx);\n            authority = authority.substr(idx + 1);\n            idx = userinfo.indexOf(':');\n            if (idx === -1) {\n                res += encoder(userinfo, false);\n            }\n            else {\n                // <user>:<pass>@<auth>\n                res += encoder(userinfo.substr(0, idx), false);\n                res += ':';\n                res += encoder(userinfo.substr(idx + 1), false);\n            }\n            res += '@';\n        }\n        authority = authority.toLowerCase();\n        idx = authority.indexOf(':');\n        if (idx === -1) {\n            res += encoder(authority, false);\n        }\n        else {\n            // <auth>:<port>\n            res += encoder(authority.substr(0, idx), false);\n            res += authority.substr(idx);\n        }\n    }\n    if (path) {\n        // lower-case windows drive letters in /C:/fff or C:/fff\n        if (path.length >= 3 && path.charCodeAt(0) === 47 /* Slash */ && path.charCodeAt(2) === 58 /* Colon */) {\n            var code = path.charCodeAt(1);\n            if (code >= 65 /* A */ && code <= 90 /* Z */) {\n                path = \"/\" + String.fromCharCode(code + 32) + \":\" + path.substr(3); // \"/c:\".length === 3\n            }\n        }\n        else if (path.length >= 2 && path.charCodeAt(1) === 58 /* Colon */) {\n            var code = path.charCodeAt(0);\n            if (code >= 65 /* A */ && code <= 90 /* Z */) {\n                path = String.fromCharCode(code + 32) + \":\" + path.substr(2); // \"/c:\".length === 3\n            }\n        }\n        // encode the rest of the path\n        res += encoder(path, true);\n    }\n    if (query) {\n        res += '?';\n        res += encoder(query, false);\n    }\n    if (fragment) {\n        res += '#';\n        res += !skipEncoding ? encodeURIComponentFast(fragment, false) : fragment;\n    }\n    return res;\n}\nvar _a;\n","module.exports = require(\"util\");"],"sourceRoot":""}